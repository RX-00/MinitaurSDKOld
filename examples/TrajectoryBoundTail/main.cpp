
#include <stdio.h>
#include <SDK.h>
#include <math.h>
#include <Motor.h>
#include <ReorientableBehavior.h>
#include "Interpolator.h"

#if defined(ROBOT_MINITAUR)
// Subject to change for individual robots
// const float motZeros[8] = {2.82, 3.435, 3.54, 3.076, 1.03, 3.08, 6.190, 1.493};
// const float motZeros[8] = {2.570, 2.036, 3.777, 3.853, 2.183, 1.556, .675, 2.679}; // RML Ellie
const float motZeros[9] = {2.570, 2.036, 3.777, 3.853, 2.183, 1.556, .675, 2.679,0}; // RML Ellie With Tail
// const float motZeros[8] = {0.631, 4.076, 1.852, 3.414, 1.817, 5.500, 1.078, 6.252}; //RML Odie
// const float motZeros[9] = {0.631, 4.076, 1.852, 3.414, 1.817, 5.500, 1.078, 6.252, 1.010}; //RML Odie with Tail
#endif


#define TIMESTEPS 42
#define MOTORS 9 
#define TAIL_MOT 8

char myData[32];
float* myData_buf = (float*)myData;

enum TBMode
{
	TB_SIT = 0,
	TB_STAND,
};

// globals for power monitoring values
float voltage, current;
float oldvoltage, oldcurrent;
float power_int = 0;

#pragma pack(push, 1)
// We receive the serial protocol version number (in case we add more fields later)
// our behaviorCmd, and a checksum.
struct SerialCommandPacket
{
	float voltage, current;
};

const char ALIGNMENT_WORD[2] = {'G', 'R'};

#pragma pack(pop)

// // Okay back offset
// float times[TIMESTEPS] = {0.000000,0.000972,0.001945,0.002917,0.003890,0.004862,0.005834,0.006807,0.007779,0.008751,0.009724,0.010696,0.011669,0.012641,0.013613,0.014586,0.015558,0.016530,0.017503,0.018475,0.019448,0.019448,0.023369,0.027290,0.031211,0.035133,0.039054,0.042975,0.046897,0.050818,0.054739,0.058661,0.062582,0.066503,0.070424,0.074346,0.078267,0.082188,0.086110,0.090031,0.093952,0.097874,0.097874,0.098846,0.099819,0.100791,0.101764,0.102737,0.103709,0.104682,0.105655,0.106627,0.107600,0.108573,0.109545,0.110518,0.111491,0.112463,0.113436,0.114409,0.115381,0.116354,0.117326,0.117326,0.121950,0.126574,0.131198,0.135822,0.140445,0.145069,0.149693,0.154317,0.158941,0.163564,0.168188,0.172812,0.177436,0.182059,0.186683,0.191307,0.195931,0.200555,0.205178,0.209802};
// float pos[TIMESTEPS][MOTORS] = {{0.603096,0.653231,0.662274,1.833677,0.653317,0.603020,1.833688,0.662276,-0.716344},{0.621513,0.651250,0.674065,1.851662,0.651286,0.621477,1.851674,0.674089,-0.716868},{0.640340,0.649520,0.684699,1.868864,0.649576,0.640263,1.868873,0.684701,-0.717324},{0.659269,0.648234,0.694251,1.885113,0.648258,0.659232,1.885122,0.694260,-0.717899},{0.678526,0.647140,0.703093,1.900851,0.647185,0.678448,1.900859,0.703095,-0.718428},{0.697849,0.646465,0.711058,1.915775,0.646485,0.697811,1.915782,0.711063,-0.719063},{0.717492,0.645986,0.718465,1.930258,0.646024,0.717412,1.930265,0.718467,-0.719651},{0.737187,0.645929,0.725101,1.943997,0.645945,0.737147,1.944003,0.725104,-0.720347},{0.757200,0.646070,0.731307,1.957360,0.646102,0.757119,1.957367,0.731309,-0.720995},{0.777270,0.646628,0.736863,1.970056,0.646642,0.777228,1.970062,0.736865,-0.721759},{0.797662,0.647383,0.742105,1.982437,0.647411,0.797579,1.982444,0.742108,-0.722468},{0.818068,0.648548,0.746786,1.994196,0.648562,0.818027,1.994202,0.746788,-0.723287},{0.838736,0.649905,0.751235,2.005669,0.649931,0.838652,2.005676,0.751238,-0.724058},{0.859369,0.651666,0.755202,2.016557,0.651679,0.859330,2.016562,0.755203,-0.724920},{0.880212,0.653612,0.759014,2.027180,0.653635,0.880125,2.027186,0.759016,-0.725745},{0.900979,0.655955,0.762424,2.037260,0.655967,0.900941,2.037264,0.762425,-0.726642},{0.921914,0.658477,0.765749,2.047089,0.658498,0.921825,2.047095,0.765751,-0.727512},{0.942741,0.661389,0.768759,2.056432,0.661401,0.942704,2.056435,0.768760,-0.728438},{0.963698,0.664473,0.771741,2.065513,0.664492,0.963607,2.065519,0.771743,-0.729346},{0.984523,0.667933,0.774515,2.074225,0.667944,0.984486,2.074227,0.774516,-0.730294},{1.005446,0.671568,0.777284,2.082565,0.671586,1.005351,2.082571,0.777286,-0.731236},{1.005347,0.671471,0.777184,2.082664,0.671488,1.005349,2.082669,0.777186,-0.731137},{0.908891,0.617145,0.779576,2.103329,0.617162,0.908886,2.103337,0.779573,-0.733098},{0.809653,0.560034,0.778782,2.103612,0.560051,0.809641,2.103624,0.778783,-0.737565},{0.709524,0.504094,0.775286,2.088619,0.504111,0.709510,2.088631,0.775278,-0.744052},{0.612629,0.454345,0.769610,2.060705,0.454362,0.612614,2.060717,0.769610,-0.751699},{0.523316,0.417566,0.762468,2.021427,0.417583,0.523301,2.021439,0.762464,-0.760764},{0.447453,0.400423,0.754872,1.971547,0.400439,0.447437,1.971560,0.754871,-0.770565},{0.390082,0.409918,0.747666,1.912678,0.409935,0.390065,1.912690,0.747665,-0.780899},{0.354069,0.449208,0.741697,1.845679,0.449224,0.354052,1.845691,0.741695,-0.791220},{0.340964,0.520030,0.738154,1.772264,0.520047,0.340948,1.772275,0.738153,-0.801530},{0.349116,0.618953,0.737275,1.693634,0.618969,0.349100,1.693646,0.737272,-0.811428},{0.374847,0.741155,0.739485,1.611533,0.741172,0.374833,1.611543,0.739482,-0.820601},{0.412849,0.877586,0.744888,1.527782,0.877603,0.412838,1.527795,0.744883,-0.828786},{0.456897,1.019097,0.754425,1.443767,1.019113,0.456886,1.443777,0.754421,-0.835705},{0.502788,1.159707,0.768601,1.361579,1.159723,0.502777,1.361592,0.768595,-0.841566},{0.548021,1.294725,0.788390,1.282828,1.294741,0.548010,1.282835,0.788388,-0.846053},{0.591086,1.423106,0.814241,1.209711,1.423123,0.591077,1.209724,0.814233,-0.849596},{0.631881,1.544010,0.846430,1.144123,1.544026,0.631873,1.144137,0.846434,-0.851968},{0.670000,1.658145,0.885160,1.087690,1.658162,0.669993,1.087702,0.885151,-0.853650},{0.706022,1.765722,0.929362,1.042351,1.765738,0.706017,1.042364,0.929366,-0.854452},{0.739544,1.867484,0.980829,1.009092,1.867501,0.739542,1.009104,0.980818,-0.854742},{0.739636,1.867385,0.980928,1.008993,1.867402,0.739640,1.009005,0.980917,-0.854642},{0.746622,1.890944,0.995310,1.002884,1.890959,0.746627,1.002891,0.995302,-0.854505},{0.752425,1.913701,1.010079,0.996992,1.913717,0.752429,0.997004,1.010059,-0.854482},{0.757237,1.935538,1.024961,0.991507,1.935549,0.757239,0.991513,1.024948,-0.854322},{0.761317,1.956841,1.040141,0.986212,1.956852,0.761322,0.986224,1.040112,-0.854269},{0.764578,1.977394,1.055393,0.981310,1.977404,0.764580,0.981316,1.055376,-0.854085},{0.767275,1.997485,1.070935,0.976610,1.997498,0.767280,0.976622,1.070898,-0.854004},{0.769232,2.016835,1.086526,0.972314,2.016847,0.769234,0.972320,1.086505,-0.853795},{0.770750,2.035785,1.102395,0.968230,2.035800,0.770755,0.968242,1.102352,-0.853685},{0.771615,2.054050,1.118292,0.964561,2.054062,0.771617,0.964566,1.118267,-0.853451},{0.772145,2.071966,1.134454,0.961112,2.071982,0.772150,0.961124,1.134404,-0.853311},{0.772111,2.089251,1.150624,0.958088,2.089263,0.772112,0.958094,1.150596,-0.853051},{0.771831,2.106230,1.167047,0.955292,2.106247,0.771836,0.955304,1.166990,-0.852881},{0.771072,2.122631,1.183456,0.952929,2.122643,0.771074,0.952936,1.183425,-0.852594},{0.770148,2.138762,1.200102,0.950797,2.138779,0.770153,0.950809,1.200038,-0.852391},{0.768829,2.154370,1.216715,0.949104,2.154380,0.768831,0.949111,1.216681,-0.852076},{0.767416,2.169731,1.233551,0.947644,2.169750,0.767421,0.947656,1.233480,-0.851841},{0.765693,2.184635,1.250338,0.946629,2.184643,0.765695,0.946636,1.250301,-0.851497},{0.763937,2.199300,1.267339,0.945848,2.199319,0.763942,0.945860,1.267260,-0.851228},{0.761965,2.213610,1.284286,0.945513,2.213616,0.761968,0.945520,1.284245,-0.850851},{0.759995,2.227634,1.301441,0.945423,2.227654,0.760001,0.945435,1.301351,-0.850543},{0.759895,2.227731,1.301341,0.945324,2.227751,0.759901,0.945335,1.301338,-0.850444},{0.743201,2.272685,1.181611,0.914626,2.272733,0.743175,0.914608,1.181602,-0.849304},{0.717237,2.288444,1.057205,0.878413,2.288466,0.717173,0.878425,1.057195,-0.846458},{0.683293,2.280837,0.926844,0.835864,2.280922,0.683232,0.835875,0.926833,-0.841703},{0.643136,2.252106,0.791484,0.786480,2.252129,0.643070,0.786492,0.791474,-0.835474},{0.597292,2.202350,0.652436,0.731462,2.202424,0.597228,0.731473,0.652425,-0.827763},{0.547680,2.132310,0.515030,0.675126,2.132333,0.547612,0.675138,0.515019,-0.818703},{0.495725,2.042314,0.386683,0.626348,2.042340,0.495659,0.626360,0.386673,-0.808831},{0.444302,1.934959,0.277802,0.597371,1.934983,0.444233,0.597382,0.277791,-0.798026},{0.396168,1.813611,0.198026,0.601974,1.813634,0.396104,0.601985,0.198015,-0.786739},{0.354509,1.682601,0.152697,0.647303,1.682624,0.354439,0.647313,0.152687,-0.774789},{0.321659,1.545651,0.143256,0.734673,1.545675,0.321622,0.734684,0.143251,-0.762578},{0.300088,1.406786,0.164735,0.854077,1.406810,0.300018,0.854088,0.164735,-0.750859},{0.291228,1.268744,0.209671,0.992925,1.268770,0.291191,0.992936,0.209673,-0.740112},{0.295922,1.135501,0.268837,1.137442,1.135525,0.295850,1.137452,0.268839,-0.731194},{0.314845,1.010894,0.334381,1.277085,1.010915,0.314786,1.277096,0.334383,-0.724057},{0.347559,0.898860,0.401898,1.408137,0.898887,0.347487,1.408147,0.401901,-0.719117},{0.393894,0.803861,0.469335,1.528576,0.803913,0.393837,1.528587,0.469337,-0.715929},{0.452662,0.729160,0.535382,1.639199,0.729243,0.452588,1.639210,0.535384,-0.714664},{0.522692,0.678604,0.599992,1.740485,0.678687,0.522729,1.740495,0.599995,-0.714807},{0.602997,0.653329,0.662374,1.833777,0.653416,0.602922,1.833788,0.662376,-0.716442}};
// float vel[TIMESTEPS][MOTORS] = {{18.790286,-2.285792,12.960570,19.087330,-2.285746,18.790264,19.087263,12.960488,-0.518545},{19.108075,-1.865304,11.538908,18.015454,-1.865303,19.108065,18.015443,11.538882,-0.554945},{19.375262,-1.493726,10.377435,17.112169,-1.493739,19.375252,17.112161,10.377425,-0.588374},{19.585053,-1.179483,9.498347,16.391291,-1.179486,19.585046,16.391287,9.498334,-0.618260},{19.788729,-0.863840,8.688303,15.709414,-0.863843,19.788721,15.709406,8.688288,-0.648490},{19.985861,-0.547033,7.945079,15.065071,-0.547036,19.985854,15.065069,7.945067,-0.678977},{20.178781,-0.228901,7.264700,14.455768,-0.228904,20.178775,14.455764,7.264689,-0.710081},{20.365886,0.090877,6.644437,13.879293,0.090875,20.365879,13.879292,6.644427,-0.741693},{20.557620,0.408530,6.087966,13.340465,0.408528,20.557614,13.340462,6.087955,-0.774321},{20.759460,0.724030,5.596821,12.841033,0.724028,20.759451,12.841032,5.596811,-0.808565},{20.931509,1.036704,5.147723,12.358710,1.036702,20.931502,12.358708,5.147714,-0.839998},{21.073423,1.346315,4.739291,11.892740,1.346313,21.073414,11.892739,4.739282,-0.868449},{21.189457,1.652751,4.371879,11.442666,1.652748,21.189450,11.442665,4.371870,-0.894621},{21.279145,1.955750,4.044363,11.007694,1.955747,21.279135,11.007694,4.044354,-0.918244},{21.347717,2.255489,3.756770,10.588310,2.255486,21.347710,10.588309,3.756762,-0.939979},{21.394871,2.551797,3.508212,10.183808,2.551795,21.394861,10.183808,3.508203,-0.959537},{21.424627,2.844385,3.298357,9.794667,2.844382,21.424619,9.794667,3.298349,-0.977615},{21.436797,3.133048,3.126475,9.420348,3.133046,21.436787,9.420348,3.126467,-0.993966},{21.434574,3.417915,2.992248,9.060656,3.417913,21.434566,9.060656,2.992241,-1.009012},{21.418633,3.694188,2.899928,8.724936,3.694187,21.418622,8.724936,2.899917,-1.021613},{21.386132,3.994478,2.815635,8.344096,3.994475,21.386127,8.344098,2.815631,-1.038495},{-24.023502,-13.300470,0.986771,8.190441,-13.300395,-24.023483,8.190432,0.986759,-0.077368},{-25.021099,-14.352886,0.182538,2.474862,-14.352867,-25.021101,2.474862,0.182513,-0.865324},{-25.543654,-14.619847,-0.570716,-2.104515,-14.619817,-25.543658,-2.104513,-0.570734,-1.454457},{-25.317748,-13.738365,-1.209288,-5.512767,-13.738379,-25.317715,-5.512767,-1.209309,-1.823096},{-23.994889,-11.360989,-1.685205,-8.595484,-11.361023,-23.994835,-8.595479,-1.685220,-2.142983},{-21.303512,-7.180905,-1.927834,-11.408546,-7.180918,-21.303493,-11.408543,-1.927856,-2.438493},{-17.235784,-1.244966,-1.954595,-13.904569,-1.244959,-17.235788,-13.904565,-1.954608,-2.612498},{-12.010962,6.109779,-1.732711,-16.089851,6.109787,-12.010950,-16.089849,-1.732733,-2.653020},{-6.240268,14.052943,-1.270851,-17.956336,14.052953,-6.240250,-17.956330,-1.270863,-2.653588},{-0.493379,21.850345,-0.586219,-19.439045,21.850355,-0.493365,-19.439042,-0.586242,-2.604026},{4.500339,28.485480,0.156862,-20.533804,28.485493,4.500347,-20.533799,0.156849,-2.466337},{8.382107,33.403859,0.932042,-21.207277,33.403864,8.382113,-21.207276,0.932021,-2.233389},{10.658286,35.843689,1.862350,-21.446194,35.843693,10.658292,-21.446188,1.862340,-1.955899},{11.593838,36.195827,2.977941,-21.259151,36.195822,11.593841,-21.259149,2.977909,-1.641039},{11.698594,35.286494,4.291784,-20.595322,35.286490,11.698599,-20.595299,4.291779,-1.333616},{11.271545,33.625700,5.790777,-19.434054,33.625692,11.271550,-19.434096,5.790759,-1.030885},{10.693420,31.801480,7.385564,-17.779676,31.801474,10.693426,-17.779622,7.385600,-0.761927},{10.044651,29.960485,9.035059,-15.615522,29.960468,10.044639,-15.615574,9.034981,-0.523982},{9.427198,28.250052,10.654832,-13.035290,28.250060,9.427199,-13.035206,10.654922,-0.319369},{8.864307,26.699069,12.045818,-10.059097,26.699113,8.864347,-10.059190,12.045723,-0.155818},{8.248458,25.185353,14.277269,-6.783505,25.185341,8.248429,-6.783419,14.277358,0.031289},{7.960095,24.905556,14.629118,-6.470554,24.905512,7.960035,-6.470515,14.629132,0.016590},{6.583506,23.826037,14.942856,-6.113311,23.826025,6.583511,-6.113308,14.942850,0.031573},{5.460141,22.915493,15.203381,-5.784817,22.915474,5.460156,-5.784822,15.203373,0.045651},{4.611784,22.188275,15.403707,-5.491436,22.188270,4.611803,-5.491436,15.403700,0.058654},{3.827396,21.498656,15.595977,-5.191733,21.498646,3.827409,-5.191732,15.595972,0.071866},{3.104914,20.845460,15.780108,-4.885851,20.845457,3.104936,-4.885851,15.780101,0.085301},{2.439329,20.225188,15.955725,-4.574363,20.225183,2.439349,-4.574363,15.955720,0.098950},{1.829021,19.636852,16.122744,-4.257444,19.636850,1.829045,-4.257445,16.122737,0.112826},{1.270008,19.077536,16.281031,-3.935543,19.077532,1.270028,-3.935543,16.281026,0.126913},{0.760998,18.546391,16.430392,-3.608947,18.546390,0.761022,-3.608947,16.430384,0.141228},{0.298870,18.041080,16.571647,-3.277398,18.041078,0.298892,-3.277398,16.571641,0.155713},{-0.117426,17.560813,16.704968,-2.940817,17.560813,-0.117401,-2.940818,16.704960,0.170361},{-0.490255,17.104087,16.828664,-2.601585,17.104086,-0.490232,-2.601585,16.828659,0.185277},{-0.820461,16.670189,16.942529,-2.259950,16.670188,-0.820436,-2.259951,16.942521,0.200469},{-1.109963,16.258072,17.047980,-1.916030,16.258072,-1.109940,-1.916031,17.047974,0.215955},{-1.359453,15.867015,17.144678,-1.570084,15.867015,-1.359427,-1.570085,17.144670,0.231733},{-1.570453,15.496829,17.235038,-1.222094,15.496830,-1.570428,-1.222095,17.235032,0.247929},{-1.743513,15.146538,17.318315,-0.872287,15.146538,-1.743489,-0.872288,17.318306,0.264465},{-1.880046,14.818419,17.399720,-0.520764,14.818421,-1.880022,-0.520764,17.399715,0.282062},{-1.976356,14.521487,17.482667,-0.173129,14.521485,-1.976324,-0.173130,17.482657,0.300523},{-2.062096,14.188221,17.543140,0.208908,14.188252,-2.062106,0.208908,17.543138,0.321538},{-2.472002,13.240249,-25.401080,-6.159749,13.240213,-2.472010,-6.159666,-25.401000,0.005873},{-4.673868,6.385878,-26.389248,-7.214489,6.385863,-4.673857,-7.214441,-26.389224,0.424524},{-6.566601,0.672228,-27.506596,-8.460021,0.672261,-6.566598,-8.459990,-27.506612,0.818459},{-8.059116,-3.935983,-28.802409,-9.980405,-3.935969,-8.059119,-9.980403,-28.802409,1.182240},{-9.338726,-8.440822,-29.753467,-11.331307,-8.440800,-9.338700,-11.331341,-29.753462,1.514756},{-10.401674,-12.981863,-30.137900,-12.291821,-12.981850,-10.401680,-12.291849,-30.137887,1.813552},{-11.052739,-17.293219,-29.128741,-11.815009,-17.293205,-11.052733,-11.815048,-29.128713,2.048556},{-11.294916,-21.450967,-26.014750,-8.883626,-21.450961,-11.294924,-8.883688,-26.014741,2.231328},{-10.906001,-24.883821,-20.795322,-3.163981,-24.883823,-10.906015,-3.164002,-20.795329,2.377606},{-9.807842,-27.410745,-13.657532,5.239297,-27.410744,-9.807858,5.239276,-13.657519,2.510699},{-8.186627,-29.145261,-5.809277,14.538475,-29.145268,-8.186646,14.538445,-5.809257,2.591481},{-5.952942,-29.923987,1.550806,22.801243,-29.923989,-5.952959,22.801257,1.550823,2.605076},{-3.375400,-30.055516,7.480364,28.480671,-30.055510,-3.375412,28.480674,7.480385,2.450228},{-0.480600,-29.491384,11.601585,31.104797,-29.491414,-0.480638,31.104785,11.601595,2.126279},{2.529846,-28.052307,13.721229,31.017241,-28.052246,2.529880,31.017240,13.721240,1.739697},{5.587950,-25.750976,14.503915,29.365883,-25.751048,5.587903,29.365883,14.503930,1.290916},{8.557406,-22.537683,14.660703,27.216288,-22.537602,8.557484,27.216279,14.660700,0.868312},{11.395788,-18.457518,14.466263,24.969906,-18.457599,11.395698,24.969869,14.466217,0.463196},{13.987256,-13.676460,14.146134,22.886867,-13.676367,13.987348,22.886852,14.146120,0.104673},{16.270870,-8.200577,13.761307,21.018520,-8.200672,16.270779,21.018556,13.761393,-0.197694},{18.404984,-2.658389,13.267792,19.349648,-2.658298,18.405066,19.349629,13.267711,-0.531562}};
// float u[TIMESTEPS][MOTORS] = {{0.147329,0.177750,-1.011703,-0.581002,0.177722,0.147339,-0.580993,-1.011665,-13.506540},{0.147329,0.177750,-1.011703,-0.581002,0.177722,0.147339,-0.580993,-1.011665,-13.506540},{0.105425,0.135831,-0.670550,-0.405023,0.135831,0.105427,-0.405030,-0.670548,-10.702458},{0.105425,0.135831,-0.670550,-0.405023,0.135831,0.105427,-0.405030,-0.670548,-10.702458},{0.101893,0.140872,-0.587962,-0.382618,0.140869,0.101895,-0.382622,-0.587956,-10.628827},{0.101893,0.140872,-0.587962,-0.382618,0.140869,0.101895,-0.382622,-0.587956,-10.628827},{0.100633,0.146049,-0.507354,-0.360972,0.146048,0.100633,-0.360976,-0.507351,-10.699959},{0.100633,0.146049,-0.507354,-0.360972,0.146048,0.100633,-0.360976,-0.507351,-10.699959},{0.110093,0.146203,-0.420822,-0.330873,0.146200,0.110094,-0.330875,-0.420819,-10.954612},{0.110093,0.146203,-0.420822,-0.330873,0.146200,0.110094,-0.330875,-0.420819,-10.954612},{0.081266,0.149388,-0.352110,-0.328213,0.149389,0.081263,-0.328215,-0.352108,-9.245561},{0.081266,0.149388,-0.352110,-0.328213,0.149389,0.081263,-0.328215,-0.352108,-9.245561},{0.056036,0.152401,-0.282046,-0.325585,0.152404,0.056029,-0.325587,-0.282044,-7.771395},{0.056036,0.152401,-0.282046,-0.325585,0.152404,0.056029,-0.325587,-0.282044,-7.771395},{0.035386,0.155212,-0.211588,-0.321386,0.155217,0.035376,-0.321387,-0.211587,-6.494933},{0.035386,0.155212,-0.211588,-0.321386,0.155217,0.035376,-0.321387,-0.211587,-6.494933},{0.018353,0.157576,-0.141662,-0.315514,0.157583,0.018342,-0.315516,-0.141660,-5.433242},{0.018353,0.157576,-0.141662,-0.315514,0.157583,0.018342,-0.315516,-0.141660,-5.433242},{0.004093,0.159825,-0.071802,-0.309143,0.159836,0.004079,-0.309143,-0.071804,-4.466516},{0.004093,0.159825,-0.071802,-0.309143,0.159836,0.004079,-0.309143,-0.071804,-4.466516},{-0.018823,0.204127,-0.043767,-0.408866,0.204137,-0.018842,-0.408872,-0.043747,-6.677228},{0.466008,1.077030,-0.067005,-1.383300,1.077715,0.464797,-1.383309,-0.067003,-58.073873},{0.466008,1.077030,-0.067005,-1.383300,1.077715,0.464797,-1.383309,-0.067003,-58.073873},{0.623025,0.979328,0.011380,-0.879505,0.977762,0.625525,-0.879499,0.011383,-33.400432},{0.623025,0.979328,0.011380,-0.879505,0.977762,0.625525,-0.879499,0.011383,-33.400432},{0.776776,1.056874,0.086202,-0.721860,1.058345,0.774568,-0.721871,0.086201,-28.207577},{0.776776,1.056874,0.086202,-0.721860,1.058345,0.774568,-0.721871,0.086201,-28.207577},{0.904170,1.028665,0.163289,-0.523822,1.028453,0.904522,-0.523824,0.163284,-10.062614},{0.904170,1.028665,0.163289,-0.523822,1.028453,0.904522,-0.523824,0.163284,-10.062614},{0.972113,1.063012,0.203377,-0.350287,1.062961,0.972215,-0.350288,0.203373,-3.954759},{0.972113,1.063012,0.203377,-0.350287,1.062961,0.972215,-0.350288,0.203373,-3.954759},{0.969139,1.019558,0.206114,-0.188204,1.019317,0.969489,-0.188203,0.206113,6.002161},{0.969139,1.019558,0.206114,-0.188204,1.019317,0.969489,-0.188203,0.206113,6.002161},{0.995354,0.536099,0.201847,-0.016991,0.536067,0.995399,-0.016989,0.201843,13.406845},{0.995354,0.536099,0.201847,-0.016991,0.536067,0.995399,-0.016989,0.201843,13.406845},{0.833827,0.170413,0.190007,0.150742,0.170397,0.833870,0.150726,0.190009,16.017190},{0.833827,0.170413,0.190007,0.150742,0.170397,0.833870,0.150726,0.190009,16.017190},{0.689621,0.040134,0.167843,0.294006,0.040113,0.689615,0.294057,0.167807,13.831428},{0.689621,0.040134,0.167843,0.294006,0.040113,0.689615,0.294057,0.167807,13.831428},{0.591347,-0.005292,0.142750,0.407422,-0.005251,0.591585,0.407310,0.142624,10.618976},{0.591347,-0.005292,0.142750,0.407422,-0.005251,0.591585,0.407310,0.142624,10.618976},{-0.145847,-0.168804,0.438546,0.456285,-0.169174,-0.147654,0.456732,0.438952,16.472559},{-1.024144,-0.525664,0.134828,0.149611,-0.525661,-1.024111,0.149594,0.134821,6.592012},{-1.024144,-0.525664,0.134828,0.149611,-0.525661,-1.024111,0.149594,0.134821,6.592012},{-0.676067,-0.359267,0.084211,0.112374,-0.359261,-0.676073,0.112378,0.084211,5.254336},{-0.676067,-0.359267,0.084211,0.112374,-0.359261,-0.676073,0.112378,0.084211,5.254336},{-0.594992,-0.340861,0.078710,0.120670,-0.340859,-0.594992,0.120670,0.078709,5.226294},{-0.594992,-0.340861,0.078710,0.120670,-0.340859,-0.594992,0.120670,0.078709,5.226294},{-0.516805,-0.324601,0.072944,0.128640,-0.324601,-0.516807,0.128641,0.072943,5.203217},{-0.516805,-0.324601,0.072944,0.128640,-0.324601,-0.516807,0.128641,0.072943,5.203217},{-0.441022,-0.310142,0.067129,0.136391,-0.310143,-0.441023,0.136393,0.067128,5.182578},{-0.441022,-0.310142,0.067129,0.136391,-0.310143,-0.441023,0.136393,0.067128,5.182578},{-0.367192,-0.297001,0.062155,0.144564,-0.297001,-0.367193,0.144565,0.062154,5.148233},{-0.367192,-0.297001,0.062155,0.144564,-0.297001,-0.367193,0.144565,0.062154,5.148233},{-0.294983,-0.284467,0.055873,0.150502,-0.284468,-0.294983,0.150503,0.055872,5.163010},{-0.294983,-0.284467,0.055873,0.150502,-0.284468,-0.294983,0.150503,0.055872,5.163010},{-0.224297,-0.271872,0.051305,0.156275,-0.271873,-0.224296,0.156277,0.051303,5.201398},{-0.224297,-0.271872,0.051305,0.156275,-0.271873,-0.224296,0.156277,0.051303,5.201398},{-0.155229,-0.258029,0.049837,0.161843,-0.258029,-0.155230,0.161845,0.049835,5.317896},{-0.155229,-0.258029,0.049837,0.161843,-0.258029,-0.155230,0.161845,0.049835,5.317896},{-0.089211,-0.239005,0.055894,0.166591,-0.239010,-0.089201,0.166594,0.055890,5.792356},{-0.089211,-0.239005,0.055894,0.166591,-0.239010,-0.089201,0.166594,0.055890,5.792356},{-0.048155,-0.329405,0.021219,0.230759,-0.329290,-0.048275,0.230764,0.021221,7.208748},{-0.200560,-1.324334,0.238423,1.069453,-1.324353,-0.200529,1.069444,0.238029,29.151056},{-0.200560,-1.324334,0.238423,1.069453,-1.324353,-0.200529,1.069444,0.238029,29.151056},{-0.126675,-0.884992,0.307132,0.929821,-0.884998,-0.126643,0.929445,0.307458,26.943356},{-0.126675,-0.884992,0.307132,0.929821,-0.884998,-0.126643,0.929445,0.307458,26.943356},{-0.070498,-0.753159,0.544088,1.198757,-0.753147,-0.070494,1.199994,0.542825,27.967304},{-0.070498,-0.753159,0.544088,1.198757,-0.753147,-0.070494,1.199994,0.542825,27.967304},{0.015665,-0.528954,0.830258,1.474412,-0.528943,0.015683,1.473871,0.830737,26.620033},{0.015665,-0.528954,0.830258,1.474412,-0.528943,0.015683,1.473871,0.830737,26.620033},{0.130994,-0.208507,0.960361,1.528923,-0.208498,0.131007,1.528333,0.960958,22.208781},{0.130994,-0.208507,0.960361,1.528923,-0.208498,0.131007,1.528333,0.960958,22.208781},{0.189878,0.021680,0.995145,1.490574,0.021681,0.189894,1.490281,0.995342,14.165570},{0.189878,0.021680,0.995145,1.490574,0.021681,0.189894,1.490281,0.995342,14.165570},{0.215246,0.170529,1.293247,1.004266,0.170519,0.215250,1.004259,1.293145,-3.777823},{0.215246,0.170529,1.293247,1.004266,0.170519,0.215250,1.004259,1.293145,-3.777823},{0.207731,0.321484,1.129394,0.364077,0.321451,0.207712,0.364118,1.129412,-16.028532},{0.207731,0.321484,1.129394,0.364077,0.321451,0.207712,0.364118,1.129412,-16.028532},{0.170368,0.471468,0.874389,0.118416,0.471384,0.170300,0.118378,0.874237,-17.681940},{0.170368,0.471468,0.874389,0.118416,0.471384,0.170300,0.118378,0.874237,-17.681940},{0.118916,0.599590,0.688425,0.027718,0.599578,0.118832,0.027932,0.689289,-15.060031},{0.118916,0.599590,0.688425,0.027718,0.599578,0.118832,0.027932,0.689289,-15.060031},{0.127676,0.618111,-0.139849,-0.167100,0.618761,0.127970,-0.164240,-0.148580,-22.746217}};
// float dfVec[TIMESTEPS][MOTORS] = {{0.160327,0.014424,-0.082453,0.036173,0.014420,0.160328,0.036174,-0.082447,-2.510719},{0.162606,0.017440,-0.092651,0.028484,0.017435,0.162608,0.028485,-0.092644,-2.522570},{0.157257,0.012837,-0.041830,0.052518,0.012837,0.157257,0.052517,-0.041829,-2.047256},{0.158762,0.015091,-0.048135,0.047347,0.015091,0.158762,0.047346,-0.048135,-2.056986},{0.159610,0.018229,-0.039626,0.046341,0.018229,0.159611,0.046340,-0.039625,-2.054062},{0.161024,0.020502,-0.044957,0.041719,0.020501,0.161025,0.041718,-0.044956,-2.063987},{0.162190,0.023682,-0.035861,0.041101,0.023681,0.162190,0.041101,-0.035860,-2.086448},{0.163532,0.025975,-0.040310,0.036966,0.025975,0.163532,0.036966,-0.040309,-2.096740},{0.166547,0.028280,-0.029298,0.038320,0.028280,0.166548,0.038320,-0.029297,-2.151517},{0.167995,0.030543,-0.032820,0.034738,0.030543,0.167995,0.034738,-0.032820,-2.162666},{0.164231,0.033339,-0.024128,0.031740,0.033339,0.164230,0.031739,-0.024128,-1.876569},{0.165249,0.035559,-0.027058,0.028397,0.035559,0.165248,0.028397,-0.027057,-1.885832},{0.161707,0.038280,-0.017545,0.025624,0.038280,0.161705,0.025624,-0.017544,-1.638748},{0.162350,0.040453,-0.019894,0.022504,0.040454,0.162349,0.022504,-0.019894,-1.646439},{0.159261,0.043091,-0.009740,0.020224,0.043092,0.159260,0.020224,-0.009740,-1.432191},{0.159599,0.045216,-0.011523,0.017323,0.045217,0.159598,0.017323,-0.011523,-1.438558},{0.156860,0.047725,-0.000904,0.015550,0.047726,0.156858,0.015549,-0.000904,-1.260358},{0.156947,0.049795,-0.002137,0.012865,0.049796,0.156945,0.012864,-0.002136,-1.265682},{0.154458,0.052228,0.009013,0.011389,0.052230,0.154456,0.011389,0.009013,-1.102960},{0.154344,0.054210,0.008351,0.008981,0.054212,0.154342,0.008981,0.008351,-1.107063},{0.150138,0.064046,0.012608,-0.011041,0.064047,0.150134,-0.011042,0.012611,-1.495873},{-0.091518,0.091342,-0.004540,-0.181100,0.091462,-0.091728,-0.181102,-0.004540,-10.094586},{-0.098674,0.083793,-0.010309,-0.222098,0.083912,-0.098884,-0.222099,-0.010308,-10.351128},{-0.075197,0.064938,-0.002121,-0.167592,0.064667,-0.074764,-0.167591,-0.002120,-6.264824},{-0.073577,0.071261,-0.006701,-0.192040,0.070989,-0.073143,-0.192039,-0.006701,-6.384845},{-0.037429,0.101759,0.002859,-0.186818,0.102014,-0.037811,-0.186820,0.002858,-5.588607},{-0.018124,0.131743,0.001118,-0.206996,0.131998,-0.018507,-0.206998,0.001118,-5.684819},{0.033142,0.169430,0.014292,-0.190562,0.169393,0.033203,-0.190562,0.014291,-2.595327},{0.070620,0.222185,0.015884,-0.206237,0.222148,0.070681,-0.206237,0.015883,-2.608520},{0.123793,0.285116,0.026148,-0.189536,0.285107,0.123811,-0.189536,0.026147,-1.549667},{0.165015,0.341046,0.031058,-0.200171,0.341037,0.165033,-0.200171,0.031058,-1.533531},{0.200319,0.381105,0.036863,-0.179920,0.381063,0.200380,-0.179920,0.036863,0.237723},{0.228163,0.416384,0.042423,-0.184751,0.416342,0.228224,-0.184751,0.042423,0.313566},{0.249035,0.350058,0.048357,-0.156778,0.350053,0.249043,-0.156778,0.048356,1.687805},{0.255746,0.352584,0.056359,-0.155437,0.352579,0.255754,-0.155436,0.056358,1.790317},{0.228490,0.282655,0.063730,-0.121592,0.282653,0.228497,-0.121594,0.063730,2.343014},{0.225427,0.270743,0.074482,-0.113262,0.270740,0.225434,-0.113265,0.074482,2.441577},{0.196276,0.235069,0.082078,-0.076555,0.235065,0.196275,-0.076546,0.082072,2.150156},{0.191623,0.221863,0.093910,-0.061032,0.221860,0.191621,-0.061023,0.093903,2.227626},{0.170154,0.201718,0.101178,-0.022859,0.201725,0.170195,-0.022877,0.101157,1.737238},{0.166116,0.190593,0.111155,-0.001510,0.190601,0.166158,-0.001531,0.111133,1.790487},{0.033877,0.151384,0.178449,0.030457,0.151320,0.033564,0.030535,0.178520,2.866355},{-0.120478,0.087501,0.128311,-0.020472,0.087501,-0.120473,-0.020474,0.128310,1.148387},{-0.130353,0.079758,0.130562,-0.017909,0.079758,-0.130347,-0.017912,0.130561,1.153265},{-0.078058,0.102078,0.123654,-0.022010,0.102079,-0.078059,-0.022009,0.123654,0.925910},{-0.084143,0.096862,0.125091,-0.019905,0.096863,-0.084144,-0.019904,0.125091,0.930143},{-0.075712,0.095107,0.125516,-0.016317,0.095107,-0.075712,-0.016317,0.125516,0.929582},{-0.080894,0.090421,0.126837,-0.014123,0.090422,-0.080894,-0.014123,0.126837,0.933956},{-0.072111,0.088791,0.127097,-0.010507,0.088791,-0.072112,-0.010507,0.127097,0.934399},{-0.076489,0.084571,0.128295,-0.008234,0.084571,-0.076489,-0.008233,0.128295,0.938917},{-0.067359,0.083066,0.128422,-0.004581,0.083066,-0.067359,-0.004580,0.128422,0.939924},{-0.071010,0.079257,0.129494,-0.002238,0.079257,-0.071010,-0.002238,0.129493,0.944585},{-0.061524,0.077911,0.129644,0.001557,0.077911,-0.061523,0.001558,0.129644,0.943346},{-0.064510,0.074466,0.130601,0.003972,0.074466,-0.064509,0.003972,0.130600,0.948115},{-0.054663,0.073363,0.130399,0.007434,0.073363,-0.054663,0.007435,0.130398,0.955534},{-0.057032,0.070251,0.131215,0.009885,0.070250,-0.057032,0.009885,0.131215,0.960480},{-0.046852,0.069478,0.131180,0.013353,0.069478,-0.046852,0.013353,0.131179,0.972178},{-0.048642,0.066673,0.131873,0.015834,0.066673,-0.048642,0.015835,0.131873,0.977315},{-0.038180,0.066418,0.132267,0.019296,0.066418,-0.038180,0.019296,0.132267,1.002788},{-0.039421,0.063906,0.132864,0.021805,0.063906,-0.039421,0.021805,0.132864,1.008172},{-0.028954,0.064851,0.134498,0.025150,0.064850,-0.028952,0.025150,0.134498,1.096167},{-0.029644,0.062721,0.135093,0.027643,0.062720,-0.029643,0.027644,0.135093,1.102177},{-0.023141,0.044656,0.129515,0.041510,0.044676,-0.023162,0.041511,0.129515,1.354607},{-0.052506,-0.134654,-0.140860,0.141248,-0.134658,-0.052501,0.141247,-0.140928,5.056398},{-0.068300,-0.183820,-0.147948,0.133683,-0.183824,-0.068295,0.133682,-0.148016,5.192702},{-0.069066,-0.148626,-0.144050,0.100538,-0.148627,-0.069060,0.100473,-0.143993,4.938167},{-0.079772,-0.181681,-0.153344,0.089632,-0.181682,-0.079766,0.089567,-0.153288,5.056607},{-0.079210,-0.191135,-0.119081,0.126573,-0.191133,-0.079209,0.126787,-0.119299,5.342409},{-0.086834,-0.223708,-0.121838,0.119683,-0.223706,-0.086833,0.119898,-0.122057,5.439691},{-0.076564,-0.215758,-0.064980,0.170899,-0.215756,-0.076561,0.170805,-0.064897,5.282601},{-0.078301,-0.245581,-0.042644,0.191926,-0.245579,-0.078298,0.191832,-0.042561,5.342107},{-0.055515,-0.214643,0.017353,0.242404,-0.214641,-0.055513,0.242302,0.017456,4.624868},{-0.047638,-0.232768,0.068552,0.302680,-0.232767,-0.047636,0.302578,0.068655,4.668200},{-0.025799,-0.205298,0.130878,0.362733,-0.205298,-0.025797,0.362682,0.130912,3.299893},{-0.009777,-0.210884,0.183671,0.422002,-0.210884,-0.009775,0.421951,0.183706,3.304319},{0.013110,-0.186018,0.277892,0.378419,-0.186020,0.013110,0.378418,0.277874,0.142709},{0.033874,-0.181972,0.307453,0.397242,-0.181974,0.033874,0.397240,0.307435,0.037238},{0.054165,-0.145475,0.294247,0.285612,-0.145481,0.054162,0.285619,0.294250,-2.212769},{0.076100,-0.128968,0.299861,0.273767,-0.128974,0.076097,0.273774,0.299864,-2.358883},{0.090922,-0.079914,0.256770,0.215753,-0.079928,0.090910,0.215746,0.256744,-2.783157},{0.111281,-0.050647,0.255375,0.199640,-0.050662,0.111269,0.199633,0.255349,-2.915055},{0.120948,0.005862,0.220835,0.168972,0.005861,0.120934,0.169009,0.220985,-2.577171},{0.137329,0.045140,0.218075,0.155570,0.045138,0.137313,0.155608,0.218225,-2.675616},{0.154155,0.088105,0.070921,0.109820,0.088219,0.154207,0.110316,0.069406,-4.117020}};
// float pitch[TIMESTEPS] = {-0.010261,-0.007677,-0.004936,-0.002344,0.000362,0.003005,0.005643,0.008339,0.010915,0.013624,0.016182,0.018897,0.021448,0.024163,0.026709,0.029424,0.031966,0.034681,0.037219,0.039933,0.042468,0.042568,0.049954,0.057012,0.063773,0.069604,0.074789,0.078894,0.082294,0.084574,0.086067,0.086162,0.084977,0.082008,0.077523,0.071928,0.065079,0.057592,0.049254,0.040603,0.031346,0.022002,0.022102,0.019651,0.017307,0.014953,0.012565,0.010270,0.007863,0.005600,0.003196,0.000955,-0.001440,-0.003665,-0.006052,-0.008263,-0.010643,-0.012845,-0.015219,-0.017414,-0.019785,-0.021976,-0.024346,-0.024446,-0.033717,-0.042928,-0.051666,-0.060149,-0.067694,-0.074347,-0.079333,-0.082935,-0.084827,-0.085533,-0.084674,-0.082435,-0.078324,-0.072160,-0.064558,-0.055394,-0.045328,-0.034176,-0.022526,-0.010161};

// Centered meh
// float times[TIMESTEPS] = {0.000000,0.001170,0.002340,0.003510,0.004680,0.005850,0.007020,0.008190,0.009360,0.010530,0.011700,0.012870,0.014040,0.015210,0.016380,0.017549,0.018719,0.019889,0.021059,0.022229,0.023399,0.023399,0.026054,0.028709,0.031364,0.034019,0.036673,0.039328,0.041983,0.044638,0.047293,0.049947,0.052602,0.055257,0.057912,0.060567,0.063222,0.065876,0.068531,0.071186,0.073841,0.076496,0.076496,0.076553,0.076611,0.076668,0.076726,0.076783,0.076841,0.076898,0.076955,0.077013,0.077070,0.077128,0.077185,0.077243,0.077300,0.077358,0.077415,0.077473,0.077530,0.077588,0.077645,0.077645,0.080268,0.082890,0.085513,0.088135,0.090758,0.093381,0.096003,0.098626,0.101248,0.103871,0.106494,0.109116,0.111739,0.114361,0.116984,0.119606,0.122229,0.124852,0.127474,0.130097};
// float pos[TIMESTEPS][MOTORS] = {{0.483689,0.835251,0.503908,1.264649,0.835251,0.483689,1.264654,0.503910,0.000888},{0.487307,0.813921,0.512736,1.285718,0.813921,0.487307,1.285719,0.512737,0.000740},{0.491302,0.792019,0.519956,1.303237,0.792019,0.491302,1.303240,0.519956,0.000582},{0.495729,0.769787,0.525972,1.317903,0.769787,0.495729,1.317904,0.525972,0.000402},{0.500629,0.747391,0.530997,1.330094,0.747391,0.500629,1.330096,0.530997,0.000210},{0.506016,0.724944,0.535096,1.339946,0.724944,0.506016,1.339947,0.535096,-0.000003},{0.511953,0.702552,0.538325,1.347582,0.702552,0.511953,1.347582,0.538325,-0.000229},{0.518547,0.680327,0.540727,1.353109,0.680327,0.518547,1.353109,0.540727,-0.000475},{0.525888,0.658376,0.542350,1.356629,0.658377,0.525888,1.356629,0.542350,-0.000733},{0.534063,0.636800,0.543235,1.358226,0.636801,0.534063,1.358226,0.543235,-0.001010},{0.543101,0.615758,0.543438,1.357991,0.615758,0.543101,1.357992,0.543438,-0.001300},{0.552991,0.595479,0.543011,1.356009,0.595479,0.552990,1.356009,0.543011,-0.001608},{0.563716,0.576157,0.542015,1.352368,0.576158,0.563715,1.352368,0.542015,-0.001928},{0.575266,0.557996,0.540509,1.347152,0.557996,0.575265,1.347152,0.540509,-0.002265},{0.587623,0.541157,0.538557,1.340450,0.541159,0.587621,1.340450,0.538557,-0.002613},{0.600772,0.525821,0.536222,1.332347,0.525822,0.600770,1.332347,0.536222,-0.002978},{0.614690,0.512124,0.533569,1.322935,0.512128,0.614684,1.322936,0.533569,-0.003355},{0.629352,0.500233,0.530652,1.312313,0.500236,0.629349,1.312313,0.530652,-0.003745},{0.644719,0.490259,0.527542,1.300584,0.490268,0.644701,1.300584,0.527542,-0.004150},{0.660633,0.482294,0.524268,1.287849,0.482299,0.660623,1.287849,0.524268,-0.004560},{0.677273,0.476630,0.521046,1.274245,0.476644,0.677217,1.274245,0.521046,-0.004999},{0.677181,0.476543,0.521032,1.274170,0.476565,0.677169,1.274170,0.521032,-0.004921},{0.624435,0.452558,0.509464,1.237668,0.452569,0.624435,1.237668,0.509464,-0.004956},{0.574349,0.433196,0.496034,1.192800,0.433211,0.574344,1.192800,0.496034,-0.005000},{0.526845,0.418603,0.481121,1.141096,0.418607,0.526844,1.141096,0.481121,-0.004935},{0.482591,0.409207,0.465180,1.083654,0.409215,0.482588,1.083654,0.465180,-0.004912},{0.442380,0.406328,0.448904,1.021398,0.406329,0.442379,1.021398,0.448904,-0.004783},{0.407192,0.410870,0.432982,0.955294,0.410873,0.407190,0.955294,0.432982,-0.004634},{0.377613,0.423816,0.418239,0.886293,0.423817,0.377612,0.886293,0.418239,-0.004450},{0.354330,0.445685,0.405280,0.815842,0.445686,0.354329,0.815842,0.405280,-0.004236},{0.337599,0.476939,0.394614,0.745821,0.476940,0.337598,0.745821,0.394614,-0.004007},{0.327685,0.517585,0.386616,0.678081,0.517585,0.327685,0.678081,0.386616,-0.003733},{0.324353,0.567512,0.381634,0.614595,0.567512,0.324352,0.614595,0.381634,-0.003432},{0.327312,0.625879,0.379808,0.556734,0.625879,0.327311,0.556735,0.379809,-0.003050},{0.335770,0.691830,0.381135,0.505392,0.691830,0.335770,0.505392,0.381134,-0.002616},{0.349005,0.763841,0.385580,0.461466,0.763840,0.349004,0.461468,0.385581,-0.002067},{0.365852,0.840474,0.393077,0.425882,0.840474,0.365852,0.425881,0.393076,-0.001472},{0.385520,0.920094,0.403576,0.399527,0.920094,0.385520,0.399531,0.403579,-0.000715},{0.406988,1.001392,0.417001,0.383331,1.001390,0.406986,0.383331,0.417001,0.000287},{0.429572,1.083058,0.433440,0.378179,1.083057,0.429572,0.378187,0.433450,0.001604},{0.452596,1.164102,0.452961,0.384781,1.164100,0.452592,0.384779,0.452966,0.003191},{0.475007,1.243050,0.476751,0.405293,1.243050,0.475007,0.405305,0.476802,0.005000},{0.475098,1.242961,0.476765,0.405217,1.242961,0.475099,0.405225,0.476774,0.004901},{0.475514,1.244564,0.477386,0.405830,1.244564,0.475514,0.405832,0.477388,0.004861},{0.475929,1.246162,0.478002,0.406445,1.246162,0.475929,0.406449,0.478004,0.004886},{0.476339,1.247750,0.478620,0.407070,1.247750,0.476339,0.407071,0.478620,0.004848},{0.476750,1.249334,0.479236,0.407700,1.249334,0.476750,0.407701,0.479236,0.004870},{0.477156,1.250910,0.479854,0.408337,1.250910,0.477156,0.408337,0.479854,0.004835},{0.477563,1.252481,0.480471,0.408980,1.252481,0.477563,0.408980,0.480470,0.004855},{0.477965,1.254045,0.481089,0.409630,1.254045,0.477965,0.409630,0.481089,0.004822},{0.478368,1.255604,0.481707,0.410287,1.255604,0.478369,0.410287,0.481707,0.004840},{0.478768,1.257155,0.482328,0.410952,1.257155,0.478768,0.410952,0.482327,0.004808},{0.479168,1.258702,0.482948,0.411623,1.258702,0.479168,0.411623,0.482947,0.004825},{0.479564,1.260242,0.483570,0.412303,1.260242,0.479564,0.412303,0.483570,0.004795},{0.479961,1.261778,0.484193,0.412989,1.261778,0.479961,0.412989,0.484192,0.004810},{0.480355,1.263306,0.484818,0.413684,1.263306,0.480355,0.413684,0.484818,0.004781},{0.480749,1.264830,0.485444,0.414386,1.264830,0.480749,0.414387,0.485443,0.004795},{0.481140,1.266347,0.486074,0.415098,1.266347,0.481140,0.415099,0.486073,0.004768},{0.481531,1.267859,0.486706,0.415817,1.267859,0.481531,0.415818,0.486703,0.004780},{0.481918,1.269364,0.487341,0.416547,1.269364,0.481918,0.416548,0.487339,0.004754},{0.482305,1.270864,0.487982,0.417282,1.270864,0.482305,0.417285,0.487972,0.004765},{0.482688,1.272356,0.488622,0.418030,1.272356,0.482688,0.418032,0.488614,0.004740},{0.483072,1.273844,0.489281,0.418781,1.273844,0.483072,0.418790,0.489240,0.004751},{0.483027,1.273757,0.489185,0.418697,1.273757,0.483027,0.418716,0.489186,0.004653},{0.498464,1.326042,0.442882,0.415246,1.326042,0.498464,0.415257,0.442884,0.004875},{0.508847,1.361399,0.404775,0.420607,1.361399,0.508847,0.420620,0.404776,0.004989},{0.515571,1.384562,0.373294,0.433432,1.384562,0.515571,0.433436,0.373294,0.004952},{0.519456,1.397815,0.347513,0.452499,1.397815,0.519456,0.452502,0.347513,0.004999},{0.520844,1.401608,0.327164,0.477543,1.401608,0.520844,0.477544,0.327164,0.004952},{0.520090,1.396654,0.312173,0.508273,1.396654,0.520090,0.508275,0.312173,0.004999},{0.517495,1.383883,0.302625,0.544864,1.383883,0.517495,0.544864,0.302625,0.004949},{0.513429,1.364081,0.298479,0.586882,1.364081,0.513429,0.586884,0.298479,0.004971},{0.508265,1.337912,0.299538,0.634104,1.337912,0.508265,0.634105,0.299538,0.004864},{0.502401,1.306035,0.305484,0.685677,1.306035,0.502401,0.685679,0.305484,0.004737},{0.496222,1.269079,0.315854,0.741035,1.269079,0.496222,0.741036,0.315854,0.004524},{0.490114,1.227721,0.330050,0.799025,1.227721,0.490114,0.799028,0.330050,0.004231},{0.484460,1.182618,0.347280,0.858797,1.182618,0.484460,0.858799,0.347281,0.003888},{0.479600,1.134554,0.366861,0.919255,1.134554,0.479600,0.919258,0.366861,0.003473},{0.475835,1.084361,0.388056,0.979670,1.084361,0.475835,0.979671,0.388056,0.003040},{0.473463,1.032964,0.410353,1.039359,1.032964,0.473463,1.039362,0.410353,0.002568},{0.472774,0.981320,0.433349,1.097942,0.981320,0.472774,1.097945,0.433351,0.002109},{0.474058,0.930455,0.456715,1.155138,0.930455,0.474058,1.155142,0.456716,0.001639},{0.477715,0.882101,0.480463,1.210901,0.882101,0.477716,1.210898,0.480457,0.001205},{0.483660,0.835334,0.503829,1.264742,0.835334,0.483660,1.264746,0.503830,0.000789}};
// float vel[TIMESTEPS][MOTORS] = {{2.921698,-17.888519,8.346677,19.743417,-17.888519,2.921698,19.743416,8.346677,-0.161212},{3.220441,-18.473650,6.816102,16.432143,-18.473650,3.220441,16.432143,6.816103,-0.173429},{3.564814,-18.868230,5.594717,13.665302,-18.868230,3.564814,13.665302,5.594717,-0.186694},{3.957360,-19.053713,4.718824,11.490094,-19.053713,3.957360,11.490094,4.718824,-0.201322},{4.372843,-19.146047,3.898486,9.432933,-19.146047,4.372843,9.432933,3.898486,-0.215780},{4.799679,-19.144204,3.135165,7.489610,-19.144204,4.799679,7.489611,3.135165,-0.230082},{5.314098,-19.049425,2.410222,5.641620,-19.049425,5.314098,5.641620,2.410222,-0.244142},{5.920048,-18.860816,1.722532,3.885698,-18.860816,5.920048,3.885698,1.722532,-0.257938},{6.589223,-18.576390,1.075156,2.207272,-18.576390,6.589223,2.207272,1.075156,-0.271573},{7.333279,-18.210233,0.466235,0.601596,-18.210233,7.333279,0.601596,0.466235,-0.285062},{8.066686,-17.658253,-0.094650,-0.927520,-17.658253,8.066686,-0.927520,-0.094650,-0.298183},{8.786779,-16.916149,-0.608446,-2.383583,-16.916149,8.786779,-2.383583,-0.608446,-0.310874},{9.496452,-16.013159,-1.069913,-3.764730,-16.013159,9.496453,-3.764730,-1.069913,-0.323337},{10.194098,-14.946424,-1.479310,-5.073692,-14.946424,10.194098,-5.073692,-1.479310,-0.335506},{10.877438,-13.740057,-1.834030,-6.306880,-13.740057,10.877439,-6.306880,-1.834030,-0.347534},{11.546174,-12.392879,-2.133018,-7.467227,-12.392878,11.546174,-7.467227,-2.133018,-0.359351},{12.191052,-10.921824,-2.381027,-8.542944,-10.921825,12.191053,-8.542944,-2.381027,-0.371037},{12.816097,-9.326996,-2.579946,-9.535946,-9.326995,12.816095,-9.535946,-2.579946,-0.382492},{13.383801,-7.620828,-2.713246,-10.434989,-7.620830,13.383802,-10.434989,-2.713246,-0.393907},{13.832763,-5.863391,-2.818788,-11.246430,-5.863391,13.832763,-11.246430,-2.818788,-0.405242},{14.588255,-3.653489,-2.627571,-11.922049,-3.653489,14.588255,-11.922049,-2.627571,-0.416216},{-20.316891,-9.934953,-3.990919,-12.011009,-9.934946,-20.316872,-12.011009,-3.990919,-0.071012},{-19.398100,-8.192493,-4.740533,-15.401783,-8.192493,-19.398097,-15.401783,-4.740533,-0.022593},{-18.381198,-6.372898,-5.358828,-18.279144,-6.372895,-18.381195,-18.279144,-5.358828,0.013870},{-17.354851,-4.606425,-5.859836,-20.601041,-4.606426,-17.354850,-20.601041,-5.859836,0.035680},{-15.982143,-2.396881,-6.114959,-22.588512,-2.396880,-15.982142,-22.588512,-6.114959,0.055223},{-14.265733,0.241721,-6.117048,-24.227022,0.241721,-14.265733,-24.227022,-6.117048,0.071571},{-12.254906,3.236758,-5.836157,-25.480318,3.236758,-12.254905,-25.480318,-5.836157,0.084315},{-10.002930,6.515354,-5.252608,-26.365566,6.515354,-10.002930,-26.365567,-5.252609,0.094007},{-7.568378,9.993235,-4.483093,-26.567146,9.993234,-7.568377,-26.567145,-4.483093,0.102809},{-5.033286,13.563423,-3.539367,-26.045624,13.563423,-5.033285,-26.045625,-3.539368,0.112796},{-2.498278,17.095212,-2.472777,-24.846948,17.095212,-2.498278,-24.846946,-2.472777,0.126629},{-0.049566,20.469377,-1.286539,-22.898602,20.469377,-0.049566,-22.898604,-1.286540,0.146289},{2.178887,23.499004,-0.099310,-20.607913,23.499004,2.178886,-20.607910,-0.099309,0.171944},{4.131328,26.097257,1.086212,-17.988504,26.097257,4.131328,-17.988509,1.086210,0.203310},{5.710510,28.111400,2.247705,-15.016804,28.111400,5.710510,-15.016797,2.247707,0.237968},{6.919842,29.539596,3.386751,-11.711158,29.539597,6.919843,-11.711166,3.386749,0.266294},{7.772618,30.401163,4.510949,-8.053610,30.401163,7.772619,-8.053598,4.510953,0.337228},{8.332116,30.791270,5.602118,-4.073286,30.791265,8.332113,-4.073302,5.602112,0.457479},{8.576409,30.687793,6.812087,0.305862,30.687786,8.576408,0.305880,6.812101,0.565642},{8.635591,30.281551,8.023270,4.900014,30.281572,8.635612,4.899997,8.023248,0.664738},{8.121092,29.083214,10.060701,10.821306,29.083204,8.121069,10.821315,10.060714,0.725393},{7.781460,28.758178,10.461016,11.196415,28.758178,7.781460,11.196415,10.461016,0.722702},{7.713546,28.609800,10.448820,11.322118,28.609800,7.713546,11.322118,10.448820,0.722863},{7.657963,28.477229,10.447395,11.441553,28.477229,7.657963,11.441553,10.447395,0.723079},{7.616482,28.362738,10.458035,11.553227,28.362738,7.616482,11.553227,10.458035,0.723361},{7.576621,28.250229,10.471668,11.667617,28.250229,7.576621,11.667617,10.471668,0.723642},{7.538272,28.139606,10.488229,11.784630,28.139606,7.538272,11.784630,10.488229,0.723921},{7.502182,28.031512,10.508166,11.904917,28.031512,7.502182,11.904917,10.508166,0.724202},{7.468603,27.926186,10.531585,12.028806,27.926186,7.468603,12.028806,10.531585,0.724485},{7.435744,27.821916,10.557733,12.153982,27.821916,7.435744,12.153982,10.557733,0.724762},{7.403471,27.718582,10.586514,12.280190,27.718582,7.403471,12.280190,10.586514,0.725033},{7.372719,27.617008,10.618600,12.409209,27.617008,7.372719,12.409209,10.618600,0.725301},{7.343853,27.517528,10.653540,12.540579,27.517528,7.343853,12.540579,10.653540,0.725569},{7.314296,27.417776,10.694494,12.677498,27.417776,7.314296,12.677498,10.694494,0.725813},{7.284331,27.318073,10.740661,12.820258,27.318073,7.284331,12.820258,10.740661,0.726035},{7.251980,27.216179,10.797627,12.966778,27.216179,7.251980,12.966778,10.797627,0.726205},{7.217038,27.111946,10.865635,13.117027,27.111946,7.217038,13.117027,10.865635,0.726321},{7.180955,27.006441,10.942948,13.271215,27.006441,7.180955,13.271215,10.942948,0.726396},{7.143579,26.899747,11.030139,13.429939,26.899747,7.143579,13.429939,11.030139,0.726426},{7.105974,26.791293,11.123175,13.589001,26.791293,7.105974,13.589001,11.123175,0.726426},{7.067753,26.680800,11.217710,13.741634,26.680800,7.067753,13.741634,11.217710,0.726425},{7.031620,26.570225,11.344154,13.935206,26.570225,7.031620,13.935206,11.344154,0.726219},{7.014864,23.739451,-19.390771,-3.214070,23.739451,7.014864,-3.214066,-19.390750,0.147555},{4.842508,16.448910,-16.034511,0.419990,16.448910,4.842508,0.419995,-16.034512,0.078592},{3.153497,10.816803,-13.133299,3.615910,10.816803,3.153497,3.615908,-13.133294,0.035810},{1.998684,6.921523,-10.924933,6.077752,6.921523,1.998684,6.077755,-10.924934,0.020020},{0.979535,3.251379,-8.774286,8.458426,3.251379,0.979535,8.458425,-8.774285,0.008423},{0.097177,-0.265229,-6.760684,10.644643,-0.265229,0.097177,10.644644,-6.760685,0.000462},{-0.661683,-3.423441,-4.695506,12.855225,-3.423441,-0.661683,12.855225,-4.695506,-0.009875},{-1.298464,-6.237439,-2.616800,15.025751,-6.237439,-1.298464,15.025752,-2.616800,-0.023679},{-1.789462,-8.790954,-0.589596,17.060481,-8.790954,-1.789462,17.060480,-0.589596,-0.041313},{-2.131904,-11.091411,1.347843,18.900523,-11.091411,-2.131904,18.900523,1.347843,-0.063199},{-2.327172,-13.148133,3.121429,20.451467,-13.148133,-2.327172,20.451467,3.121429,-0.088121},{-2.371637,-14.957781,4.716636,21.694975,-14.957781,-2.371637,21.694975,4.716636,-0.115744},{-2.274246,-16.509890,6.022000,22.531974,-16.509889,-2.274246,22.531974,6.022000,-0.141649},{-2.029381,-17.799788,7.048488,22.997233,-17.799788,-2.029381,22.997232,7.048488,-0.164404},{-1.669024,-18.770822,7.799632,23.115766,-18.770821,-1.669024,23.115766,7.799631,-0.181761},{-1.194653,-19.413428,8.303995,22.946102,-19.413429,-1.194654,22.946106,8.303998,-0.192379},{-0.607328,-19.690931,8.641509,22.593738,-19.690930,-0.607327,22.593741,8.641508,-0.197573},{0.089366,-19.594981,8.838732,22.103933,-19.594982,0.089365,22.103918,8.838715,-0.196798},{0.896605,-19.096698,8.944643,21.537825,-19.096695,0.896607,21.537802,8.944621,-0.191479},{1.853180,-17.933670,9.041644,20.970547,-17.933675,1.853176,20.970600,9.041719,-0.182850},{2.640816,-17.883756,8.690494,20.063426,-17.883753,2.640819,20.063393,8.690423,-0.163196}};
// float u[TIMESTEPS][MOTORS] = {{0.168219,-0.266467,-0.464885,-1.557485,-0.266467,0.168218,-1.557488,-0.464881,-0.107180},{0.168219,-0.266467,-0.464885,-1.557485,-0.266467,0.168218,-1.557488,-0.464881,-0.107180},{0.166319,-0.093573,-0.254197,-1.084006,-0.093572,0.166318,-1.084008,-0.254194,-0.106158},{0.166319,-0.093573,-0.254197,-1.084006,-0.093572,0.166318,-1.084008,-0.254194,-0.106158},{0.166321,-0.013024,-0.215386,-0.995852,-0.013024,0.166320,-0.995854,-0.215384,-0.105009},{0.166321,-0.013024,-0.215386,-0.995852,-0.013024,0.166320,-0.995854,-0.215384,-0.105009},{0.224071,0.053867,-0.190045,-0.916838,0.053867,0.224070,-0.916839,-0.190043,-0.103880},{0.224071,0.053867,-0.190045,-0.916838,0.053867,0.224070,-0.916839,-0.190043,-0.103880},{0.260508,0.125480,-0.159512,-0.847990,0.125481,0.260507,-0.847991,-0.159510,-0.102773},{0.260508,0.125480,-0.159512,-0.847990,0.125481,0.260507,-0.847991,-0.159510,-0.102773},{0.219671,0.288857,-0.118852,-0.774288,0.288857,0.219671,-0.774289,-0.118851,-0.101716},{0.219671,0.288857,-0.118852,-0.774288,0.288857,0.219671,-0.774289,-0.118851,-0.101716},{0.186640,0.428781,-0.075016,-0.697333,0.428782,0.186639,-0.697334,-0.075015,-0.100705},{0.186640,0.428781,-0.075016,-0.697333,0.428782,0.186639,-0.697334,-0.075015,-0.100705},{0.156487,0.550699,-0.030681,-0.616095,0.550700,0.156484,-0.616095,-0.030681,-0.099723},{0.156487,0.550699,-0.030681,-0.616095,0.550700,0.156484,-0.616095,-0.030681,-0.099723},{0.122758,0.661623,0.006398,-0.522547,0.661624,0.122750,-0.522547,0.006398,-0.098771},{0.122758,0.661623,0.006398,-0.522547,0.661624,0.122750,-0.522547,0.006398,-0.098771},{0.063643,0.770179,0.055101,-0.421904,0.770181,0.063625,-0.421904,0.055100,-0.097833},{0.063643,0.770179,0.055101,-0.421904,0.770181,0.063625,-0.421904,0.055100,-0.097833},{0.259647,1.133600,0.330751,-0.326555,1.133629,0.259588,-0.326554,0.330748,-0.097165},{0.394646,0.972301,0.039352,-0.766211,0.972485,0.394324,-0.766211,0.039352,-0.111684},{0.394646,0.972301,0.039352,-0.766211,0.972485,0.394324,-0.766211,0.039352,-0.111684},{0.390218,0.704396,0.019830,-0.479437,0.704424,0.390116,-0.479435,0.019830,-0.115199},{0.390218,0.704396,0.019830,-0.479437,0.704424,0.390116,-0.479435,0.019830,-0.115199},{0.477475,0.754341,0.079728,-0.313333,0.754388,0.477333,-0.313331,0.079728,-0.116907},{0.477475,0.754341,0.079728,-0.313333,0.754388,0.477333,-0.313331,0.079728,-0.116907},{0.515174,0.816836,0.143838,-0.150563,0.816862,0.515071,-0.150561,0.143837,-0.118107},{0.515174,0.816836,0.143838,-0.150563,0.816862,0.515071,-0.150561,0.143837,-0.118107},{0.652430,0.808870,0.150191,0.114512,0.808869,0.652386,0.114514,0.150191,-0.118866},{0.652430,0.808870,0.150191,0.114512,0.808869,0.652386,0.114514,0.150191,-0.118866},{0.741450,0.832276,0.150871,0.349796,0.832264,0.741419,0.349798,0.150871,-0.119838},{0.741450,0.832276,0.150871,0.349796,0.832264,0.741419,0.349798,0.150871,-0.119838},{0.746981,0.880061,0.142865,0.450566,0.880072,0.746914,0.450568,0.142866,-0.121670},{0.746981,0.880061,0.142865,0.450566,0.880072,0.746914,0.450568,0.142866,-0.121670},{0.775747,0.835393,0.123236,0.564146,0.835395,0.775692,0.564148,0.123237,-0.117815},{0.775747,0.835393,0.123236,0.564146,0.835395,0.775692,0.564148,0.123237,-0.117815},{0.721556,0.699106,0.109286,0.690630,0.699076,0.721534,0.690634,0.109288,0.095631},{0.721556,0.699106,0.109286,0.690630,0.699076,0.721534,0.690634,0.109288,0.095631},{0.728807,0.458660,0.120456,0.839288,0.458746,0.728952,0.839301,0.120456,0.087096},{0.728807,0.458660,0.120456,0.839288,0.458746,0.728952,0.839301,0.120456,0.087096},{-0.198525,-0.300927,0.283531,1.336905,-0.301873,-0.200118,1.336885,0.283736,0.084627},{-0.422239,-1.309828,-0.292739,1.133366,-1.309829,-0.422236,1.133346,-0.292729,0.081852},{-0.422239,-1.309828,-0.292739,1.133366,-1.309829,-0.422236,1.133346,-0.292729,0.081852},{-0.231636,-1.025510,-0.090999,0.985650,-1.025510,-0.231636,0.985648,-0.091000,0.082886},{-0.231636,-1.025510,-0.090999,0.985650,-1.025510,-0.231636,0.985648,-0.091000,0.082886},{-0.206501,-0.991937,-0.050128,1.024630,-0.991938,-0.206500,1.024631,-0.050131,0.082874},{-0.206501,-0.991937,-0.050128,1.024630,-0.991938,-0.206500,1.024631,-0.050131,0.082874},{-0.170382,-0.949164,-0.004553,1.072197,-0.949164,-0.170382,1.072198,-0.004557,0.082865},{-0.170382,-0.949164,-0.004553,1.072197,-0.949164,-0.170382,1.072198,-0.004557,0.082865},{-0.159756,-0.931094,0.036270,1.087003,-0.931094,-0.159756,1.087004,0.036266,0.082848},{-0.159756,-0.931094,0.036270,1.087003,-0.931094,-0.159756,1.087004,0.036266,0.082848},{-0.135564,-0.901238,0.081948,1.126870,-0.901238,-0.135564,1.126871,0.081943,0.082834},{-0.135564,-0.901238,0.081948,1.126870,-0.901238,-0.135564,1.126871,0.081943,0.082834},{-0.149211,-0.904422,0.162243,1.207259,-0.904422,-0.149211,1.207261,0.162238,0.082802},{-0.149211,-0.904422,0.162243,1.207259,-0.904422,-0.149211,1.207261,0.162238,0.082802},{-0.189964,-0.939258,0.325548,1.241209,-0.939258,-0.189963,1.241210,0.325543,0.082746},{-0.189964,-0.939258,0.325548,1.241209,-0.939258,-0.189963,1.241210,0.325543,0.082746},{-0.208780,-0.960409,0.464489,1.282911,-0.960409,-0.208780,1.282912,0.464483,0.082710},{-0.208780,-0.960409,0.464489,1.282911,-0.960409,-0.208780,1.282912,0.464483,0.082710},{-0.206209,-0.996791,0.558432,1.271670,-0.996791,-0.206209,1.271669,0.558426,0.082689},{-0.206209,-0.996791,0.558432,1.271670,-0.996791,-0.206209,1.271669,0.558426,0.082689},{-0.166393,-0.999292,0.948086,1.898579,-0.999291,-0.166393,1.898568,0.948074,0.064019},{-0.217136,-1.451716,0.350655,1.312076,-1.451716,-0.217135,1.312050,0.350687,0.108512},{-0.217136,-1.451716,0.350655,1.312076,-1.451716,-0.217135,1.312050,0.350687,0.108512},{-0.115315,-0.846463,0.172984,0.847246,-0.846463,-0.115313,0.847142,0.173073,0.113142},{-0.115315,-0.846463,0.172984,0.847246,-0.846463,-0.115313,0.847142,0.173073,0.113142},{-0.063654,-0.781751,0.281877,0.653659,-0.781750,-0.063652,0.653481,0.282047,0.114277},{-0.063654,-0.781751,0.281877,0.653659,-0.781750,-0.063652,0.653481,0.282047,0.114277},{-0.042180,-0.610968,0.363444,0.683795,-0.610967,-0.042179,0.683588,0.363635,0.115033},{-0.042180,-0.610968,0.363444,0.683795,-0.610967,-0.042179,0.683588,0.363635,0.115033},{-0.006295,-0.474830,0.412203,0.726729,-0.474828,-0.006294,0.726502,0.412391,0.116331},{-0.006295,-0.474830,0.412203,0.726729,-0.474828,-0.006294,0.726502,0.412391,0.116331},{0.028811,-0.345555,0.470025,0.731082,-0.345553,0.028812,0.730789,0.470250,0.118262},{0.028811,-0.345555,0.470025,0.731082,-0.345553,0.028812,0.730789,0.470250,0.118262},{0.060030,-0.223991,0.432295,0.718554,-0.223990,0.060030,0.718558,0.432213,0.120469},{0.060030,-0.223991,0.432295,0.718554,-0.223990,0.060030,0.718558,0.432213,0.120469},{0.076928,-0.084474,0.489023,0.559786,-0.084473,0.076927,0.559802,0.489008,0.122119},{0.076928,-0.084474,0.489023,0.559786,-0.084473,0.076927,0.559802,0.489008,0.122119},{0.091040,0.061371,0.555091,0.441093,0.061374,0.091043,0.440984,0.554973,0.122647},{0.091040,0.061371,0.555091,0.441093,0.061374,0.091043,0.440984,0.554973,0.122647},{0.104425,0.210869,0.615909,0.364193,0.210864,0.104415,0.364602,0.616535,0.121669},{0.104425,0.210869,0.615909,0.364193,0.210864,0.104415,0.364602,0.616535,0.121669},{0.140900,-0.281677,-0.147902,-0.201464,-0.281604,0.140991,-0.201290,-0.156163,0.068106}};
// float dfVec[TIMESTEPS][MOTORS] = {{0.050125,-0.174516,-0.020736,-0.128433,-0.174516,0.050124,-0.128434,-0.020735,-0.071071},{0.052267,-0.178713,-0.031715,-0.152185,-0.178713,0.052267,-0.152185,-0.031714,-0.075049},{0.054408,-0.151565,-0.003944,-0.089935,-0.151565,0.054408,-0.089935,-0.003944,-0.079190},{0.057224,-0.152896,-0.010227,-0.105538,-0.152895,0.057224,-0.105538,-0.010227,-0.083953},{0.060204,-0.139592,-0.009382,-0.105009,-0.139592,0.060204,-0.105009,-0.009382,-0.088461},{0.063266,-0.139578,-0.014857,-0.118948,-0.139578,0.063266,-0.118948,-0.014857,-0.093117},{0.076969,-0.127300,-0.015663,-0.118503,-0.127300,0.076969,-0.118503,-0.015663,-0.097499},{0.081316,-0.125947,-0.020596,-0.131098,-0.125947,0.081316,-0.131098,-0.020596,-0.101991},{0.092433,-0.111490,-0.019946,-0.131200,-0.111490,0.092433,-0.131200,-0.019945,-0.106238},{0.097770,-0.108864,-0.024313,-0.142717,-0.108864,0.097770,-0.142717,-0.024313,-0.110630},{0.095951,-0.076577,-0.021287,-0.140906,-0.076577,0.095950,-0.140907,-0.021286,-0.114719},{0.101116,-0.071254,-0.024972,-0.151351,-0.071254,0.101116,-0.151351,-0.024972,-0.118851},{0.100479,-0.040515,-0.020681,-0.147914,-0.040515,0.100479,-0.147914,-0.020681,-0.122733},{0.105483,-0.032864,-0.023618,-0.157303,-0.032863,0.105483,-0.157304,-0.023618,-0.126695},{0.105156,-0.003071,-0.018475,-0.152063,-0.003071,0.105156,-0.152063,-0.018475,-0.130441},{0.109953,0.006592,-0.020620,-0.160386,0.006592,0.109953,-0.160386,-0.020620,-0.134288},{0.108731,0.036377,-0.015970,-0.151882,0.036377,0.108729,-0.151882,-0.015970,-0.137928},{0.113214,0.047817,-0.017396,-0.159005,0.047817,0.113213,-0.159005,-0.017396,-0.141657},{0.107036,0.078877,-0.009908,-0.148003,0.078878,0.107033,-0.148003,-0.009908,-0.145211},{0.110256,0.091483,-0.010665,-0.153824,0.091484,0.110253,-0.153824,-0.010665,-0.148902},{0.149661,0.170348,0.038501,-0.142137,0.170353,0.149650,-0.142137,0.038501,-0.152359},{-0.077304,0.097324,-0.021803,-0.219007,0.097356,-0.077360,-0.219007,-0.021803,-0.042485},{-0.070714,0.109823,-0.027180,-0.243329,0.109854,-0.070770,-0.243329,-0.027180,-0.026721},{-0.064187,0.076422,-0.035000,-0.214244,0.076427,-0.064205,-0.214244,-0.035000,-0.015458},{-0.056826,0.089093,-0.038594,-0.230899,0.089098,-0.056843,-0.230899,-0.038594,-0.008358},{-0.031850,0.113602,-0.030038,-0.216354,0.113610,-0.031874,-0.216354,-0.030038,-0.002291},{-0.019538,0.132529,-0.030053,-0.228107,0.132537,-0.019563,-0.228107,-0.030053,0.003032},{0.001422,0.164848,-0.016922,-0.208875,0.164852,0.001404,-0.208874,-0.016922,0.006973},{0.017575,0.188365,-0.012737,-0.215224,0.188369,0.017558,-0.215224,-0.012737,0.010128},{0.058837,0.211930,-0.006115,-0.170709,0.211930,0.058829,-0.170709,-0.006115,0.012862},{0.077021,0.237539,0.000654,-0.166968,0.237539,0.077013,-0.166968,0.000654,0.016114},{0.110640,0.266931,0.008422,-0.117574,0.266929,0.110634,-0.117574,0.008422,0.020449},{0.128204,0.291133,0.016931,-0.103599,0.291131,0.128199,-0.103599,0.016931,0.026850},{0.145148,0.321150,0.024059,-0.069696,0.321152,0.145136,-0.069695,0.024059,0.034885},{0.159152,0.339787,0.032563,-0.050907,0.339789,0.159141,-0.050907,0.032563,0.045097},{0.175467,0.346489,0.037490,-0.009898,0.346490,0.175458,-0.009897,0.037491,0.057049},{0.184142,0.356734,0.045661,0.013814,0.356734,0.184132,0.013814,0.045661,0.066272},{0.180863,0.339283,0.051306,0.061980,0.339278,0.180859,0.061981,0.051306,0.126376},{0.184876,0.342081,0.059133,0.090531,0.342076,0.184872,0.090531,0.059133,0.165527},{0.187885,0.299648,0.069748,0.147718,0.299663,0.187911,0.147720,0.069749,0.199263},{0.188310,0.296734,0.078436,0.180671,0.296749,0.188335,0.180673,0.078436,0.231527},{0.023830,0.156434,0.121326,0.309426,0.156270,0.023554,0.309422,0.121362,0.250846},{-0.017396,-0.020830,0.024278,0.276825,-0.020830,-0.017395,0.276821,0.024280,0.249489},{-0.017883,-0.021894,0.024191,0.277726,-0.021894,-0.017883,0.277723,0.024193,0.249541},{0.014767,0.026453,0.059160,0.252971,0.026453,0.014767,0.252970,0.059160,0.249791},{0.014469,0.025631,0.059237,0.253772,0.025631,0.014469,0.253771,0.059236,0.249883},{0.018542,0.030646,0.066421,0.261351,0.030645,0.018542,0.261351,0.066420,0.249973},{0.018266,0.029852,0.066540,0.262190,0.029852,0.018267,0.262190,0.066539,0.250063},{0.024270,0.036493,0.074585,0.271301,0.036493,0.024270,0.271301,0.074584,0.250153},{0.024029,0.035738,0.074753,0.272189,0.035738,0.024029,0.272190,0.074752,0.250245},{0.025636,0.038123,0.082019,0.275655,0.038123,0.025636,0.275655,0.082018,0.250333},{0.025405,0.037382,0.082225,0.276560,0.037382,0.025405,0.276560,0.082224,0.250421},{0.029379,0.041830,0.090375,0.284398,0.041830,0.029379,0.284398,0.090375,0.250506},{0.029172,0.041116,0.090626,0.285340,0.041116,0.029172,0.285340,0.090625,0.250593},{0.026593,0.039849,0.104842,0.300261,0.039849,0.026593,0.300261,0.104841,0.250667},{0.026378,0.039133,0.105173,0.301285,0.039133,0.026378,0.301285,0.105172,0.250739},{0.019080,0.032362,0.133897,0.308222,0.032362,0.019080,0.308223,0.133896,0.250785},{0.018830,0.031615,0.134385,0.309300,0.031615,0.018830,0.309300,0.134384,0.250822},{0.015308,0.027191,0.159030,0.317637,0.027191,0.015308,0.317637,0.159030,0.250840},{0.015040,0.026425,0.159656,0.318775,0.026425,0.015040,0.318775,0.159655,0.250850},{0.015216,0.019339,0.176612,0.317967,0.019339,0.015216,0.317967,0.176611,0.250847},{0.014942,0.018547,0.177290,0.319062,0.018547,0.014942,0.319062,0.177289,0.250846},{0.021587,0.017320,0.245759,0.429150,0.017320,0.021587,0.429148,0.245757,0.247542},{0.012668,-0.081431,-0.078289,0.204446,-0.081431,0.012668,0.204441,-0.078283,0.066856},{-0.002914,-0.133725,-0.054215,0.230513,-0.133725,-0.002914,0.230508,-0.054209,0.044403},{0.002625,-0.069180,-0.064211,0.172840,-0.069180,0.002626,0.172822,-0.064195,0.031277},{-0.005658,-0.097120,-0.048370,0.190499,-0.097120,-0.005658,0.190481,-0.048355,0.026136},{-0.004011,-0.112225,-0.014063,0.174009,-0.112225,-0.004010,0.173978,-0.014033,0.022557},{-0.010340,-0.137450,0.000381,0.189691,-0.137450,-0.010340,0.189660,0.000410,0.019965},{-0.012060,-0.130492,0.029337,0.210772,-0.130491,-0.012060,0.210737,0.029370,0.016731},{-0.016627,-0.150676,0.044247,0.226342,-0.150676,-0.016627,0.226306,0.044280,0.012236},{-0.013927,-0.145387,0.067242,0.248381,-0.145387,-0.013927,0.248341,0.067275,0.006720},{-0.016384,-0.161888,0.081140,0.261579,-0.161888,-0.016383,0.261540,0.081172,-0.000406},{-0.011697,-0.154226,0.103887,0.273459,-0.154226,-0.011697,0.273408,0.103926,-0.008185},{-0.012016,-0.167207,0.115329,0.282379,-0.167206,-0.012016,0.282328,0.115369,-0.017178},{-0.005904,-0.157262,0.118151,0.286210,-0.157262,-0.005904,0.286211,0.118137,-0.025230},{-0.004148,-0.166514,0.125514,0.289547,-0.166514,-0.004148,0.289548,0.125499,-0.032638},{0.001367,-0.149289,0.140738,0.262869,-0.149289,0.001367,0.262872,0.140735,-0.038004},{0.004769,-0.153898,0.144355,0.261652,-0.153898,0.004769,0.261655,0.144353,-0.041461},{0.011429,-0.130601,0.158232,0.238544,-0.130600,0.011430,0.238525,0.158211,-0.043060},{0.016426,-0.129912,0.159647,0.235031,-0.129912,0.016427,0.235012,0.159626,-0.042808},{0.024537,-0.100417,0.170951,0.217637,-0.100418,0.024536,0.217707,0.171060,-0.041245},{0.031399,-0.092074,0.171647,0.213568,-0.092075,0.031397,0.213639,0.171756,-0.038436},{0.043373,-0.177119,0.036692,0.108982,-0.177106,0.043389,0.109012,0.035259,-0.041324}};

// New no offset, didn't save, looks pretty good?
// float times[TIMESTEPS] = {0.000000,0.001174,0.002347,0.003521,0.004695,0.005869,0.007042,0.008216,0.009390,0.010564,0.011737,0.012911,0.014085,0.015258,0.016432,0.017606,0.018780,0.019953,0.021127,0.022301,0.023474,0.023474,0.026484,0.029494,0.032504,0.035514,0.038523,0.041533,0.044543,0.047553,0.050563,0.053572,0.056582,0.059592,0.062602,0.065612,0.068621,0.071631,0.074641,0.077651,0.080661,0.083670,0.083670,0.083738,0.083806,0.083874,0.083941,0.084009,0.084077,0.084144,0.084212,0.084280,0.084347,0.084415,0.084483,0.084550,0.084618,0.084686,0.084753,0.084821,0.084889,0.084957,0.085024,0.085024,0.088374,0.091724,0.095074,0.098424,0.101774,0.105124,0.108474,0.111824,0.115174,0.118524,0.121875,0.125225,0.128575,0.131925,0.135275,0.138625,0.141975,0.145325,0.148675,0.152025};
// float pos[TIMESTEPS][MOTORS] = {{0.578397,0.811201,0.539042,1.315375,0.811198,0.578396,1.315375,0.539045,0.048737},{0.577998,0.788922,0.551906,1.335515,0.788921,0.577997,1.335515,0.551906,0.048293},{0.577582,0.766250,0.563721,1.352533,0.766249,0.577582,1.352533,0.563722,0.047612},{0.577184,0.743365,0.574755,1.367153,0.743365,0.577184,1.367153,0.574755,0.046702},{0.576834,0.720412,0.585142,1.379767,0.720412,0.576834,1.379767,0.585142,0.045611},{0.576563,0.697503,0.594948,1.390494,0.697503,0.576563,1.390494,0.594948,0.044363},{0.576408,0.674784,0.604201,1.399449,0.674784,0.576408,1.399449,0.604201,0.042994},{0.576412,0.652446,0.612917,1.406716,0.652446,0.576412,1.406716,0.612917,0.041505},{0.576608,0.630638,0.621108,1.412384,0.630638,0.576608,1.412384,0.621108,0.039916},{0.577018,0.609496,0.628791,1.416528,0.609496,0.577018,1.416528,0.628791,0.038230},{0.577653,0.589130,0.635986,1.419231,0.589131,0.577653,1.419231,0.635986,0.036463},{0.578508,0.569661,0.642722,1.420567,0.569662,0.578508,1.420567,0.642722,0.034618},{0.579593,0.551171,0.649023,1.420611,0.551171,0.579592,1.420611,0.649023,0.032709},{0.580930,0.533736,0.654919,1.419424,0.533736,0.580930,1.419424,0.654919,0.030740},{0.582530,0.517439,0.660446,1.417064,0.517439,0.582529,1.417064,0.660446,0.028722},{0.584384,0.502399,0.665662,1.413570,0.502400,0.584384,1.413570,0.665662,0.026657},{0.586503,0.488721,0.670608,1.408997,0.488722,0.586500,1.408997,0.670608,0.024556},{0.588915,0.476530,0.675322,1.403401,0.476532,0.588914,1.403401,0.675322,0.022420},{0.591631,0.465965,0.679837,1.396844,0.465968,0.591621,1.396844,0.679837,0.020258},{0.594634,0.457223,0.684150,1.389359,0.457227,0.594629,1.389359,0.684150,0.018071},{0.597942,0.450501,0.688418,1.381118,0.450507,0.597900,1.381118,0.688418,0.015863},{0.597865,0.450432,0.688414,1.381045,0.450441,0.597861,1.381045,0.688414,0.015943},{0.528804,0.400835,0.693657,1.355316,0.400841,0.528804,1.355316,0.693657,0.010345},{0.464557,0.359378,0.698017,1.322367,0.359385,0.464554,1.322367,0.698017,0.003922},{0.406080,0.327762,0.701223,1.283688,0.327765,0.406079,1.283688,0.701223,-0.003203},{0.355339,0.307976,0.703429,1.240306,0.307978,0.355338,1.240306,0.703429,-0.010816},{0.314404,0.303063,0.705227,1.192978,0.303064,0.314403,1.192978,0.705227,-0.018756},{0.285097,0.314920,0.707081,1.142574,0.314921,0.285096,1.142574,0.707081,-0.026780},{0.268476,0.345211,0.709446,1.090080,0.345211,0.268475,1.090080,0.709446,-0.034632},{0.265053,0.394092,0.712410,1.036580,0.394092,0.265052,1.036580,0.712410,-0.042056},{0.274755,0.461707,0.715861,0.983282,0.461708,0.274754,0.983282,0.715861,-0.048791},{0.295674,0.544877,0.719441,0.931209,0.544878,0.295673,0.931209,0.719441,-0.054670},{0.324731,0.639127,0.722627,0.881225,0.639126,0.324730,0.881225,0.722627,-0.059584},{0.358245,0.739138,0.725179,0.834019,0.739138,0.358244,0.834019,0.725179,-0.063528},{0.392718,0.839370,0.727038,0.790091,0.839370,0.392718,0.790091,0.727038,-0.066570},{0.426210,0.937256,0.728337,0.750000,0.937257,0.426210,0.750000,0.728337,-0.068778},{0.458320,1.031731,0.729312,0.714312,1.031731,0.458320,0.714312,0.729312,-0.070181},{0.488523,1.122391,0.730049,0.683730,1.122391,0.488523,0.683730,0.730049,-0.070852},{0.516791,1.208887,0.730498,0.659057,1.208887,0.516791,0.659056,0.730498,-0.070879},{0.542960,1.291316,0.730574,0.641134,1.291316,0.542960,0.641135,0.730576,-0.070315},{0.567177,1.369821,0.730484,0.630784,1.369821,0.567177,0.630781,0.730485,-0.069177},{0.589414,1.444487,0.729202,0.629219,1.444487,0.589415,0.629222,0.729219,-0.067430},{0.589499,1.444397,0.729224,0.629151,1.444397,0.589501,0.629152,0.729228,-0.067347},{0.589939,1.445969,0.729191,0.629218,1.445969,0.589939,0.629218,0.729191,-0.067260},{0.590379,1.447539,0.729156,0.629287,1.447539,0.590380,0.629288,0.729156,-0.067171},{0.590817,1.449104,0.729123,0.629361,1.449104,0.590817,0.629361,0.729123,-0.067082},{0.591255,1.450666,0.729090,0.629437,1.450666,0.591255,0.629438,0.729090,-0.066992},{0.591691,1.452224,0.729059,0.629518,1.452224,0.591691,0.629518,0.729059,-0.066901},{0.592127,1.453778,0.729028,0.629601,1.453778,0.592127,0.629601,0.729027,-0.066810},{0.592561,1.455328,0.728998,0.629689,1.455328,0.592561,0.629689,0.728998,-0.066718},{0.592996,1.456874,0.728968,0.629779,1.456874,0.592996,0.629779,0.728968,-0.066625},{0.593429,1.458415,0.728941,0.629873,1.458415,0.593429,0.629873,0.728940,-0.066532},{0.593863,1.459953,0.728912,0.629971,1.459953,0.593863,0.629971,0.728912,-0.066438},{0.594294,1.461486,0.728886,0.630072,1.461486,0.594294,0.630072,0.728886,-0.066343},{0.594725,1.463014,0.728859,0.630176,1.463014,0.594725,0.630176,0.728859,-0.066248},{0.595155,1.464538,0.728835,0.630284,1.464538,0.595155,0.630284,0.728834,-0.066152},{0.595584,1.466058,0.728809,0.630395,1.466058,0.595584,0.630395,0.728808,-0.066055},{0.596012,1.467572,0.728785,0.630510,1.467572,0.596012,0.630510,0.728784,-0.065958},{0.596439,1.469082,0.728760,0.630626,1.469082,0.596439,0.630627,0.728757,-0.065860},{0.596865,1.470587,0.728734,0.630746,1.470587,0.596865,0.630747,0.728732,-0.065762},{0.597290,1.472088,0.728710,0.630867,1.472088,0.597290,0.630869,0.728700,-0.065663},{0.597714,1.473584,0.728680,0.630992,1.473584,0.597714,0.630994,0.728671,-0.065563},{0.598138,1.475075,0.728664,0.631117,1.475075,0.598138,0.631123,0.728620,-0.065463},{0.598123,1.474994,0.728576,0.631050,1.474994,0.598123,0.631065,0.728570,-0.065381},{0.615900,1.533914,0.641754,0.591929,1.533914,0.615900,0.591937,0.641750,-0.061603},{0.628704,1.572781,0.555388,0.551271,1.572781,0.628704,0.551285,0.555383,-0.055846},{0.638008,1.596544,0.470972,0.511060,1.596544,0.638008,0.511067,0.470969,-0.048812},{0.644457,1.607645,0.390891,0.473818,1.607645,0.644457,0.473829,0.390887,-0.040980},{0.648128,1.606856,0.317829,0.443304,1.606856,0.648128,0.443309,0.317827,-0.032544},{0.649192,1.595013,0.254833,0.423246,1.595013,0.649192,0.423252,0.254830,-0.023713},{0.647920,1.572916,0.204721,0.417888,1.572916,0.647920,0.417890,0.204719,-0.014624},{0.644681,1.541669,0.169811,0.430211,1.541669,0.644681,0.430212,0.169808,-0.005477},{0.640015,1.502684,0.152155,0.463122,1.502684,0.640015,0.463123,0.152153,0.003539},{0.634340,1.456893,0.151854,0.515995,1.456893,0.634340,0.515996,0.151852,0.012162},{0.628057,1.404846,0.168021,0.586805,1.404846,0.628057,0.586806,0.168019,0.020085},{0.621431,1.347178,0.197252,0.670187,1.347178,0.621431,0.670188,0.197250,0.027121},{0.614633,1.284555,0.235126,0.759624,1.284555,0.614633,0.759628,0.235125,0.033219},{0.607810,1.218051,0.277750,0.850290,1.218051,0.607810,0.850290,0.277748,0.038328},{0.601087,1.149002,0.322512,0.938712,1.149002,0.601087,0.938712,0.322511,0.042392},{0.594686,1.078744,0.367560,1.023300,1.078744,0.594687,1.023299,0.367559,0.045429},{0.588944,1.008538,0.412211,1.103291,1.008538,0.588944,1.103291,0.412210,0.047508},{0.584147,0.939683,0.455760,1.178585,0.939682,0.584148,1.178584,0.455759,0.048701},{0.580748,0.874450,0.498215,1.249343,0.874451,0.580750,1.249343,0.498214,0.049110},{0.578386,0.811268,0.538972,1.315466,0.811266,0.578388,1.315466,0.538970,0.048661}};
// float vel[TIMESTEPS][MOTORS] = {{-0.341979,-18.741592,11.463746,18.714718,-18.741592,-0.341979,18.714718,11.463746,-0.294638},{-0.368687,-19.149709,10.477748,15.768040,-19.149709,-0.368687,15.768040,10.477748,-0.516081},{-0.367886,-19.412473,9.687790,13.383916,-19.412473,-0.367886,13.383916,9.687790,-0.714194},{-0.340416,-19.520391,9.115989,11.615674,-19.520391,-0.340416,11.615674,9.115989,-0.890092},{-0.285410,-19.527053,8.590483,9.955847,-19.527053,-0.285410,9.955847,8.590483,-1.036322},{-0.204506,-19.439546,8.116176,8.403548,-19.439546,-0.204506,8.403548,8.116176,-1.149625},{-0.088564,-19.200363,7.652552,6.929315,-19.200363,-0.088564,6.929315,7.652552,-1.252923},{0.064693,-18.800473,7.198878,5.530194,-18.800473,0.064693,5.530194,7.198878,-1.346036},{0.235801,-18.292669,6.759965,4.200536,-18.292669,0.235801,4.200536,6.759965,-1.430265},{0.427355,-17.673484,6.334375,2.937194,-17.673484,0.427355,2.937194,6.334375,-1.505321},{0.618423,-16.963061,5.931191,1.740588,-16.963062,0.618423,1.740588,5.931191,-1.573229},{0.805615,-16.156604,5.549685,0.609774,-16.156604,0.805615,0.609774,5.549685,-1.634026},{1.009585,-15.287252,5.193512,-0.466125,-15.287252,1.009585,-0.466125,5.193512,-1.687431},{1.233532,-14.360642,4.859396,-1.486678,-14.360642,1.233532,-1.486678,4.859396,-1.733036},{1.455172,-13.339331,4.569112,-2.468057,-13.339332,1.455172,-2.468057,4.569112,-1.773668},{1.670459,-12.225404,4.324786,-3.413714,-12.225404,1.670458,-3.413714,4.324786,-1.809322},{1.906150,-11.006767,4.110963,-4.308919,-11.006768,1.906151,-4.308919,4.110963,-1.840003},{2.166873,-9.693357,3.927745,-5.155998,-9.693356,2.166872,-5.155998,3.927745,-1.865409},{2.420678,-8.219409,3.774781,-5.945533,-8.219411,2.420679,-5.945533,3.774781,-1.887610},{2.664758,-6.596783,3.617396,-6.707987,-6.596783,2.664758,-6.707987,3.617396,-1.905981},{2.918621,-4.748593,3.698762,-7.234731,-4.748592,2.918621,-7.234731,3.698762,-1.924838},{-23.561524,-17.684109,1.847971,-7.197652,-17.684106,-23.561513,-7.197652,1.847971,-1.708611},{-22.240826,-15.242782,1.600536,-9.813852,-15.242781,-22.240824,-9.813852,1.600536,-2.020065},{-20.438373,-12.183772,1.281197,-11.977417,-12.183771,-20.438371,-11.977417,1.281197,-2.273533},{-18.288096,-8.714670,0.864603,-13.664775,-8.714670,-18.288095,-13.664775,0.864603,-2.472934},{-15.363030,-4.248945,0.626867,-15.097842,-4.248945,-15.363029,-15.097842,0.626867,-2.607183},{-11.764095,1.061801,0.580555,-16.278868,1.061800,-11.764095,-16.278868,0.580554,-2.679838},{-7.687170,6.960724,0.671600,-17.139674,6.960725,-7.687170,-17.139674,0.671600,-2.667705},{-3.350069,13.168661,0.888114,-17.660062,13.168660,-3.350069,-17.660062,0.888113,-2.564556},{1.020290,19.369100,1.072252,-17.808192,19.369100,1.020290,-17.808192,1.072253,-2.384388},{5.242527,25.317010,1.191256,-17.540562,25.317010,5.242527,-17.540563,1.191256,-2.114268},{8.441127,29.750960,1.155738,-16.996960,29.750961,8.441126,-16.996959,1.155739,-1.815108},{10.587611,32.596031,0.953111,-16.165973,32.596031,10.587610,-16.165975,0.953110,-1.482101},{11.486182,33.587621,0.730969,-15.155323,33.587622,11.486181,-15.155320,0.730971,-1.169684},{11.315198,32.991938,0.509627,-13.981442,32.991937,11.315198,-13.981445,0.509623,-0.883749},{10.909442,32.013003,0.355246,-12.607416,32.013003,10.909442,-12.607411,0.355250,-0.612536},{10.350749,30.789716,0.282620,-11.044350,30.789716,10.350749,-11.044357,0.282613,-0.353818},{9.711894,29.454254,0.194833,-9.211634,29.454254,9.711894,-9.211624,0.194843,-0.123182},{9.027101,28.070831,0.088495,-7.116957,28.070830,9.027100,-7.116970,0.088482,0.075864},{8.354041,26.730862,-0.050976,-4.717640,26.730862,8.354042,-4.717622,-0.050956,0.272042},{7.716359,25.466556,-0.125241,-2.057840,25.466557,7.716361,-2.057861,-0.125268,0.460111},{7.001120,24.167489,-0.830444,1.138821,24.167489,7.001117,1.138831,-0.830429,0.680614},{6.684267,23.858379,-0.844421,1.413865,23.858379,6.684267,1.413865,-0.844421,0.680020},{6.667994,23.811948,-0.817824,1.467503,23.811948,6.667994,1.467503,-0.817824,0.692072},{6.648208,23.759662,-0.795509,1.521068,23.759662,6.648208,1.521068,-0.795509,0.703677},{6.623588,23.700556,-0.778407,1.574639,23.700556,6.623588,1.574639,-0.778407,0.714742},{6.603413,23.641450,-0.760008,1.627661,23.641450,6.603413,1.627661,-0.760008,0.725899},{6.588245,23.582435,-0.739959,1.680112,23.582435,6.588245,1.680112,-0.739959,0.737198},{6.574081,23.522846,-0.720724,1.732145,23.522846,6.574081,1.732145,-0.720724,0.748293},{6.561227,23.462863,-0.702613,1.783547,23.462863,6.561227,1.783547,-0.702613,0.759245},{6.547523,23.401220,-0.683459,1.835802,23.401220,6.547523,1.835802,-0.683459,0.769622},{6.533011,23.337973,-0.663149,1.889050,23.337973,6.533011,1.889050,-0.663149,0.779354},{6.517393,23.272748,-0.642479,1.942302,23.272748,6.517393,1.942302,-0.642479,0.788923},{6.500547,23.205431,-0.621124,1.995842,23.205431,6.500547,1.995842,-0.621124,0.798315},{6.483317,23.136829,-0.601357,2.047681,23.136829,6.483317,2.047681,-0.601357,0.807639},{6.465597,23.066793,-0.582916,2.097994,23.066793,6.465597,2.097994,-0.582916,0.816896},{6.448125,22.996370,-0.567630,2.145562,22.996370,6.448125,2.145562,-0.567630,0.826083},{6.430830,22.925455,-0.555452,2.190416,22.925455,6.430830,2.190416,-0.555452,0.835195},{6.414211,22.854799,-0.546701,2.232331,22.854799,6.414211,2.232331,-0.546701,0.844261},{6.398169,22.784298,-0.541591,2.271214,22.784298,6.398169,2.271214,-0.541591,0.853281},{6.383388,22.714676,-0.538608,2.307710,22.714676,6.383388,2.307710,-0.538608,0.862244},{6.369672,22.644344,-0.538849,2.343692,22.644344,6.369672,2.343692,-0.538849,0.871344},{6.358368,22.584423,-0.534640,2.366053,22.584423,6.358368,2.366053,-0.534640,0.879230},{6.160071,21.046837,-25.845574,-11.349235,21.046837,6.160071,-11.349229,-25.845564,0.745115},{4.495416,14.377878,-25.937851,-11.999940,14.377878,4.495416,-11.999938,-25.937848,1.444788},{3.204060,9.076994,-25.581519,-12.177410,9.076994,3.204060,-12.177408,-25.581516,1.942699},{2.340702,5.172698,-24.699152,-11.736877,5.172698,2.340701,-11.736878,-24.699151,2.217934},{1.506036,1.518414,-23.016871,-10.316389,1.518414,1.506036,-10.316389,-23.016869,2.427865},{0.687590,-1.920921,-20.470098,-7.763954,-1.920921,0.687590,-7.763956,-20.470097,2.573821},{-0.043653,-5.082170,-17.029684,-3.987241,-5.082170,-0.043653,-3.987242,-17.029683,2.670296},{-0.701677,-8.019565,-12.807171,0.895942,-8.019565,-0.701678,0.895942,-12.807171,2.720417},{-1.212048,-10.547223,-7.965703,6.634048,-10.547222,-1.212047,6.634048,-7.965703,2.709567},{-1.563933,-12.673822,-2.646871,12.914460,-12.673823,-1.563934,12.914460,-2.646871,2.635026},{-1.810703,-14.615096,2.390102,18.607745,-14.615095,-1.810702,18.607746,2.390101,2.478512},{-1.938010,-16.400310,6.983133,23.350050,-16.400312,-1.938012,23.350050,6.983134,2.224647},{-2.011878,-17.975663,10.249522,26.155276,-17.975660,-2.011875,26.155274,10.249522,1.951483},{-2.042999,-19.326107,12.147166,27.079275,-19.326111,-2.043003,27.079276,12.147164,1.663909},{-2.024591,-20.296982,13.168515,26.895581,-20.296977,-2.024585,26.895583,13.168514,1.362515},{-1.976242,-20.843982,13.441212,25.879653,-20.843991,-1.976250,25.879653,13.441212,1.045003},{-1.831242,-21.021581,13.415147,24.601811,-21.021570,-1.831232,24.601811,13.415147,0.748677},{-1.587138,-20.809957,13.167915,23.188681,-20.809974,-1.587151,23.188681,13.167914,0.474035},{-1.266942,-20.213827,12.823942,21.786655,-20.213804,-1.266925,21.786654,12.823942,0.217893},{-0.812823,-18.935063,12.454315,20.462360,-18.935095,-0.812843,20.462363,12.454318,-0.006542},{-0.648813,-18.986530,11.810590,19.026433,-18.986511,-0.648801,19.026432,11.810585,-0.296002}};
// float u[TIMESTEPS][MOTORS] = {{0.020272,-0.116735,-0.264568,-1.446611,-0.116734,0.020271,-1.446613,-0.264566,-0.920581},{0.020272,-0.116735,-0.264568,-1.446611,-0.116734,0.020271,-1.446613,-0.264566,-0.920581},{0.012213,0.007856,-0.158349,-0.913474,0.007856,0.012213,-0.913475,-0.158348,-0.723122},{0.012213,0.007856,-0.158349,-0.913474,0.007856,0.012213,-0.913475,-0.158348,-0.723122},{0.015942,0.085637,-0.113730,-0.830077,0.085637,0.015941,-0.830077,-0.113729,-0.476801},{0.015942,0.085637,-0.113730,-0.830077,0.085637,0.015941,-0.830077,-0.113729,-0.476801},{0.020289,0.210888,-0.108815,-0.765772,0.210889,0.020289,-0.765773,-0.108815,-0.395941},{0.020289,0.210888,-0.108815,-0.765772,0.210889,0.020289,-0.765773,-0.108815,-0.395941},{0.018298,0.296767,-0.100580,-0.703882,0.296767,0.018297,-0.703882,-0.100579,-0.323147},{0.018298,0.296767,-0.100580,-0.703882,0.296767,0.018297,-0.703882,-0.100579,-0.323147},{0.004175,0.370017,-0.085452,-0.640135,0.370017,0.004174,-0.640135,-0.085451,-0.264102},{0.004175,0.370017,-0.085452,-0.640135,0.370017,0.004174,-0.640135,-0.085451,-0.264102},{0.010162,0.414733,-0.065769,-0.585749,0.414733,0.010161,-0.585749,-0.065769,-0.202384},{0.010162,0.414733,-0.065769,-0.585749,0.414733,0.010161,-0.585749,-0.065769,-0.202384},{-0.005252,0.492227,-0.022967,-0.550791,0.492227,-0.005254,-0.550792,-0.022967,-0.160888},{-0.005252,0.492227,-0.022967,-0.550791,0.492227,-0.005254,-0.550792,-0.022967,-0.160888},{-0.002879,0.574623,0.002478,-0.496822,0.574623,-0.002884,-0.496822,0.002478,-0.119806},{-0.002879,0.574623,0.002478,-0.496822,0.574623,-0.002884,-0.496822,0.002478,-0.119806},{-0.032669,0.711562,0.026331,-0.432821,0.711557,-0.032681,-0.432821,0.026331,-0.094350},{-0.032669,0.711562,0.026331,-0.432821,0.711557,-0.032681,-0.432821,0.026331,-0.094350},{-0.061261,0.909369,0.239221,-0.201229,0.909419,-0.061361,-0.201229,0.239219,-0.094091},{0.521091,1.195226,0.137440,-0.640533,1.195489,0.520673,-0.640533,0.137440,-0.616867},{0.521091,1.195226,0.137440,-0.640533,1.195489,0.520673,-0.640533,0.137440,-0.616867},{0.411674,1.018864,0.040389,-0.391010,1.018916,0.411571,-0.391009,0.040390,-0.404811},{0.411674,1.018864,0.040389,-0.391010,1.018916,0.411571,-0.391009,0.040390,-0.404811},{0.558437,1.044241,0.074493,-0.260194,1.044280,0.558361,-0.260192,0.074493,-0.174794},{0.558437,1.044241,0.074493,-0.260194,1.044280,0.558361,-0.260192,0.074493,-0.174794},{0.639592,1.095515,0.093255,-0.109940,1.095208,0.640013,-0.109938,0.093254,0.115534},{0.639592,1.095515,0.093255,-0.109940,1.095208,0.640013,-0.109938,0.093254,0.115534},{0.906865,1.029604,0.066828,0.045195,1.029606,0.906843,0.045197,0.066828,0.352488},{0.906865,1.029604,0.066828,0.045195,1.029606,0.906843,0.045197,0.066828,0.352488},{1.053496,0.607700,-0.001144,0.155177,0.607702,1.053468,0.155179,-0.001143,0.436746},{1.053496,0.607700,-0.001144,0.155177,0.607702,1.053468,0.155179,-0.001143,0.436746},{0.775401,0.116414,-0.042362,0.228278,0.116422,0.775392,0.228279,-0.042360,0.399371},{0.775401,0.116414,-0.042362,0.228278,0.116422,0.775392,0.228279,-0.042360,0.399371},{0.733339,0.009030,-0.039999,0.297028,0.009043,0.733349,0.297030,-0.039996,0.370878},{0.733339,0.009030,-0.039999,0.297028,0.009043,0.733349,0.297030,-0.039996,0.370878},{0.618818,-0.050024,-0.070688,0.396084,-0.050010,0.618845,0.396089,-0.070682,0.296445},{0.618818,-0.050024,-0.070688,0.396084,-0.050010,0.618845,0.396089,-0.070682,0.296445},{0.487512,-0.084567,-0.102601,0.509709,-0.084549,0.487560,0.509722,-0.102592,0.299323},{0.487512,-0.084567,-0.102601,0.509709,-0.084549,0.487560,0.509722,-0.102592,0.299323},{-0.156871,-0.211834,-0.361835,0.764154,-0.211850,-0.157098,0.764230,-0.361638,0.424081},{-0.111138,-0.375165,0.144090,0.412264,-0.375166,-0.111138,0.412265,0.144089,0.876292},{-0.111138,-0.375165,0.144090,0.412264,-0.375166,-0.111138,0.412265,0.144089,0.876292},{-0.156004,-0.478254,0.073628,0.424587,-0.478254,-0.156003,0.424587,0.073627,0.812623},{-0.156004,-0.478254,0.073628,0.424587,-0.478254,-0.156003,0.424587,0.073627,0.812623},{-0.068662,-0.497026,0.095643,0.410880,-0.497026,-0.068662,0.410881,0.095642,0.825525},{-0.068662,-0.497026,0.095643,0.410880,-0.497026,-0.068662,0.410881,0.095642,0.825525},{-0.045773,-0.512976,0.083103,0.406026,-0.512976,-0.045774,0.406026,0.083102,0.795977},{-0.045773,-0.512976,0.083103,0.406026,-0.512976,-0.045774,0.406026,0.083102,0.795977},{-0.054305,-0.540316,0.092332,0.416539,-0.540316,-0.054305,0.416539,0.092331,0.714748},{-0.054305,-0.540316,0.092332,0.416539,-0.540316,-0.054305,0.416539,0.092331,0.714748},{-0.067664,-0.575863,0.095900,0.415648,-0.575863,-0.067665,0.415649,0.095899,0.692347},{-0.067664,-0.575863,0.095900,0.415648,-0.575863,-0.067665,0.415649,0.095899,0.692347},{-0.069475,-0.601941,0.075858,0.392360,-0.601941,-0.069475,0.392361,0.075857,0.682272},{-0.069475,-0.601941,0.075858,0.392360,-0.601941,-0.069475,0.392361,0.075857,0.682272},{-0.062093,-0.613264,0.035537,0.356315,-0.613264,-0.062093,0.356316,0.035536,0.670642},{-0.062093,-0.613264,0.035537,0.356315,-0.613264,-0.062093,0.356316,0.035536,0.670642},{-0.048786,-0.613614,-0.007890,0.317786,-0.613615,-0.048787,0.317788,-0.007893,0.661853},{-0.048786,-0.613614,-0.007890,0.317786,-0.613615,-0.048787,0.317788,-0.007893,0.661853},{-0.026314,-0.603156,-0.032990,0.284331,-0.603157,-0.026315,0.284336,-0.032997,0.651807},{-0.026314,-0.603156,-0.032990,0.284331,-0.603157,-0.026315,0.284336,-0.032997,0.651807},{-0.013655,-0.394307,0.074562,0.041943,-0.394307,-0.013655,0.041938,0.074569,0.473895},{-0.124088,-1.197896,-0.041988,1.006942,-1.197898,-0.124086,1.007294,-0.042369,1.062152},{-0.124088,-1.197896,-0.041988,1.006942,-1.197898,-0.124086,1.007294,-0.042369,1.062152},{-0.058844,-0.728503,0.113044,0.912409,-0.728504,-0.058841,0.912585,0.112820,0.476083},{-0.058844,-0.728503,0.113044,0.912409,-0.728504,-0.058841,0.912585,0.112820,0.476083},{-0.069908,-0.638860,0.223072,1.016083,-0.638859,-0.069905,1.016053,0.223090,0.293356},{-0.069908,-0.638860,0.223072,1.016083,-0.638859,-0.069905,1.016053,0.223090,0.293356},{-0.058320,-0.521025,0.459592,1.026806,-0.521025,-0.058319,1.026823,0.459579,0.139103},{-0.058320,-0.521025,0.459592,1.026806,-0.521025,-0.058319,1.026823,0.459579,0.139103},{-0.035304,-0.331358,0.676186,1.057268,-0.331357,-0.035304,1.057288,0.676182,-0.048083},{-0.035304,-0.331358,0.676186,1.057268,-0.331357,-0.035304,1.057288,0.676182,-0.048083},{-0.013834,-0.214490,0.859416,0.827701,-0.214488,-0.013833,0.827717,0.859408,-0.278340},{-0.013834,-0.214490,0.859416,0.827701,-0.214488,-0.013833,0.827717,0.859408,-0.278340},{-0.013722,-0.108749,0.809660,0.346853,-0.108746,-0.013719,0.346843,0.809642,-0.335083},{-0.013722,-0.108749,0.809660,0.346853,-0.108746,-0.013719,0.346843,0.809642,-0.335083},{-0.019117,0.029251,0.671458,0.078986,0.029254,-0.019114,0.078987,0.671445,-0.396303},{-0.019117,0.029251,0.671458,0.078986,0.029254,-0.019114,0.078987,0.671445,-0.396303},{-0.004256,0.136374,0.602925,-0.003887,0.136380,-0.004250,-0.003883,0.602921,-0.353706},{-0.004256,0.136374,0.602925,-0.003887,0.136380,-0.004250,-0.003883,0.602921,-0.353706},{0.003693,0.236943,0.540396,-0.034581,0.236951,0.003704,-0.034572,0.540421,-0.315083},{0.003693,0.236943,0.540396,-0.034581,0.236951,0.003704,-0.034572,0.540421,-0.315083},{0.011073,-0.221965,-0.165081,-0.213764,-0.221804,0.011159,-0.213774,-0.165278,-0.534791}};
// float dfVec[TIMESTEPS][MOTORS] = {{0.001316,-0.167562,0.036906,-0.137834,-0.167561,0.001316,-0.137835,0.036907,-0.283018},{0.001109,-0.170714,0.029290,-0.160596,-0.170714,0.001109,-0.160597,0.029290,-0.360661},{-0.000458,-0.148422,0.043923,-0.074937,-0.148422,-0.000458,-0.074937,0.043923,-0.391578},{-0.000245,-0.149256,0.039506,-0.088596,-0.149255,-0.000245,-0.088596,0.039506,-0.453252},{0.000907,-0.134123,0.044157,-0.085137,-0.134123,0.000907,-0.085137,0.044157,-0.456438},{0.001532,-0.133447,0.040493,-0.097128,-0.133447,0.001532,-0.097128,0.040493,-0.496165},{0.003277,-0.107148,0.037871,-0.095963,-0.107148,0.003277,-0.095963,0.037871,-0.516598},{0.004460,-0.104059,0.034367,-0.106771,-0.104059,0.004460,-0.106771,0.034367,-0.549246},{0.005393,-0.083372,0.032584,-0.104960,-0.083372,0.005393,-0.104960,0.032584,-0.564568},{0.006873,-0.078589,0.029296,-0.114719,-0.078589,0.006873,-0.114719,0.029297,-0.590885},{0.005592,-0.058802,0.029135,-0.111518,-0.058802,0.005592,-0.111518,0.029135,-0.603168},{0.007038,-0.052572,0.026188,-0.120253,-0.052572,0.007038,-0.120254,0.026188,-0.624486},{0.009782,-0.037127,0.027279,-0.117947,-0.037127,0.009782,-0.117948,0.027279,-0.631162},{0.011512,-0.029970,0.024698,-0.125831,-0.029970,0.011512,-0.125831,0.024698,-0.647152},{0.010215,-0.006952,0.030812,-0.126587,-0.006952,0.010215,-0.126588,0.030812,-0.653298},{0.011878,0.001652,0.028924,-0.133892,0.001652,0.011878,-0.133893,0.028924,-0.665799},{0.014162,0.027151,0.032240,-0.130272,0.027151,0.014161,-0.130272,0.032240,-0.668537},{0.016176,0.037297,0.030824,-0.136815,0.037297,0.016175,-0.136815,0.030824,-0.677445},{0.012322,0.075415,0.034299,-0.130420,0.075414,0.012319,-0.130420,0.034299,-0.680260},{0.014207,0.087949,0.033084,-0.136310,0.087948,0.014205,-0.136310,0.033083,-0.686701},{0.010586,0.140841,0.075271,-0.095169,0.140851,0.010567,-0.095169,0.075271,-0.693262},{-0.080281,0.096721,0.041105,-0.180641,0.096773,-0.080362,-0.180641,0.041105,-0.719501},{-0.070079,0.115580,0.039194,-0.200850,0.115631,-0.070161,-0.200850,0.039194,-0.828705},{-0.077515,0.104781,0.017781,-0.168853,0.104791,-0.077536,-0.168853,0.017782,-0.876180},{-0.060905,0.131579,0.014563,-0.181887,0.131589,-0.060925,-0.181887,0.014564,-0.946095},{-0.009660,0.171029,0.019385,-0.167420,0.171037,-0.009674,-0.167420,0.019385,-0.948263},{0.018141,0.212053,0.019027,-0.176543,0.212061,0.018126,-0.176543,0.019027,-0.973738},{0.065477,0.267630,0.023393,-0.153861,0.267570,0.065559,-0.153860,0.023392,-0.912807},{0.098979,0.315585,0.025065,-0.157881,0.315525,0.099062,-0.157880,0.025065,-0.876641},{0.184915,0.350614,0.021329,-0.128740,0.350615,0.184911,-0.128740,0.021329,-0.767213},{0.217530,0.396560,0.022248,-0.126673,0.396560,0.217526,-0.126672,0.022248,-0.672502},{0.270863,0.348449,0.008704,-0.101004,0.348450,0.270858,-0.101003,0.008705,-0.551161},{0.287444,0.370426,0.007139,-0.094584,0.370427,0.287439,-0.094584,0.007139,-0.434401},{0.240097,0.282180,-0.002623,-0.072507,0.282182,0.240095,-0.072507,-0.002623,-0.332156},{0.238776,0.277578,-0.004333,-0.063439,0.277580,0.238774,-0.063439,-0.004333,-0.231900},{0.227431,0.249054,-0.005064,-0.039404,0.249056,0.227433,-0.039404,-0.005064,-0.142369},{0.223115,0.239604,-0.005625,-0.027330,0.239607,0.223117,-0.027330,-0.005625,-0.051656},{0.195824,0.217760,-0.012294,0.006164,0.217762,0.195829,0.006165,-0.012293,0.014680},{0.190534,0.207073,-0.013116,0.022345,0.207076,0.190539,0.022346,-0.013115,0.084470},{0.159702,0.189979,-0.020423,0.063060,0.189983,0.159711,0.063063,-0.020421,0.153817},{0.154776,0.180213,-0.020997,0.083606,0.180216,0.154785,0.083609,-0.020995,0.219758},{0.023458,0.145333,-0.077050,0.157971,0.145330,0.023414,0.157986,-0.077012,0.321426},{0.029938,0.111061,0.021606,0.091402,0.111061,0.029938,0.091402,0.021605,0.409497},{0.029812,0.110702,0.021811,0.091816,0.110702,0.029813,0.091816,0.021811,0.413722},{0.020901,0.090174,0.008228,0.094635,0.090174,0.020901,0.094635,0.008228,0.405362},{0.020711,0.089717,0.008360,0.095049,0.089717,0.020711,0.095049,0.008360,0.409242},{0.037606,0.085596,0.012800,0.092783,0.085596,0.037606,0.092783,0.012800,0.415672},{0.037488,0.085140,0.012955,0.093188,0.085140,0.037488,0.093188,0.012955,0.419634},{0.041847,0.081566,0.010656,0.092642,0.081566,0.041847,0.092643,0.010655,0.417756},{0.041748,0.081103,0.010795,0.093040,0.081103,0.041748,0.093040,0.010795,0.421596},{0.039977,0.075290,0.012745,0.095495,0.075290,0.039976,0.095496,0.012745,0.409377},{0.039864,0.074801,0.012902,0.095907,0.074801,0.039864,0.095907,0.012902,0.412790},{0.037136,0.067358,0.013758,0.096144,0.067358,0.037136,0.096144,0.013758,0.411772},{0.037006,0.066838,0.013923,0.096558,0.066838,0.037006,0.096558,0.013923,0.415065},{0.036519,0.061217,0.010163,0.092412,0.061217,0.036519,0.092412,0.010163,0.416367},{0.036382,0.060676,0.010306,0.092801,0.060676,0.036382,0.092801,0.010306,0.419613},{0.037688,0.057922,0.002553,0.086132,0.057922,0.037688,0.086132,0.002552,0.420564},{0.037555,0.057374,0.002647,0.086478,0.057374,0.037555,0.086478,0.002646,0.423759},{0.040024,0.056760,-0.005763,0.079281,0.056760,0.040024,0.079281,-0.005764,0.425222},{0.039900,0.056215,-0.005724,0.079581,0.056215,0.039900,0.079581,-0.005725,0.428384},{0.044173,0.057719,-0.010601,0.073332,0.057719,0.044173,0.073333,-0.010602,0.429566},{0.044067,0.057176,-0.010602,0.073610,0.057176,0.044067,0.073611,-0.010604,0.432756},{0.046451,0.097483,0.010426,0.026465,0.097483,0.046451,0.026464,0.010427,0.400790},{0.023361,-0.071267,-0.207846,0.108901,-0.071267,0.023361,0.108969,-0.207920,0.468603},{0.010502,-0.122782,-0.208559,0.103874,-0.122783,0.010502,0.103943,-0.208633,0.713925},{0.013263,-0.072097,-0.175542,0.084049,-0.072098,0.013264,0.084083,-0.175585,0.774095},{0.006594,-0.102257,-0.168726,0.087452,-0.102257,0.006594,0.087486,-0.168769,0.870599},{-0.002013,-0.112985,-0.134251,0.118663,-0.112985,-0.002013,0.118657,-0.134248,0.908535},{-0.008336,-0.139553,-0.114578,0.138380,-0.139553,-0.008335,0.138374,-0.114575,0.959711},{-0.011722,-0.140970,-0.041830,0.169647,-0.140970,-0.011722,0.169651,-0.041833,0.963425},{-0.016805,-0.163660,-0.009212,0.207369,-0.163660,-0.016805,0.207372,-0.009215,0.980998},{-0.016255,-0.146160,0.070469,0.257640,-0.146160,-0.016255,0.257644,0.070468,0.940653},{-0.018973,-0.162587,0.111555,0.306154,-0.162587,-0.018973,0.306158,0.111554,0.914517},{-0.016688,-0.154769,0.186233,0.305319,-0.154768,-0.016687,0.305322,0.186232,0.814690},{-0.017671,-0.168559,0.221713,0.341952,-0.168559,-0.017671,0.341955,0.221712,0.725679},{-0.018220,-0.160086,0.237232,0.269752,-0.160085,-0.018219,0.269750,0.237228,0.618824},{-0.018460,-0.170518,0.251891,0.276890,-0.170517,-0.018460,0.276888,0.251887,0.517993},{-0.019371,-0.151078,0.232801,0.223179,-0.151077,-0.019371,0.223180,0.232799,0.400366},{-0.018998,-0.155303,0.234908,0.215332,-0.155303,-0.018997,0.215332,0.234905,0.289039},{-0.014977,-0.135763,0.221328,0.189283,-0.135762,-0.014975,0.189283,0.221327,0.193456},{-0.013091,-0.134128,0.219418,0.178367,-0.134127,-0.013090,0.178367,0.219417,0.097159},{-0.009066,-0.109891,0.204554,0.161545,-0.109889,-0.009064,0.161546,0.204559,0.014890},{-0.005558,-0.100013,0.201699,0.151315,-0.100012,-0.005556,0.151317,0.201704,-0.063803},{-0.002850,-0.189996,0.059007,0.105244,-0.189964,-0.002833,0.105242,0.058969,-0.208185}};

// No offset, looks good
// float times[TIMESTEPS] = {0.000000,0.003871,0.007742,0.011613,0.015484,0.019355,0.023226,0.027097,0.030968,0.034839,0.038710,0.042581,0.046452,0.050323,0.054194,0.058065,0.061936,0.065807,0.069678,0.073549,0.077420,0.077420,0.081140,0.084861,0.088582,0.092302,0.096023,0.099744,0.103464,0.107185,0.110906,0.114626,0.118347,0.122068,0.125788,0.129509,0.133230,0.136950,0.140671,0.144392,0.148113,0.151833};
// float pos[TIMESTEPS][MOTORS] = {{0.555314,1.339475,0.980313,0.744399,1.339475,0.555315,0.744401,0.980311,-0.125984},{0.579510,1.412371,0.893994,0.711326,1.412370,0.579510,0.711326,0.893993,-0.122871},{0.597061,1.456649,0.804468,0.673192,1.456649,0.597061,0.673192,0.804468,-0.117254},{0.610108,1.479326,0.712615,0.630605,1.479326,0.610108,0.630604,0.712615,-0.110354},{0.620006,1.484262,0.619812,0.584763,1.484262,0.620006,0.584762,0.619812,-0.102749},{0.627492,1.473355,0.527740,0.537299,1.473355,0.627492,0.537299,0.527740,-0.094529},{0.633342,1.448278,0.439030,0.491206,1.448278,0.633342,0.491206,0.439030,-0.085779},{0.638293,1.410614,0.356702,0.450233,1.410614,0.638293,0.450233,0.356702,-0.076567},{0.643227,1.362128,0.284693,0.419625,1.362128,0.643227,0.419625,0.284693,-0.066973},{0.649101,1.304642,0.227140,0.405172,1.304642,0.649101,0.405173,0.227139,-0.057045},{0.656945,1.240506,0.187930,0.412301,1.240506,0.656945,0.412301,0.187929,-0.046963},{0.668053,1.172499,0.171176,0.446435,1.172499,0.668053,0.446435,0.171175,-0.036977},{0.682859,1.102928,0.176998,0.506905,1.102928,0.682859,0.506905,0.176997,-0.027502},{0.701224,1.033827,0.203114,0.589339,1.033827,0.701224,0.589340,0.203112,-0.019146},{0.722563,0.966782,0.244379,0.685745,0.966782,0.722563,0.685745,0.244378,-0.012207},{0.745918,0.903145,0.294238,0.786924,0.903145,0.745918,0.786925,0.294238,-0.006745},{0.770414,0.844379,0.348166,0.887171,0.844379,0.770413,0.887171,0.348166,-0.002736},{0.795319,0.791913,0.403191,0.982998,0.791914,0.795320,0.982998,0.403191,-0.000091},{0.819743,0.747335,0.457643,1.073030,0.747335,0.819741,1.073031,0.457643,0.001222},{0.842888,0.712550,0.510705,1.156832,0.712553,0.842889,1.156832,0.510705,0.001295},{0.863198,0.688466,0.561293,1.234118,0.688470,0.863193,1.234118,0.561293,-0.000187},{0.863180,0.688455,0.561292,1.234081,0.688456,0.863181,1.234081,0.561293,-0.000196},{0.795115,0.636485,0.602128,1.289269,0.636484,0.795115,1.289269,0.602128,-0.003709},{0.723330,0.581034,0.636883,1.318698,0.581034,0.723330,1.318698,0.636883,-0.009579},{0.648913,0.523822,0.667263,1.329706,0.523821,0.648913,1.329706,0.667263,-0.016829},{0.573536,0.467265,0.694309,1.326353,0.467265,0.573536,1.326353,0.694309,-0.024945},{0.499106,0.414123,0.718556,1.310598,0.414123,0.499106,1.310598,0.718557,-0.033771},{0.428598,0.368454,0.740630,1.284137,0.368454,0.428598,1.284137,0.740630,-0.043155},{0.365411,0.334897,0.761172,1.248515,0.334897,0.365411,1.248515,0.761172,-0.052964},{0.313371,0.318492,0.781067,1.205324,0.318492,0.313371,1.205325,0.781067,-0.063052},{0.276190,0.324164,0.801432,1.156060,0.324164,0.276189,1.156060,0.801432,-0.073299},{0.256620,0.355460,0.822761,1.103064,0.355461,0.256619,1.103064,0.822761,-0.083423},{0.257498,0.416117,0.845025,1.049682,0.416117,0.257497,1.049682,0.845025,-0.092998},{0.276306,0.502254,0.867576,0.997990,0.502254,0.276306,0.997990,0.867576,-0.101639},{0.307175,0.605207,0.889445,0.949059,0.605207,0.307175,0.949059,0.889445,-0.108937},{0.344645,0.716870,0.909926,0.903733,0.716871,0.344644,0.903733,0.909926,-0.114792},{0.384025,0.830180,0.928577,0.862674,0.830180,0.384025,0.862674,0.928577,-0.119333},{0.422799,0.941347,0.945046,0.826506,0.941347,0.422799,0.826506,0.945046,-0.122695},{0.459679,1.048341,0.959028,0.795815,1.048341,0.459679,0.795816,0.959028,-0.125031},{0.494136,1.150445,0.970017,0.771332,1.150445,0.494136,0.771333,0.970016,-0.126385},{0.526115,1.247565,0.977757,0.754075,1.247565,0.526115,0.754079,0.977759,-0.126806},{0.555293,1.339505,0.980338,0.744408,1.339505,0.555293,0.744412,0.980330,-0.125980}};
// float vel[TIMESTEPS][MOTORS] = {{7.277938,23.113286,-21.820901,-7.855216,23.113286,7.277938,-7.855215,-21.820903,0.390320},{5.308988,14.847113,-22.752248,-9.223290,14.847113,5.308988,-9.223291,-22.752247,1.174386},{3.840498,8.324373,-23.477951,-10.466875,8.324373,3.840498,-10.466875,-23.477951,1.684636},{2.931463,3.482561,-23.923204,-11.487611,3.482561,2.931463,-11.487611,-23.923204,1.878797},{2.211702,-0.844338,-23.970885,-12.142796,-0.844338,2.211702,-12.142796,-23.970884,2.049456},{1.688154,-4.717466,-23.483989,-12.240046,-4.717466,1.688154,-12.240047,-23.483989,2.196856},{1.365417,-8.167463,-22.237561,-11.428160,-8.167463,1.365417,-11.428160,-22.237559,2.323566},{1.233380,-11.208840,-20.127420,-9.500553,-11.208840,1.233380,-9.500553,-20.127420,2.434237},{1.356119,-13.760332,-16.907150,-6.064290,-13.760332,1.356119,-6.064290,-16.907149,2.521935},{1.724738,-15.824894,-12.674276,-1.178313,-15.824894,1.724738,-1.178313,-12.674275,2.598358},{2.373942,-17.196860,-7.429321,5.093652,-17.196860,2.373942,5.093652,-7.429321,2.602696},{3.356569,-17.854727,-1.325796,12.385504,-17.854727,3.356569,12.385504,-1.325796,2.537721},{4.285479,-18.004641,4.237810,18.707909,-18.004641,4.285478,18.707910,4.237809,2.338425},{5.166845,-17.640164,8.974406,23.500448,-17.640164,5.166845,23.500448,8.974406,1.978964},{5.822617,-16.942213,12.072127,25.929183,-16.942213,5.822617,25.929183,12.072126,1.605484},{6.213890,-15.871262,13.542694,26.191897,-15.871262,6.213890,26.191898,13.542693,1.221460},{6.411522,-14.425250,14.185356,25.445731,-14.425251,6.411522,25.445732,14.185355,0.855099},{6.415120,-12.605640,14.190068,24.044541,-12.605639,6.415120,24.044542,14.190068,0.512649},{6.161437,-10.349558,13.897661,22.449771,-10.349560,6.161436,22.449771,13.897661,0.167669},{5.705311,-7.609447,13.452612,20.834806,-7.609447,5.705311,20.834807,13.452614,-0.154547},{4.694251,-4.820395,12.623584,19.082834,-4.820394,4.694252,19.082833,12.623584,-0.635894},{-17.711746,-13.375056,11.932094,18.923326,-13.375055,-17.711747,18.923326,11.932094,-0.548454},{-18.837848,-14.504854,10.090292,11.059647,-14.504854,-18.837847,11.059647,10.090292,-1.299053},{-19.714108,-15.242349,8.658677,5.072692,-15.242349,-19.714108,5.072692,8.658677,-1.817089},{-20.213292,-15.406482,7.694541,0.937961,-15.406482,-20.213292,0.937961,7.694541,-2.071994},{-20.235036,-14.884404,6.865137,-2.649671,-14.884404,-20.235035,-2.649671,6.865137,-2.283432},{-19.632799,-13.485804,6.196326,-5.746117,-13.485805,-19.632799,-5.746117,6.196326,-2.453562},{-18.131711,-10.860402,5.695590,-8.405419,-10.860402,-18.131710,-8.405419,5.695590,-2.584176},{-15.668129,-6.949895,5.390169,-10.667283,-6.949895,-15.668128,-10.667283,5.390169,-2.680568},{-12.142503,-1.633239,5.347220,-12.474799,-1.633239,-12.142502,-12.474799,5.347220,-2.734254},{-7.746421,4.822485,5.601781,-13.874696,4.822485,-7.746421,-13.874696,5.601781,-2.754776},{-2.665538,12.161140,5.865158,-14.481307,12.161140,-2.665538,-14.481307,5.865158,-2.668547},{2.885054,20.091909,6.063586,-14.166352,20.091909,2.885054,-14.166352,6.063586,-2.462997},{6.973139,25.863508,6.019994,-13.572553,25.863508,6.973138,-13.572554,6.019994,-2.166765},{9.394707,29.169368,5.715025,-12.696556,29.169368,9.394707,-12.696556,5.715025,-1.762135},{10.527631,30.546467,5.274321,-11.634512,30.546467,10.527630,-11.634512,5.274321,-1.389754},{10.564621,30.273966,4.736718,-10.404517,30.273966,10.564621,-10.404516,4.736718,-1.055727},{10.210324,29.393187,4.101667,-9.004830,29.393187,10.210324,-9.004831,4.101667,-0.755512},{9.594025,28.118437,3.385910,-7.450450,28.118437,9.594025,-7.450449,3.385909,-0.496904},{8.914950,26.763387,2.492537,-5.666680,26.763386,8.914949,-5.666681,2.492536,-0.227602},{8.242691,25.432150,1.527689,-3.609932,25.432150,8.242692,-3.609932,1.527689,0.028801},{7.411417,23.977839,-0.283780,-1.586860,23.977838,7.411416,-1.586859,-0.283780,0.443820}};
// float u[TIMESTEPS][MOTORS] = {{-0.085935,-1.246651,-0.123022,0.657174,-1.246652,-0.085935,0.657422,-0.123253,0.987261},{-0.085935,-1.246651,-0.123022,0.657174,-1.246652,-0.085935,0.657422,-0.123253,0.987261},{-0.009211,-0.768924,-0.006451,0.669076,-0.768925,-0.009211,0.669318,-0.006705,0.301406},{-0.009211,-0.768924,-0.006451,0.669076,-0.768925,-0.009211,0.669318,-0.006705,0.301406},{0.006554,-0.602747,0.132008,0.755542,-0.602746,0.006555,0.755586,0.131919,0.260417},{0.006554,-0.602747,0.132008,0.755542,-0.602746,0.006555,0.755586,0.131919,0.260417},{0.023057,-0.440718,0.239042,0.861361,-0.440718,0.023058,0.861495,0.238854,0.220811},{0.023057,-0.440718,0.239042,0.861361,-0.440718,0.023058,0.861495,0.238854,0.220811},{0.055122,-0.264825,0.392427,0.998764,-0.264823,0.055122,0.998538,0.392694,0.160029},{0.055122,-0.264825,0.392427,0.998764,-0.264823,0.055122,0.998538,0.392694,0.160029},{0.088592,-0.033290,0.664413,1.099066,-0.033289,0.088590,1.098989,0.664523,-0.031265},{0.088592,-0.033290,0.664413,1.099066,-0.033289,0.088590,1.098989,0.664523,-0.031265},{0.038504,0.151706,0.827505,0.789517,0.151708,0.038504,0.789502,0.827528,-0.365607},{0.038504,0.151706,0.827505,0.789517,0.151708,0.038504,0.789502,0.827528,-0.365607},{-0.039390,0.258172,0.763928,0.300926,0.258174,-0.039389,0.300916,0.763902,-0.403899},{-0.039390,0.258172,0.763928,0.300926,0.258174,-0.039389,0.300916,0.763902,-0.403899},{-0.097559,0.355476,0.675965,0.091857,0.355476,-0.097559,0.091871,0.675942,-0.380088},{-0.097559,0.355476,0.675965,0.091857,0.355476,-0.097559,0.091871,0.675942,-0.380088},{-0.174574,0.475907,0.548124,0.004834,0.475903,-0.174574,0.004855,0.548125,-0.410218},{-0.174574,0.475907,0.548124,0.004834,0.475903,-0.174574,0.004855,0.548125,-0.410218},{-0.308732,0.499542,-0.176660,-0.229995,0.499544,-0.308759,-0.229997,-0.176662,-0.857491},{-0.029405,0.707261,-0.042548,-1.258682,0.707387,-0.029565,-1.258683,-0.042548,-0.999936},{-0.029405,0.707261,-0.042548,-1.258682,0.707387,-0.029565,-1.258683,-0.042548,-0.999936},{0.133551,0.709754,0.036617,-0.747872,0.709915,0.133304,-0.747873,0.036617,-0.401110},{0.133551,0.709754,0.036617,-0.747872,0.709915,0.133304,-0.747873,0.036617,-0.401110},{0.225980,0.787140,0.063555,-0.593743,0.787346,0.225629,-0.593742,0.063556,-0.301252},{0.225980,0.787140,0.063555,-0.593743,0.787346,0.225629,-0.593742,0.063556,-0.301252},{0.380581,0.864427,0.085103,-0.442459,0.864534,0.380390,-0.442457,0.085103,-0.199574},{0.380581,0.864427,0.085103,-0.442459,0.864534,0.380390,-0.442457,0.085103,-0.199574},{0.549250,0.987742,0.119593,-0.275270,0.987735,0.549240,-0.275268,0.119592,-0.075342},{0.549250,0.987742,0.119593,-0.275270,0.987735,0.549240,-0.275268,0.119592,-0.075342},{0.840155,1.056050,0.070615,0.016508,1.056043,0.840149,0.016510,0.070615,0.203426},{0.840155,1.056050,0.070615,0.016508,1.056043,0.840149,0.016510,0.070615,0.203426},{0.872892,0.514528,-0.016203,0.125880,0.514530,0.872865,0.125881,-0.016203,0.442073},{0.872892,0.514528,-0.016203,0.125880,0.514530,0.872865,0.125881,-0.016203,0.442073},{0.774708,0.126988,-0.081460,0.198560,0.126995,0.774691,0.198561,-0.081459,0.372367},{0.774708,0.126988,-0.081460,0.198560,0.126995,0.774691,0.198561,-0.081459,0.372367},{0.703379,0.001778,-0.132519,0.267360,0.001786,0.703390,0.267359,-0.132518,0.302113},{0.703379,0.001778,-0.132519,0.267360,0.001786,0.703390,0.267359,-0.132518,0.302113},{0.600501,-0.044473,-0.202141,0.363055,-0.044469,0.600541,0.363050,-0.202138,0.345818},{0.600501,-0.044473,-0.202141,0.363055,-0.044469,0.600541,0.363050,-0.202138,0.345818},{-0.152400,-0.212554,-0.459299,0.430462,-0.212556,-0.152401,0.430473,-0.459335,0.788377}};
// float dfVec[TIMESTEPS][MOTORS] = {{0.039444,-0.064821,-0.192576,0.067611,-0.064822,0.039444,0.067659,-0.192621,0.329584},{0.024235,-0.128675,-0.199770,0.057043,-0.128675,0.024235,0.057091,-0.199815,0.604496},{0.027869,-0.085802,-0.182619,0.049760,-0.085802,0.027869,0.049807,-0.182669,0.649513},{0.020847,-0.123203,-0.186059,0.041875,-0.123204,0.020847,0.041922,-0.186108,0.717590},{0.018364,-0.124187,-0.159398,0.053693,-0.124187,0.018364,0.053702,-0.159415,0.769426},{0.014320,-0.154106,-0.155637,0.052942,-0.154106,0.014320,0.052951,-0.155654,0.821108},{0.015048,-0.149126,-0.125114,0.079871,-0.149126,0.015049,0.079897,-0.125151,0.857804},{0.014028,-0.172620,-0.108814,0.094762,-0.172619,0.014029,0.094788,-0.108850,0.896608},{0.021236,-0.157992,-0.053995,0.148129,-0.157992,0.021236,0.148084,-0.053943,0.915491},{0.024084,-0.173940,-0.021297,0.185871,-0.173940,0.024084,0.185827,-0.021245,0.942287},{0.035632,-0.139339,0.072314,0.253901,-0.139339,0.035632,0.253886,0.072335,0.906464},{0.043223,-0.144421,0.119462,0.310228,-0.144421,0.043223,0.310213,0.119483,0.883682},{0.040621,-0.109465,0.194277,0.298638,-0.109465,0.040621,0.298635,0.194281,0.748536},{0.047429,-0.106650,0.230866,0.335659,-0.106649,0.047429,0.335656,0.230870,0.622500},{0.037288,-0.080474,0.242383,0.259040,-0.080474,0.037289,0.259038,0.242378,0.484074},{0.040311,-0.072202,0.253743,0.261070,-0.072201,0.040311,0.261068,0.253738,0.349426},{0.030482,-0.042037,0.241536,0.214492,-0.042036,0.030482,0.214495,0.241531,0.225619},{0.030510,-0.027981,0.241572,0.203669,-0.027981,0.030510,0.203671,0.241568,0.105548},{0.013516,0.012957,0.214357,0.174361,0.012956,0.013516,0.174366,0.214357,-0.021292},{0.009992,0.034123,0.210919,0.161886,0.034123,0.009992,0.161890,0.210919,-0.134268},{-0.024007,0.060282,0.063027,0.102511,0.060282,-0.024013,0.102510,0.063026,-0.390354},{-0.142558,0.034749,0.083866,-0.099536,0.034774,-0.142589,-0.099536,0.083866,-0.387503},{-0.151257,0.026022,0.069638,-0.160281,0.026047,-0.151288,-0.160281,0.069638,-0.650681},{-0.126214,0.020812,0.074034,-0.106811,0.020843,-0.126263,-0.106811,0.074034,-0.715418},{-0.130070,0.019544,0.066586,-0.138750,0.019576,-0.130119,-0.138750,0.066586,-0.804793},{-0.112195,0.038684,0.065438,-0.136375,0.038724,-0.112264,-0.136375,0.065438,-0.859435},{-0.107543,0.049488,0.060272,-0.160294,0.049528,-0.107611,-0.160294,0.060272,-0.919086},{-0.065767,0.084855,0.060610,-0.151304,0.084876,-0.065804,-0.151303,0.060610,-0.945034},{-0.046737,0.115063,0.058251,-0.168776,0.115084,-0.046774,-0.168776,0.058251,-0.978831},{0.013424,0.180205,0.064652,-0.150101,0.180204,0.013422,-0.150100,0.064652,-0.973403},{0.047383,0.230074,0.066618,-0.160915,0.230073,0.047381,-0.160914,0.066618,-0.980598},{0.143420,0.300098,0.059092,-0.108641,0.300096,0.143419,-0.108641,0.059092,-0.895945},{0.186297,0.361360,0.060625,-0.106208,0.361359,0.186296,-0.106208,0.060624,-0.823874},{0.224267,0.300231,0.043339,-0.080270,0.300232,0.224261,-0.080270,0.043340,-0.673421},{0.242973,0.325768,0.040984,-0.073504,0.325768,0.242967,-0.073503,0.040984,-0.531547},{0.232557,0.260752,0.024840,-0.051111,0.260754,0.232554,-0.051111,0.024841,-0.414590},{0.232843,0.258647,0.020687,-0.041610,0.258649,0.232839,-0.041610,0.020688,-0.297472},{0.216182,0.227400,0.005814,-0.017367,0.227402,0.216184,-0.017367,0.005815,-0.205924},{0.211421,0.217553,0.000285,-0.005360,0.217555,0.211423,-0.005360,0.000286,-0.115250},{0.186092,0.198057,-0.020207,0.027100,0.198058,0.186100,0.027099,-0.020206,-0.012294},{0.180899,0.187774,-0.027660,0.042988,0.187775,0.180907,0.042987,-0.027659,0.077607},{0.027500,0.143728,-0.091854,0.071774,0.143728,0.027500,0.071777,-0.091861,0.309517}};

// Good with 200g tail
float times[TIMESTEPS] = {0.000000,0.003964,0.007928,0.011892,0.015856,0.019821,0.023785,0.027749,0.031713,0.035677,0.039641,0.043605,0.047569,0.051533,0.055497,0.059462,0.063426,0.067390,0.071354,0.075318,0.079282,0.079282,0.083432,0.087581,0.091730,0.095880,0.100029,0.104179,0.108328,0.112477,0.116627,0.120776,0.124926,0.129075,0.133225,0.137374,0.141523,0.145673,0.149822,0.153972,0.158121,0.162271};
float pos[TIMESTEPS][MOTORS] = {{0.554262,1.467971,0.548810,0.493620,1.468014,0.554263,0.493636,0.548798,-0.647798},{0.567101,1.520732,0.474748,0.463334,1.520775,0.567073,0.463350,0.474735,-0.644994},{0.566236,1.546225,0.403688,0.434050,1.546269,0.566237,0.434065,0.403676,-0.639996},{0.556057,1.550712,0.338017,0.409612,1.550754,0.556022,0.409627,0.338005,-0.634161},{0.539969,1.538294,0.280874,0.393298,1.538338,0.539970,0.393313,0.280862,-0.627708},{0.519922,1.510383,0.234734,0.389412,1.510425,0.519890,0.389426,0.234721,-0.621472},{0.498579,1.469425,0.200902,0.399098,1.469471,0.498579,0.399110,0.200890,-0.615135},{0.478610,1.417687,0.178151,0.421850,1.417732,0.478636,0.421862,0.178139,-0.608815},{0.462368,1.357202,0.166472,0.457305,1.357249,0.462368,0.457317,0.166461,-0.602121},{0.452573,1.290295,0.167212,0.506925,1.290346,0.452594,0.506937,0.167201,-0.595604},{0.449976,1.218445,0.179503,0.568922,1.218494,0.449972,0.568935,0.179492,-0.589126},{0.454944,1.143638,0.202287,0.641019,1.143691,0.454950,0.641031,0.202276,-0.583131},{0.466948,1.067317,0.232846,0.719241,1.067367,0.466920,0.719254,0.232835,-0.578005},{0.485818,0.991785,0.268949,0.800190,0.991836,0.485844,0.800163,0.268938,-0.573569},{0.510599,0.918660,0.308065,0.880816,0.918711,0.510568,0.880829,0.308054,-0.570270},{0.540153,0.850415,0.348760,0.959073,0.850463,0.540119,0.959084,0.348750,-0.567759},{0.573526,0.788281,0.389516,1.034100,0.788333,0.573492,1.034113,0.389506,-0.566360},{0.609205,0.733834,0.429898,1.104870,0.733886,0.609205,1.104883,0.429888,-0.565591},{0.646250,0.687872,0.469090,1.171650,0.687924,0.646215,1.171663,0.469080,-0.565748},{0.682977,0.651727,0.507289,1.234159,0.651781,0.682949,1.234172,0.507280,-0.566344},{0.718758,0.626761,0.543856,1.292909,0.626814,0.718718,1.292923,0.543848,-0.567949},{0.718708,0.626661,0.543946,1.292809,0.626714,0.718709,1.292823,0.543947,-0.567849},{0.646860,0.571741,0.569236,1.334468,0.571794,0.646861,1.334481,0.569230,-0.570945},{0.571381,0.512989,0.581393,1.347399,0.513042,0.571382,1.347412,0.581390,-0.576256},{0.494873,0.455431,0.583581,1.338882,0.455485,0.494875,1.338894,0.583571,-0.582511},{0.421490,0.404031,0.577507,1.313450,0.404085,0.421493,1.313464,0.577500,-0.589496},{0.354778,0.364460,0.565002,1.272602,0.364508,0.354780,1.272614,0.564994,-0.596787},{0.299290,0.341764,0.547598,1.218702,0.341806,0.299292,1.218716,0.547595,-0.604583},{0.258670,0.341331,0.527790,1.153626,0.341372,0.258628,1.153639,0.527788,-0.612222},{0.235095,0.364905,0.507273,1.080181,0.364946,0.235097,1.080195,0.507272,-0.619859},{0.228781,0.413272,0.488644,1.001016,0.413313,0.228783,1.001034,0.488644,-0.626918},{0.238372,0.483668,0.472647,0.918720,0.483710,0.238374,0.918734,0.472643,-0.633567},{0.261040,0.572813,0.460106,0.836210,0.572851,0.261042,0.836225,0.460104,-0.639237},{0.292616,0.674533,0.451186,0.755991,0.674576,0.292617,0.756006,0.451179,-0.644120},{0.329064,0.782476,0.446486,0.681622,0.782512,0.329065,0.681636,0.446470,-0.647685},{0.366879,0.892050,0.446499,0.615078,0.892093,0.366880,0.615093,0.446490,-0.650272},{0.404152,0.999313,0.451071,0.558350,0.999356,0.404153,0.558365,0.451053,-0.651746},{0.439351,1.102916,0.460685,0.512870,1.102959,0.439351,0.512885,0.460674,-0.652530},{0.472277,1.201576,0.475295,0.480709,1.201619,0.472277,0.480725,0.475291,-0.652400},{0.502304,1.295440,0.495053,0.464282,1.295483,0.502304,0.464297,0.495041,-0.651669},{0.529577,1.384133,0.519679,0.467523,1.384177,0.529578,0.467539,0.519666,-0.650204},{0.554162,1.468071,0.548910,0.493720,1.468114,0.554163,0.493736,0.548893,-0.647898}};
float vel[TIMESTEPS][MOTORS] = {{5.390141,17.348191,-18.800111,-7.559054,17.348265,5.390093,-7.559037,-18.800059,0.392399},{1.334890,9.614362,-18.429276,-7.661519,9.614407,1.334894,-7.661551,-18.429275,1.009068},{-1.592353,3.491781,-17.385016,-6.952988,3.491829,-1.592321,-6.953048,-17.385033,1.400115},{-3.394368,-1.071136,-15.613319,-5.302325,-1.071099,-3.394375,-5.302387,-15.613315,1.552483},{-4.633168,-5.134198,-13.182345,-2.753530,-5.134189,-4.633187,-2.753590,-13.182316,1.614050},{-5.317448,-8.774583,-10.085745,0.718085,-8.774565,-5.317458,0.718027,-10.085715,1.564225},{-5.345655,-11.811452,-7.072508,4.194813,-11.811446,-5.345685,4.194776,-7.072477,1.568303},{-4.639719,-14.221904,-4.401935,7.306783,-14.221882,-4.639736,7.306788,-4.401874,1.636214},{-3.424031,-16.154864,-1.451177,10.704255,-16.154864,-3.424083,10.704280,-1.451111,1.660197},{-1.577649,-17.556267,1.690097,14.198198,-17.556231,-1.577716,14.198228,1.690147,1.637155},{0.280605,-18.554575,4.476868,17.049435,-18.554544,0.280546,17.049474,4.476904,1.550316},{2.145983,-19.129342,6.828919,19.136692,-19.129295,2.145921,19.136740,6.828949,1.397152},{3.904026,-19.224867,8.500703,20.239114,-19.224820,3.903979,20.239167,8.500724,1.201378},{5.537487,-18.821379,9.556879,20.492354,-18.821331,5.537427,20.492409,9.556904,0.963656},{6.905490,-17.916418,10.121307,20.145708,-17.916373,6.905446,20.145762,10.121336,0.722477},{7.973775,-16.484347,10.298111,19.377983,-16.484299,7.973706,19.378024,10.298155,0.476208},{8.746196,-14.739853,10.252174,18.421600,-14.739823,8.746148,18.421626,10.252223,0.255468},{9.213816,-12.702530,10.035285,17.360004,-12.702497,9.213751,17.360019,10.035349,0.062856},{9.360120,-10.363493,9.751973,16.310837,-10.363470,9.360057,16.310832,9.752039,-0.119373},{9.116602,-7.795912,9.431592,15.304065,-7.795875,9.116530,15.304042,9.431654,-0.270906},{8.970874,-4.625682,9.028899,14.316511,-4.625724,8.970813,14.316469,9.028959,-0.538241},{-16.637949,-12.515787,7.838463,14.152285,-12.515693,-16.637891,14.152317,7.838449,-0.432843},{-17.866866,-13.868446,4.391318,6.294015,-13.868365,-17.866818,6.294031,4.391322,-1.063051},{-18.483656,-14.266718,1.600129,0.211683,-14.266642,-18.483583,0.211702,1.600140,-1.464987},{-18.221166,-13.344612,-0.529390,-4.162967,-13.344570,-18.221096,-4.162953,-0.529392,-1.611999},{-17.073336,-11.202295,-2.291521,-8.032501,-11.202295,-17.073293,-8.032494,-2.291525,-1.731809},{-14.897421,-7.695273,-3.674722,-11.496012,-7.695299,-14.897437,-11.496003,-3.674724,-1.840767},{-11.759473,-2.971989,-4.564509,-14.413163,-2.971976,-11.759534,-14.413160,-4.564518,-1.884812},{-7.781922,2.769673,-4.925302,-16.784527,2.769675,-7.781922,-16.784514,-4.925303,-1.859728},{-3.597208,8.695835,-4.818570,-18.526305,8.695797,-3.597183,-18.526294,-4.818579,-1.792984},{0.480261,14.457956,-4.205719,-19.545795,14.457976,0.480276,-19.545778,-4.205744,-1.671367},{3.972563,19.409675,-3.464829,-19.953929,19.409721,3.972564,-19.953914,-3.464849,-1.504901},{6.702906,23.272505,-2.615674,-19.715905,23.272559,6.702843,-19.715886,-2.615696,-1.289698},{8.361710,25.566575,-1.660961,-18.762013,25.566656,8.361626,-18.761997,-1.660977,-1.037994},{9.035266,26.375727,-0.583789,-17.036436,26.375792,9.035195,-17.036418,-0.583811,-0.747439},{9.116667,26.265574,0.535411,-14.898879,26.265609,9.116609,-14.898863,0.535396,-0.492726},{8.748570,25.463681,1.689628,-12.384893,25.463707,8.748536,-12.384872,1.689602,-0.281528},{8.213240,24.406786,2.890426,-9.385300,24.406796,8.213218,-9.385286,2.890412,-0.085932},{7.579288,23.214618,4.136138,-5.990668,23.214627,7.579295,-5.990657,4.136114,0.092148},{6.911923,22.000401,5.340815,-1.708658,22.000378,6.911944,-1.708642,5.340797,0.268214},{6.247057,20.817205,6.467954,3.403290,20.817152,6.247087,3.403315,6.467928,0.434204},{5.520720,19.614119,7.653036,9.451476,19.614027,5.520763,9.451467,7.653016,0.649036}};
float u[TIMESTEPS][MOTORS] = {{-0.486396,-1.148464,0.111684,1.018498,-1.148438,-0.486407,1.019031,0.110966,1.145341},{-0.486396,-1.148464,0.111684,1.018498,-1.148438,-0.486407,1.019031,0.110966,1.145341},{-0.184367,-0.697172,0.219326,0.794542,-0.697157,-0.184378,0.794293,0.219612,0.434195},{-0.184367,-0.697172,0.219326,0.794542,-0.697157,-0.184378,0.794293,0.219612,0.434195},{-0.005892,-0.535403,0.284561,0.762815,-0.535400,-0.005885,0.762471,0.284968,0.126736},{-0.005892,-0.535403,0.284561,0.762815,-0.535400,-0.005885,0.762471,0.284968,0.126736},{0.158985,-0.354477,0.328393,0.621134,-0.354477,0.158986,0.621120,0.328408,0.253226},{0.158985,-0.354477,0.328393,0.621134,-0.354477,0.158986,0.621120,0.328408,0.253226},{0.261140,-0.190996,0.532911,0.609868,-0.190996,0.261153,0.609837,0.532916,0.134838},{0.261140,-0.190996,0.532911,0.609868,-0.190996,0.261153,0.609837,0.532916,0.134838},{0.213875,-0.046074,0.671060,0.428741,-0.046078,0.213891,0.428713,0.671069,-0.044964},{0.213875,-0.046074,0.671060,0.428741,-0.046078,0.213891,0.428713,0.671069,-0.044964},{0.146614,0.097497,0.670509,0.210199,0.097495,0.146623,0.210167,0.670521,-0.191957},{0.146614,0.097497,0.670509,0.210199,0.097495,0.146623,0.210167,0.670521,-0.191957},{0.052504,0.233120,0.594179,0.073513,0.233123,0.052499,0.073489,0.594237,-0.243026},{0.052504,0.233120,0.594179,0.073513,0.233123,0.052499,0.073489,0.594237,-0.243026},{-0.028785,0.312155,0.545787,0.017154,0.312154,-0.028786,0.017132,0.545852,-0.199408},{-0.028785,0.312155,0.545787,0.017154,0.312154,-0.028786,0.017132,0.545852,-0.199408},{-0.112962,0.400493,0.494716,-0.006840,0.400508,-0.112983,-0.006872,0.494711,-0.195249},{-0.112962,0.400493,0.494716,-0.006840,0.400508,-0.112983,-0.006872,0.494711,-0.195249},{-0.092284,0.576642,-0.114921,-0.126428,0.576639,-0.092312,-0.126428,-0.114921,-0.626625},{0.106293,0.688685,-0.337515,-1.142546,0.688952,0.105863,-1.142531,-0.337516,-1.030469},{0.106293,0.688685,-0.337515,-1.142546,0.688952,0.105863,-1.142531,-0.337516,-1.030469},{0.278557,0.692378,-0.159055,-0.685793,0.691880,0.279384,-0.685785,-0.159060,-0.407757},{0.278557,0.692378,-0.159055,-0.685793,0.691880,0.279384,-0.685785,-0.159060,-0.407757},{0.385881,0.777149,-0.063465,-0.531469,0.777390,0.385632,-0.531471,-0.063467,-0.339063},{0.385881,0.777149,-0.063465,-0.531469,0.777390,0.385632,-0.531471,-0.063467,-0.339063},{0.470786,0.801316,0.052074,-0.334496,0.801760,0.470347,-0.334505,0.052070,-0.106082},{0.470786,0.801316,0.052074,-0.334496,0.801760,0.470347,-0.334505,0.052070,-0.106082},{0.557390,0.701327,0.132726,-0.135693,0.701353,0.557476,-0.135698,0.132725,0.051194},{0.557390,0.701327,0.132726,-0.135693,0.701353,0.557476,-0.135698,0.132725,0.051194},{0.704582,0.469733,0.130359,0.027686,0.469715,0.704695,0.027683,0.130361,0.167894},{0.704582,0.469733,0.130359,0.027686,0.469715,0.704695,0.027683,0.130361,0.167894},{0.694086,0.160586,0.118831,0.199745,0.160554,0.694174,0.199745,0.118831,0.286333},{0.694086,0.160586,0.118831,0.199745,0.160554,0.694174,0.199745,0.118831,0.286333},{0.646960,0.009070,0.097803,0.286203,0.009045,0.647010,0.286205,0.097802,0.214027},{0.646960,0.009070,0.097803,0.286203,0.009045,0.647010,0.286205,0.097802,0.214027},{0.563235,-0.044535,0.084568,0.395826,-0.044566,0.563293,0.395825,0.084565,0.200782},{0.563235,-0.044535,0.084568,0.395826,-0.044566,0.563293,0.395825,0.084565,0.200782},{0.405022,-0.080411,0.039969,0.618223,-0.080455,0.404998,0.618233,0.039948,0.223421},{0.405022,-0.080411,0.039969,0.618223,-0.080455,0.404998,0.618233,0.039948,0.223421},{-0.126214,-0.155986,0.022115,0.882342,-0.155985,-0.126216,0.882352,0.022070,0.409759}};
float dfVec[TIMESTEPS][MOTORS] = {{-0.053314,-0.090188,-0.123423,0.140434,-0.090182,-0.053317,0.140539,-0.123563,0.361172},{-0.084640,-0.149929,-0.120558,0.139643,-0.149924,-0.084642,0.139747,-0.120698,0.577391},{-0.048292,-0.109125,-0.091478,0.101397,-0.109122,-0.048293,0.101348,-0.091423,0.575675},{-0.062212,-0.144372,-0.077793,0.114147,-0.144369,-0.062214,0.114098,-0.077737,0.629099},{-0.036940,-0.144179,-0.046279,0.127642,-0.144178,-0.036939,0.127575,-0.046199,0.590665},{-0.042226,-0.172299,-0.022359,0.154460,-0.172299,-0.042225,0.154392,-0.022279,0.573196},{-0.010257,-0.160439,0.009474,0.153658,-0.160439,-0.010257,0.153655,0.009477,0.599318},{-0.004804,-0.179059,0.030104,0.177697,-0.179059,-0.004804,0.177694,0.030107,0.623129},{0.024529,-0.162077,0.092822,0.201742,-0.162077,0.024531,0.201736,0.092824,0.608427},{0.038792,-0.172902,0.117088,0.228732,-0.172902,0.038794,0.228726,0.117089,0.600348},{0.043919,-0.152323,0.165583,0.215398,-0.152323,0.043922,0.215393,0.165585,0.534800},{0.058329,-0.156763,0.183752,0.231522,-0.156763,0.058331,0.231517,0.183754,0.481097},{0.058779,-0.129473,0.196559,0.197375,-0.129474,0.058780,0.197369,0.196561,0.383759},{0.071397,-0.126356,0.204717,0.199331,-0.126357,0.071398,0.199325,0.204720,0.300408},{0.063592,-0.092890,0.194176,0.169970,-0.092889,0.063591,0.169966,0.194188,0.205876},{0.071845,-0.081828,0.195542,0.164040,-0.081827,0.071843,0.164035,0.195554,0.119528},{0.061943,-0.052924,0.185741,0.145650,-0.052924,0.061942,0.145646,0.185754,0.050646},{0.065555,-0.037186,0.184065,0.137449,-0.037186,0.065554,0.137445,0.184078,-0.016889},{0.050252,-0.001873,0.171907,0.124661,-0.001870,0.050248,0.124655,0.171906,-0.079971},{0.048371,0.017961,0.169432,0.116884,0.017964,0.048367,0.116878,0.169432,-0.133101},{0.051282,0.076837,0.047311,0.085910,0.076836,0.051276,0.085910,0.047312,-0.311046},{-0.107773,0.037761,-0.005338,-0.113720,0.037814,-0.107857,-0.113717,-0.005338,-0.352928},{-0.117266,0.027312,-0.031966,-0.174422,0.027365,-0.117350,-0.174419,-0.031967,-0.573894},{-0.088402,0.024956,-0.018689,-0.132242,0.024860,-0.088240,-0.132240,-0.018690,-0.593260},{-0.086375,0.032079,-0.035139,-0.166034,0.031982,-0.086213,-0.166033,-0.035140,-0.644806},{-0.056557,0.065177,-0.030091,-0.165799,0.065224,-0.056605,-0.165800,-0.030091,-0.673404},{-0.039749,0.092267,-0.040775,-0.192554,0.092314,-0.039797,-0.192554,-0.040776,-0.711607},{0.001066,0.133471,-0.025094,-0.176636,0.133558,0.000980,-0.176638,-0.025095,-0.681569},{0.031791,0.177824,-0.027881,-0.194954,0.177910,0.031706,-0.194956,-0.027882,-0.672774},{0.081023,0.204082,-0.011312,-0.169599,0.204087,0.081040,-0.169600,-0.011312,-0.618669},{0.112521,0.248593,-0.006578,-0.177475,0.248598,0.112537,-0.177475,-0.006578,-0.576028},{0.168232,0.241633,-0.001317,-0.148733,0.241630,0.168254,-0.148734,-0.001317,-0.494879},{0.189323,0.271472,0.005243,-0.146895,0.271469,0.189344,-0.146895,0.005243,-0.419424},{0.200088,0.228843,0.010367,-0.105938,0.228837,0.200104,-0.105938,0.010367,-0.308049},{0.205291,0.235093,0.018688,-0.092608,0.235087,0.205307,-0.092608,0.018688,-0.206174},{0.196719,0.204664,0.023229,-0.059218,0.204660,0.196729,-0.059218,0.023228,-0.130980},{0.193876,0.198470,0.032145,-0.039798,0.198465,0.193886,-0.039798,0.032144,-0.056929},{0.173396,0.179841,0.038837,0.004772,0.179835,0.173408,0.004772,0.038836,0.009066},{0.168499,0.170632,0.048459,0.030995,0.170626,0.168511,0.030995,0.048459,0.071505},{0.132459,0.154249,0.049059,0.107487,0.154240,0.132454,0.107490,0.049054,0.137657},{0.127323,0.145109,0.057766,0.146976,0.145100,0.127318,0.146978,0.057761,0.195857},{0.018007,0.121062,0.063435,0.245256,0.121062,0.018007,0.245258,0.063426,0.307558}};

// With heavier tail
// float times[TIMESTEPS] = {0.000000,0.004643,0.009286,0.013928,0.018571,0.023214,0.027857,0.032499,0.037142,0.041785,0.046428,0.051070,0.055713,0.060356,0.064999,0.069641,0.074284,0.078927,0.083570,0.088212,0.092855,0.092855,0.097728,0.102601,0.107474,0.112347,0.117220,0.122094,0.126967,0.131840,0.136713,0.141586,0.146459,0.151332,0.156205,0.161078,0.165951,0.170824,0.175697,0.180570,0.185443,0.190317};
// float pos[TIMESTEPS][MOTORS] = {{0.643308,1.728895,0.393046,0.368195,1.728908,0.643310,0.368207,0.393034,-0.632907},{0.653011,1.781837,0.321859,0.354981,1.781850,0.653007,0.354993,0.321848,-0.630650},{0.642085,1.804250,0.266283,0.358341,1.804264,0.642087,0.358353,0.266271,-0.626468},{0.616739,1.802928,0.223665,0.376335,1.802942,0.616742,0.376347,0.223653,-0.621279},{0.581764,1.782343,0.192622,0.407379,1.782357,0.581768,0.407390,0.192611,-0.614861},{0.539970,1.744581,0.173528,0.452084,1.744595,0.539974,0.452095,0.173517,-0.607421},{0.495197,1.691865,0.167272,0.510529,1.691879,0.495201,0.510540,0.167261,-0.598776},{0.450857,1.625300,0.175329,0.584252,1.625316,0.450861,0.584264,0.175318,-0.589825},{0.411292,1.547125,0.196157,0.670042,1.547140,0.411296,0.670054,0.196147,-0.580701},{0.380518,1.459305,0.227211,0.763548,1.459323,0.380548,0.763561,0.227200,-0.572104},{0.362193,1.364627,0.265016,0.859961,1.364644,0.362195,0.859973,0.265006,-0.564604},{0.358993,1.267034,0.307107,0.955802,1.267052,0.359004,0.955817,0.307096,-0.558163},{0.372283,1.169772,0.351112,1.048465,1.169789,0.372283,1.048477,0.351102,-0.553263},{0.403394,1.076882,0.395813,1.136513,1.076900,0.403418,1.136524,0.395803,-0.549473},{0.450482,0.990934,0.439856,1.219520,0.990951,0.450481,1.219532,0.439847,-0.547071},{0.510183,0.914793,0.482860,1.296800,0.914810,0.510182,1.296811,0.482850,-0.545528},{0.579110,0.849516,0.524126,1.368915,0.849534,0.579109,1.368927,0.524117,-0.545101},{0.653298,0.796217,0.563955,1.435881,0.796235,0.653296,1.435889,0.563946,-0.545313},{0.729885,0.754891,0.601963,1.498404,0.754909,0.729883,1.498416,0.601955,-0.546465},{0.805641,0.725678,0.638611,1.556653,0.725696,0.805646,1.556664,0.638603,-0.548079},{0.878184,0.709477,0.673536,1.611371,0.709495,0.878181,1.611383,0.673529,-0.550705},{0.878278,0.709377,0.673626,1.611271,0.709396,0.878281,1.611283,0.673629,-0.550605},{0.791545,0.644995,0.691315,1.644625,0.645013,0.791548,1.644637,0.691307,-0.554585},{0.698077,0.573251,0.686620,1.642262,0.573270,0.698081,1.642274,0.686624,-0.560572},{0.600092,0.498888,0.665001,1.613369,0.498906,0.600096,1.613381,0.664985,-0.567305},{0.502487,0.428104,0.629556,1.563040,0.428121,0.502490,1.563052,0.629560,-0.574633},{0.410361,0.368967,0.582455,1.492384,0.368983,0.410364,1.492396,0.582458,-0.582250},{0.331723,0.331098,0.527228,1.403838,0.331113,0.331726,1.403850,0.527232,-0.590453},{0.274671,0.325329,0.468011,1.299763,0.325342,0.274658,1.299775,0.468017,-0.598665},{0.243506,0.356494,0.409838,1.184157,0.356506,0.243509,1.184168,0.409843,-0.607081},{0.239922,0.426449,0.357508,1.061473,0.426461,0.239925,1.061487,0.357518,-0.615095},{0.259974,0.529013,0.314034,0.936504,0.529025,0.259977,0.936516,0.314038,-0.622670},{0.296813,0.655110,0.280081,0.814615,0.655120,0.296816,0.814627,0.280089,-0.628870},{0.342695,0.793087,0.256266,0.699565,0.793100,0.342697,0.699576,0.256268,-0.633825},{0.390911,0.932369,0.242382,0.595152,0.932382,0.390913,0.595163,0.242361,-0.637224},{0.437481,1.067610,0.238343,0.503238,1.067623,0.437483,0.503250,0.238344,-0.639548},{0.480896,1.195500,0.243378,0.425246,1.195513,0.480899,0.425257,0.243346,-0.640708},{0.520366,1.315979,0.257175,0.363262,1.315992,0.520368,0.363274,0.257175,-0.641100},{0.556348,1.429185,0.279315,0.320687,1.429198,0.556350,0.320698,0.279310,-0.640272},{0.589055,1.535819,0.309293,0.302519,1.535833,0.589057,0.302531,0.309292,-0.638540},{0.617866,1.635495,0.347197,0.316168,1.635509,0.617868,0.316181,0.347190,-0.636019},{0.643208,1.728995,0.393146,0.368295,1.729008,0.643210,0.368307,0.393133,-0.633007}};
// float vel[TIMESTEPS][MOTORS] = {{4.814422,15.259989,-17.063539,-4.731309,15.260038,4.814386,-4.731318,-17.063520,0.280331},{-0.350175,7.867989,-13.621693,-1.048769,7.868013,-0.350148,-1.048803,-13.621689,0.697875},{-4.139435,2.024307,-10.424509,2.494590,2.024307,-4.139402,2.494560,-10.424504,1.024237},{-6.600757,-2.439407,-7.971310,5.231423,-2.439400,-6.600723,5.231418,-7.971282,1.235727},{-8.369957,-6.357922,-5.352196,8.201901,-6.357911,-8.369938,8.201915,-5.352156,1.468716},{-9.441415,-9.789543,-2.796728,11.077078,-9.789532,-9.441380,11.077082,-2.796680,1.739286},{-9.736844,-12.883542,0.094494,14.206572,-12.883529,-9.736815,14.206566,0.094542,1.902909},{-9.163304,-15.653124,3.205842,17.360274,-15.653112,-9.163272,17.360288,3.205876,1.953754},{-7.762351,-17.966131,5.681973,19.489452,-17.966116,-7.762336,19.489483,5.681996,1.897288},{-5.389703,-19.762955,7.517866,20.617716,-19.762936,-5.389724,20.617749,7.517879,1.733317},{-2.469532,-20.841826,8.676427,20.823596,-20.841812,-2.469546,20.823630,8.676439,1.505764},{1.054680,-21.096747,9.326094,20.379573,-21.096725,1.054669,20.379600,9.326113,1.208525},{4.706582,-20.616207,9.587220,19.527789,-20.616180,4.706560,19.527806,9.587241,0.924138},{8.528153,-19.334147,9.575592,18.447062,-19.334115,8.528106,18.447072,9.575618,0.650917},{11.645745,-17.542374,9.389526,17.278900,-17.542350,11.645702,17.278905,9.389554,0.408533},{13.966003,-15.247972,9.067959,16.086709,-15.247947,13.965952,16.086709,9.067991,0.197880},{15.541328,-12.780501,8.726797,14.972928,-12.780484,15.541280,14.972924,8.726831,0.008328},{16.330652,-10.189206,8.369544,13.939505,-10.189191,16.330596,13.939501,8.369583,-0.159030},{16.497118,-7.542519,8.026429,13.005647,-7.542515,16.497068,13.005639,8.026469,-0.317866},{16.020079,-4.970826,7.697184,12.162172,-4.970811,16.020017,12.162160,7.697216,-0.452380},{15.184128,-1.854443,7.369619,11.405670,-1.854466,15.184086,11.405655,7.369644,-0.677227},{-16.935215,-12.266672,6.261750,11.195273,-12.266601,-16.935153,11.195277,6.261751,-0.577220},{-18.570528,-14.097982,1.169620,2.872303,-14.097980,-18.570502,2.872306,1.169638,-1.063779},{-19.780692,-15.206026,-2.879353,-3.544085,-15.206069,-19.780686,-3.544073,-2.879329,-1.365246},{-20.246325,-15.139368,-5.922335,-8.186284,-15.139419,-20.246313,-8.186282,-5.922316,-1.453705},{-19.706752,-13.655011,-8.500427,-12.421370,-13.655060,-19.706742,-12.421361,-8.500409,-1.537428},{-17.807298,-10.320376,-10.631457,-16.420800,-10.320429,-17.807313,-16.420799,-10.631439,-1.640867},{-14.252835,-4.844153,-11.908581,-19.843611,-4.844191,-14.252875,-19.843605,-11.908564,-1.700074},{-9.142494,2.535650,-12.185450,-22.670862,2.535608,-9.142513,-22.670861,-12.185433,-1.723145},{-3.547235,10.396240,-11.556898,-24.654288,10.396209,-3.547237,-24.654285,-11.556902,-1.705615},{1.887931,18.002904,-9.872626,-25.556735,18.002936,1.887929,-25.556729,-9.872656,-1.626276},{6.072021,23.861303,-7.993430,-25.519933,23.861345,6.072008,-25.519925,-7.993452,-1.447359},{8.731654,27.488809,-5.937915,-24.412913,27.488843,8.731613,-24.412906,-5.937940,-1.154262},{9.865120,28.816636,-3.880301,-22.634222,28.816682,9.865090,-22.634210,-3.880322,-0.864628},{9.788644,28.292978,-1.833322,-20.185963,28.293010,9.788645,-20.185955,-1.833346,-0.590868},{9.271462,27.077168,0.118384,-17.425335,27.077162,9.271470,-17.425324,0.118365,-0.356821},{8.489979,25.483210,1.932212,-14.477400,25.483220,8.489976,-14.477390,1.932182,-0.172307},{7.733618,23.954321,3.684846,-10.777068,23.954360,7.733612,-10.777061,3.684828,0.029001},{7.045953,22.567534,5.339223,-6.469377,22.567560,7.045962,-6.469367,5.339195,0.261303},{6.308048,21.177305,6.982704,-0.679124,21.177305,6.308063,-0.679117,6.982685,0.440603},{5.541340,19.811659,8.553148,6.510005,19.811632,5.541357,6.510018,8.553120,0.550079},{4.802955,18.561965,10.365106,15.193987,18.561917,4.802976,15.193975,10.365083,0.703675}};
// float u[TIMESTEPS][MOTORS] = {{-0.685836,-1.008483,0.193560,1.189043,-1.008457,-0.685845,1.188863,0.193689,0.910027},{-0.685836,-1.008483,0.193560,1.189043,-1.008457,-0.685845,1.188863,0.193689,0.910027},{-0.290383,-0.662895,0.159264,0.679087,-0.662889,-0.290389,0.678922,0.159446,0.510301},{-0.290383,-0.662895,0.159264,0.679087,-0.662889,-0.290389,0.678922,0.159446,0.510301},{-0.079399,-0.498938,0.338612,0.620058,-0.498941,-0.079395,0.620029,0.338605,0.571999},{-0.079399,-0.498938,0.338612,0.620058,-0.498941,-0.079395,0.620029,0.338605,0.571999},{0.149905,-0.350658,0.632932,0.562568,-0.350656,0.149905,0.562530,0.632922,0.300925},{0.149905,-0.350658,0.632932,0.562568,-0.350656,0.149905,0.562530,0.632922,0.300925},{0.332782,-0.192976,0.726985,0.311019,-0.192972,0.332781,0.310986,0.726972,-0.010586},{0.332782,-0.192976,0.726985,0.311019,-0.192972,0.332781,0.310986,0.726972,-0.010586},{0.389639,-0.011115,0.647694,0.115565,-0.011117,0.389648,0.115545,0.647705,-0.238374},{0.389639,-0.011115,0.647694,0.115565,-0.011117,0.389648,0.115545,0.647705,-0.238374},{0.350283,0.133922,0.567864,0.022220,0.133922,0.350288,0.022204,0.567884,-0.253452},{0.350283,0.133922,0.567864,0.022220,0.133922,0.350288,0.022204,0.567884,-0.253452},{0.162003,0.244792,0.491973,-0.019555,0.244792,0.162006,-0.019572,0.491990,-0.207817},{0.162003,0.244792,0.491973,-0.019555,0.244792,0.162006,-0.019572,0.491990,-0.207817},{0.003751,0.296318,0.473598,-0.028886,0.296320,0.003748,-0.028897,0.473634,-0.170035},{0.003751,0.296318,0.473598,-0.028886,0.296320,0.003748,-0.028897,0.473634,-0.170035},{-0.123001,0.339478,0.446909,-0.034826,0.339482,-0.123010,-0.034846,0.446866,-0.161111},{-0.123001,0.339478,0.446909,-0.034826,0.339482,-0.123010,-0.034846,0.446866,-0.161111},{-0.213715,0.530764,-0.104946,-0.085944,0.530761,-0.213728,-0.085943,-0.104946,-0.473753},{0.073526,0.725184,-0.570849,-1.173197,0.725172,0.073434,-1.173193,-0.570844,-0.797519},{0.073526,0.725184,-0.570849,-1.173197,0.725172,0.073434,-1.173193,-0.570844,-0.797519},{0.256598,0.741800,-0.271900,-0.693572,0.741722,0.256773,-0.693573,-0.271899,-0.361144},{0.256598,0.741800,-0.271900,-0.693572,0.741722,0.256773,-0.693573,-0.271899,-0.361144},{0.378742,0.857539,-0.122631,-0.543655,0.857930,0.378191,-0.543656,-0.122633,-0.389993},{0.378742,0.857539,-0.122631,-0.543655,0.857930,0.378191,-0.543656,-0.122633,-0.389993},{0.515867,0.923495,0.087782,-0.319997,0.923381,0.516066,-0.319997,0.087780,-0.219884},{0.515867,0.923495,0.087782,-0.319997,0.923381,0.516066,-0.319997,0.087780,-0.219884},{0.686372,0.780689,0.230062,-0.085953,0.780702,0.686383,-0.085951,0.230062,-0.050354},{0.686372,0.780689,0.230062,-0.085953,0.780702,0.686383,-0.085951,0.230062,-0.050354},{0.857980,0.383267,0.213631,0.107037,0.383258,0.857981,0.107037,0.213634,0.194413},{0.857980,0.383267,0.213631,0.107037,0.383258,0.857981,0.107037,0.213634,0.194413},{0.789064,0.048876,0.165101,0.219765,0.048872,0.789107,0.219765,0.165101,0.217629},{0.789064,0.048876,0.165101,0.219765,0.048872,0.789107,0.219765,0.165101,0.217629},{0.702460,-0.044404,0.122646,0.268043,-0.044403,0.702430,0.268045,0.122643,0.162351},{0.702460,-0.044404,0.122646,0.268043,-0.044403,0.702430,0.268045,0.122643,0.162351},{0.620219,-0.061081,0.089866,0.411170,-0.061079,0.620261,0.411172,0.089859,0.234583},{0.620219,-0.061081,0.089866,0.411170,-0.061079,0.620261,0.411172,0.089859,0.234583},{0.396790,-0.094880,0.033585,0.709745,-0.094895,0.396764,0.709752,0.033558,0.130721},{0.396790,-0.094880,0.033585,0.709745,-0.094895,0.396764,0.709752,0.033558,0.130721},{-0.121436,-0.126246,0.035976,1.043794,-0.126247,-0.121437,1.043814,0.035918,0.291553}};
// float dfVec[TIMESTEPS][MOTORS] = {{-0.096695,-0.078992,-0.094025,0.195571,-0.078986,-0.096697,0.195536,-0.094000,0.275941},{-0.136590,-0.136093,-0.067438,0.224017,-0.136088,-0.136592,0.223982,-0.067413,0.422342},{-0.088663,-0.113770,-0.049435,0.151838,-0.113768,-0.088664,0.151805,-0.049400,0.458740},{-0.107676,-0.148251,-0.030485,0.172979,-0.148249,-0.107677,0.172947,-0.030450,0.532894},{-0.080155,-0.146513,0.024758,0.184402,-0.146514,-0.080154,0.184396,0.024757,0.626630},{-0.088432,-0.173021,0.044498,0.206612,-0.173022,-0.088431,0.206606,0.044497,0.721498},{-0.045951,-0.167975,0.124288,0.219563,-0.167975,-0.045950,0.219556,0.124286,0.725951},{-0.041520,-0.189369,0.148322,0.243924,-0.189369,-0.041520,0.243917,0.148320,0.743778},{0.005002,-0.176455,0.185810,0.211266,-0.176454,0.005002,0.211259,0.185807,0.663168},{0.023330,-0.190335,0.199991,0.219981,-0.190334,0.023330,0.219975,0.199989,0.605676},{0.056987,-0.163167,0.193462,0.183416,-0.163167,0.056989,0.183412,0.193464,0.481423},{0.084210,-0.165136,0.198481,0.179986,-0.165136,0.084212,0.179982,0.198483,0.377204},{0.104737,-0.133110,0.184914,0.155184,-0.133110,0.104738,0.155181,0.184918,0.274547},{0.134258,-0.123207,0.184824,0.146836,-0.123207,0.134258,0.146833,0.184828,0.178750},{0.121585,-0.087722,0.168572,0.129657,-0.087722,0.121585,0.129654,0.168575,0.102673},{0.139509,-0.069999,0.166088,0.120447,-0.069999,0.139509,0.120444,0.166091,0.028813},{0.120784,-0.040880,0.159865,0.110022,-0.040879,0.120783,0.110020,0.159872,-0.030274},{0.126882,-0.020863,0.157105,0.102039,-0.020862,0.126881,0.102037,0.157113,-0.088953},{0.103424,0.008007,0.149245,0.093666,0.008008,0.103422,0.093662,0.149237,-0.142903},{0.099739,0.027873,0.146702,0.087151,0.027874,0.099736,0.087147,0.146693,-0.190067},{0.075573,0.089288,0.036441,0.071328,0.089287,0.075570,0.071328,0.036441,-0.329935},{-0.116466,0.046810,-0.063068,-0.142545,0.046808,-0.116484,-0.142544,-0.063067,-0.358075},{-0.129098,0.032664,-0.102403,-0.206838,0.032662,-0.129116,-0.206837,-0.102402,-0.528674},{-0.102708,0.027348,-0.075321,-0.162772,0.027333,-0.102674,-0.162773,-0.075321,-0.549189},{-0.106305,0.027863,-0.098827,-0.198632,0.027848,-0.106271,-0.198632,-0.098827,-0.580204},{-0.078293,0.061923,-0.089603,-0.202081,0.061999,-0.078400,-0.202081,-0.089603,-0.615192},{-0.063620,0.087682,-0.106064,-0.232975,0.087758,-0.063728,-0.232975,-0.106065,-0.651460},{-0.009394,0.142860,-0.074854,-0.215754,0.142838,-0.009355,-0.215754,-0.074854,-0.639011},{0.030082,0.199867,-0.076992,-0.237594,0.199844,0.030121,-0.237594,-0.076993,-0.647100},{0.106589,0.232710,-0.044362,-0.207226,0.232712,0.106591,-0.207226,-0.044362,-0.607859},{0.148574,0.291469,-0.031351,-0.214197,0.291472,0.148576,-0.214197,-0.031352,-0.580041},{0.214395,0.259141,-0.020043,-0.176239,0.259139,0.214395,-0.176238,-0.020043,-0.469527},{0.234940,0.287162,-0.004165,-0.167687,0.287161,0.234940,-0.167687,-0.004164,-0.366759},{0.230242,0.232141,0.002256,-0.131941,0.232141,0.230250,-0.131941,0.002256,-0.260675},{0.229651,0.228096,0.018068,-0.113029,0.228095,0.229660,-0.113029,0.018068,-0.164688},{0.208750,0.200494,0.024857,-0.082279,0.200495,0.208744,-0.082279,0.024856,-0.093417},{0.202713,0.188182,0.038868,-0.059508,0.188182,0.202707,-0.059507,0.038867,-0.028722},{0.180816,0.173116,0.046008,-0.002983,0.173117,0.180824,-0.002983,0.046006,0.055963},{0.175504,0.162404,0.058787,0.030292,0.162404,0.175512,0.030293,0.058785,0.137413},{0.126187,0.145066,0.060496,0.133307,0.145063,0.126182,0.133308,0.060490,0.180005},{0.120264,0.134517,0.072627,0.188840,0.134514,0.120259,0.188842,0.072621,0.218390},{0.013395,0.118740,0.087090,0.321133,0.118740,0.013395,0.321137,0.087079,0.303641}};


class TrajBound : public ReorientableBehavior
{
public:	

	Interpolator interp;

	TBMode mode = TB_SIT; //Current state within state-machine
	int logging = 0;

	uint32_t tLast; //int used to store system time at various events

	float extDes;				 //The desired leg extension
	float angDes;				 // The desired leg angle
	float t;
	float test1;
	float test2;

	bool boolSlow = false;

	float posDes[MOTORS];
	float velDes[MOTORS];
	float accDes[MOTORS];
	float uDes[MOTORS];
	float df[MOTORS];
	float dfDes[MOTORS];
	float pitchDes;
	float DpitchDes;
	float posAct;
	float velAct;
	float kp = 1; // 1
	float kd = 0.02 ; // 0.02
	float kpt = 2;
	float kdt = 0.01; // 0.02
	float kppc = 2;
	float kdpc = 0.05;
	float kpy = 0.1;//0.1;
	float kdy = 0;//0.05;
	float kiy = 0.02;
	float V = 14;
	float Ra = 0.22;
	float kt = 0.0954;
	float yawErrorInt = 0;

	float yawInit;
	float yawDes;
	float turnLeft;

	float finalTime = times[TIMESTEPS-1];

	// Parser state (for serial comms with raspi)
	// Goes from 0 to 1 to 2
	int numAlignmentSeen = 0;
	uint16_t rxPtr = 0;

	// Receive buffer and alignment
	const static uint16_t RX_BUF_SIZE = 100;
	SerialCommandPacket packet;


	//sig is mapped from remote; here, 3 corresponds to pushing the left stick to the right
	// which in turn forces the state machine into FH_LEAP
	void signal(uint32_t sig)
	{
		// tLast = S->millis;
		if (logging == 0) power_int = 0;
		logging = 1;
	}

	void begin()
	{
		mode = TB_STAND;			// Start behavior in STAND mode
		tLast = S->millis;		// Record the system time @ this transition
		yawInit = S->imu.euler.z;
		yawErrorInt = 0;
		// ioctl(LOGGER_FILENO, 0);//stop
	}

	void update()
	{
		// Serial comms code
		oldvoltage = voltage;
		oldcurrent = current;

		// Character to store the latest received character
		uint8_t latestRX;

		// Loop through while there are new bytes available
		while (read(SERIAL_AUX_FILENO, &latestRX, 1) > 0)
		{
			if (numAlignmentSeen == 0 && latestRX == ALIGNMENT_WORD[0])
			{
				numAlignmentSeen = 1;
			}
			else if (numAlignmentSeen == 1 && latestRX == ALIGNMENT_WORD[1])
			{
				numAlignmentSeen = 2;
				rxPtr = 0;
			}
			else if (numAlignmentSeen == 2)
			{
				// Add the next byte to our memory space in serial_packet
				uint8_t *pSerialPacket = (uint8_t *)&packet;
				pSerialPacket[rxPtr++] = latestRX; // post-increment rxPtr

				// Check if we have read a whole packet
				if (rxPtr == sizeof(SerialCommandPacket))
				{
					// Copy voltage and current readings
					voltage = packet.voltage;
					current = packet.current;

					// Reset
					numAlignmentSeen = rxPtr = 0;
				}
			}
		}

		// if (isReorienting())
		// 	return;

		for (int j = 0; j < MOTORS; j++)
	    {
	    	posDes[j] = 0;
	    	velDes[j] = 0;
	    	uDes[j] = 0;
	    	df[j] = 0;
	    }
		
		if (mode == TB_SIT)
		{
			C->mode = RobotCommand_Mode_JOINT;
			for (int i = 0; i < P->joints_count; i++)
			{
				posDes[i] = 0.5;
				// Splay angle for the front/rear legs (outward splay due to fore-displacement of front legs
				// and aft-displacement of rear legs)
				// The pitch angle (S->imu.euler.y) is subtracted since we want to the set the *absolute* leg angle
				// and limb[i].setPosition(ANGLE, *) will set the angle of the leg *relative* to the robot body
				if(i==1 || i==3 || i==4 || i==6)
				{
					posDes[i] = posDes[i] - S->imu.euler.y;
				} else if(i==0 || i==2 || i==5 || i==7)
				{
					posDes[i] = posDes[i] + S->imu.euler.y;
				} else if (i == TAIL_MOT)
				{
					posDes[i] = pos[0][TAIL_MOT];
					// posDes[i] = 0;
				}
				joint[i].setGain(0.4, .003);
				joint[i].setPosition(posDes[i]);
			}
		}
		else if (mode == TB_STAND)
		{

			power_int = power_int + 0.001*(voltage + oldvoltage)*0.5*(current + oldcurrent)*0.5;

			C->mode = RobotCommand_Mode_JOINT;

			t = 0.00001*(100*(S->millis - tLast) % (int)(100000*finalTime));

   		    interp.getMultipleCubicSplineInterp(pos,vel,times,t,posDes);
   		    interp.getMultipleLinearInterp(vel,times,t,velDes);
   		    // interp.getMultipleZOH(u,times,t,uDes);
   		    interp.getMultipleZOH(dfVec,times,t,df);
   		    // pitchDes = interp.getSingleLinearInterp(pitch,times,t);
   		    // DpitchDes = interp.getSingleLinearInterp(Dpitch,times,t);

			for (int i = 0; i<MOTORS; i++)
			{
				yawDes = yawInit + 0;
				yawErrorInt = yawErrorInt + 0.001*(yawDes - S->imu.euler.z);
				// turnLeft = kpy*(yawDes - S->imu.euler.z) + kdy*(-S->imu.angular_velocity.z) + 0.1;
				turnLeft = -map(C->behavior.twist.angular.z, -1.0, 1.0, -0.1, 0.1) + 0.0;

				if(i==0 || i==2 || i==4 || i==6)
				{
					posDes[i] = posDes[i] - turnLeft;
				} else if(i==1 || i==3 || i==5 || i==7)
				{
					posDes[i] = posDes[i] + turnLeft;
				}

				posAct = joint[i].getPosition();
				velAct = joint[i].getVelocity();

				// df[i] = 1/(0.95*V)*(uDes[i]*Ra/kt + kt*joint[i].getVelocity());

				if (i == TAIL_MOT)
				{
					// df[i] = 1/(0.95*V)*(uDes[i]*Ra/kt + kt*45.39*joint[i].getVelocity());													// Feedforward torques
					joint[i].setOpenLoop(df[i] + kpt*(posDes[i] - posAct) + kdt*(velDes[i] - velAct));											// Feedforward duty factors
					// joint[i].setOpenLoop(df[i] + kpt*(posDes[i] - posAct) + kdt*(velDes[i] - velAct) + kppc*(S->imu.euler.y - pitchDes) + kdpc*(S->imu.angular_velocity.y - DpitchDes));	// Feedforward duty factors with pitch control

				} else {
					// dfDes[i] = 1/(0.95*V)*(uDes[i]*Ra/kt + kt*joint[i].getVelocity());
					joint[i].setOpenLoop(df[i] + kp*(posDes[i] - posAct) + kd*(velDes[i] - velAct));
				}
			}
		}
	}

	bool running()
	{
		return false;
	}
	void end()
	{
		mode = TB_SIT;
		logging = 0;
	}
};

TrajBound trajBound;

void debug()
{
	// printf("%d, ", trajBound.mode);
	// printf("Time: %4.3fs. ", trajBound.t);
	// printf("pos command: ");
	// for (int i = 0; i < P->joints_count; i++)
	// {
	// 	printf("%4.3f, ", joint[i].getOpenLoop());
	// }

	// // printf("Pos: %4.3f, ", joint[TAIL_MOT].getPosition());
	// // printf("Raw Pos: %4.3f, ",joint[TAIL_MOT].getRawPosition());
	
	// // printf("%4.3f, %4.3f, %4.3f ", trajBound.yawInit,trajBound.turnLeft, trajBound.kiy*trajBound.yawErrorInt);
	// printf("\n");

	myData_buf[0] = trajBound.logging;
	myData_buf[1] = voltage;
	myData_buf[2] = current;
	myData_buf[3] = power_int;
	myData_buf[4] = joint[TAIL_MOT].getPosition();
	// myData_buf[1] = joint[TAIL_MOT].getOpenLoop();
	// myData_buf[2] = trajBound.t;
	// myData_buf[3] = trajBound.posDes[2];
	write(LOGGER_FILENO, myData, 32);
}

int main(int argc, char *argv[])
{
#if defined(ROBOT_MINITAUR)
	init(RobotParams_Type_MINITAUR, argc, argv);

		// Set the joint type; see JointParams
	P->joints[TAIL_MOT].type = JointParams_Type_GRBL;

	// Set the *physical* address (e.g. etherCAT ID, PWM port, dynamixel ID, etc.)
	P->joints[TAIL_MOT].address = TAIL_MOT+1;

	// If there is a gearbox the joint electronics doesn't know about, this could be > 1.
	// Do not set to 0.
	P->joints[TAIL_MOT].gearRatio = 45.39;

	// Configure joints
	P->joints_count = S->joints_count = C->joints_count = MOTORS;
	for (int i = 0; i < P->joints_count; i++)
	{
		// Set zeros and directions
		P->joints[i].zero = motZeros[i]; //Add motor zeros from array at beginning of file
	}
	P->joints[TAIL_MOT].direction = 1;
		
#elif defined(ROBOT_MINITAUR_E)
	init(RobotParams_Type_MINITAUR_E, argc, argv);
	JoyType joyType = JoyType_FRSKY_XSR;
	ioctl(JOYSTICK_FILENO, IOCTL_CMD_JOYSTICK_SET_TYPE, &joyType);
#else
#error "Define robot type in preprocessor"
#endif


	// Uncomment to clear Bound and Walk behaviors
	behaviors.clear();
	
	behaviors.push_back(&trajBound);

	setDebugRate(100);
	safetyShutoffEnable(false);

	SerialPortConfig cfg;
	cfg.baud = 115200;
	cfg.mode = SERIAL_8N1;
	ioctl(STDOUT_FILENO, IOCTL_CMD_SERIAL_PORT_CFG, &cfg);


	// Run
	return begin();
}
