
#include <stdio.h>
#include <SDK.h>
#include <math.h>
#include <Motor.h>
#include <ReorientableBehavior.h>
#include "Interpolator.h"

#if defined(ROBOT_MINITAUR)
// Subject to change for individual robots
// const float motZeros[8] = {2.82, 3.435, 3.54, 3.076, 1.03, 3.08, 6.190, 1.493};
<<<<<<< HEAD
// const float motZeros[8] = {2.570, 2.036, 3.777, 3.853, 2.183, 1.556, .675, 2.679}; // RML Ellie
const float motZeros[8] = {5.200, 5.712, 3.777, 3.853, 2.183, 1.556, .675, 2.679}; // RML Ellie
=======
const float motZeros[8] = {0.93, 5.712, 3.777, 3.853, 2.183, 1.556, .675, 2.679}; // RML Ellie
>>>>>>> cf144770af5e34d59cd9d4ef8f47088c353703f4
// const float motZeros[8] = {0.631, 4.076, 1.852, 3.414, 1.817, 5.500, 1.078, 6.252}; //RML Odie
#endif

#define TIMESTEPS 42
#define MOTORS 8

enum TBMode
{
	TB_SIT = 0,
	TB_STAND,
};

char myData[32];
float* myData_buf = (float*)myData;

// globals for power monitoring values
float voltage, current;
float oldvoltage, oldcurrent;
float power_int = 0;

#pragma pack(push, 1)
// We receive the serial protocol version number (in case we add more fields later)
// our behaviorCmd, and a checksum.
struct SerialCommandPacket
{
	float voltage, current;
};

const char ALIGNMENT_WORD[2] = {'G', 'R'};

#pragma pack(pop)

// OG Bound, works
// float pos[TIMESTEPS][MOTORS] = {{0.456580, 0.215020, 0.837780, 1.625513, 0.215119, 0.456482, 1.625524, 0.837784},
// 																{0.458896, 0.215851, 0.839891, 1.628079, 0.215932, 0.458864, 1.628090, 0.839896},
// 																{0.461286, 0.216499, 0.842176, 1.630833, 0.216598, 0.461188, 1.630845, 0.842180},
// 																{0.463604, 0.217333, 0.844284, 1.633389, 0.217413, 0.463572, 1.633401, 0.844289},
// 																{0.465998, 0.217985, 0.846568, 1.636134, 0.218084, 0.465900, 1.636146, 0.846572},
// 																{0.468319, 0.218823, 0.848676, 1.638681, 0.218903, 0.468287, 1.638692, 0.848680},
// 																{0.470714, 0.219479, 0.850959, 1.641416, 0.219578, 0.470616, 1.641428, 0.850963},
// 																{0.473039, 0.220321, 0.853065, 1.643954, 0.220401, 0.473006, 1.643965, 0.853069},
// 																{0.475434, 0.220981, 0.855346, 1.646680, 0.221080, 0.475335, 1.646691, 0.855350},
// 																{0.477762, 0.221826, 0.857451, 1.649208, 0.221906, 0.477729, 1.649219, 0.857455},
// 																{0.480158, 0.222490, 0.859731, 1.651924, 0.222589, 0.480059, 1.651936, 0.859735},
// 																{0.482490, 0.223339, 0.861834, 1.654443, 0.223419, 0.482457, 1.654454, 0.861839},
// 																{0.484886, 0.224006, 0.864113, 1.657151, 0.224106, 0.484787, 1.657162, 0.864117},
// 																{0.487221, 0.224860, 0.866215, 1.659660, 0.224940, 0.487188, 1.659671, 0.866220},
// 																{0.489618, 0.225531, 0.868492, 1.662358, 0.225630, 0.489519, 1.662370, 0.868496},
// 																{0.491957, 0.226387, 0.870592, 1.664859, 0.226467, 0.491924, 1.664870, 0.870597},
// 																{0.494354, 0.227062, 0.872869, 1.667548, 0.227161, 0.494255, 1.667559, 0.872873},
// 																{0.496696, 0.227923, 0.874968, 1.670039, 0.228003, 0.496663, 1.670051, 0.874973},
// 																{0.499093, 0.228601, 0.877242, 1.672719, 0.228700, 0.498994, 1.672731, 0.877246},
// 																{0.501439, 0.229465, 0.879340, 1.675201, 0.229546, 0.501405, 1.675213, 0.879345},
// 																{0.503836, 0.230147, 0.881613, 1.677873, 0.230247, 0.503737, 1.677884, 0.881617},
// 																{0.503736, 0.230047, 0.881513, 1.677773, 0.230147, 0.503836, 1.677784, 0.881517},
// 																{0.433257, 0.208666, 0.917353, 1.732804, 0.208696, 0.433344, 1.732815, 0.917356},
// 																{0.383392, 0.216608, 0.946268, 1.760331, 0.216568, 0.383465, 1.760342, 0.946271},
// 																{0.350902, 0.249098, 0.970632, 1.768031, 0.249059, 0.350941, 1.768042, 0.970583},
// 																{0.334258, 0.303670, 0.990909, 1.759397, 0.303631, 0.334264, 1.759407, 0.990912},
// 																{0.334625, 0.381893, 1.007433, 1.736623, 0.381854, 0.334631, 1.736633, 1.007434},
// 																{0.351061, 0.481579, 1.020068, 1.701112, 0.481540, 0.351067, 1.701122, 1.020070},
// 																{0.380882, 0.599637, 1.029728, 1.655103, 0.599599, 0.380888, 1.655007, 1.029731},
// 																{0.420566, 0.729634, 1.036853, 1.600236, 0.729596, 0.420571, 1.600244, 1.036858},
// 																{0.465293, 0.865162, 1.042909, 1.538116, 0.865125, 0.465297, 1.538124, 1.042914},
// 																{0.511940, 1.000374, 1.048554, 1.470629, 1.000337, 0.511944, 1.470637, 1.048559},
// 																{0.557279, 1.131156, 1.055333, 1.398920, 1.131119, 0.557283, 1.398928, 1.055337},
// 																{0.600386, 1.255854, 1.063832, 1.325112, 1.255818, 0.600389, 1.325120, 1.063836},
// 																{0.640101, 1.373141, 1.075086, 1.250646, 1.373105, 0.640104, 1.250653, 1.075090},
// 																{0.676737, 1.483559, 1.089677, 1.177967, 1.483523, 0.676739, 1.177974, 1.089680},
// 																{0.709999, 1.587140, 1.107351, 1.108953, 1.587104, 0.710001, 1.108985, 1.107354},
// 																{0.740571, 1.684942, 1.128191, 1.045846, 1.684906, 0.740573, 1.045853, 1.128193},
// 																{0.768396, 1.777287, 1.151433, 0.990034, 1.777252, 0.768398, 0.990041, 1.151449},
// 																{0.794181, 1.865205, 1.176224, 0.942517, 1.865170, 0.794182, 0.942523, 1.176226},
// 																{0.818101, 1.948981, 1.201952, 0.904425, 1.948946, 0.818102, 0.904432, 1.201953},
// 																{0.839927, 2.029193, 1.228159, 0.876733, 2.029158, 0.839928, 0.876739, 1.228160},
// 																{0.840027, 2.029093, 1.228259, 0.876633, 2.029058, 0.840028, 0.876639, 1.228159},
// 																{0.840784, 2.031811, 1.229372, 0.875867, 2.031776, 0.840785, 0.875869, 1.229293},
// 																{0.841390, 2.034711, 1.230358, 0.875010, 2.034676, 0.841391, 0.875016, 1.230258},
// 																{0.841986, 2.037422, 1.231345, 0.874240, 2.037388, 0.841987, 0.874243, 1.231305},
// 																{0.842753, 2.040316, 1.232460, 0.873394, 2.040281, 0.842754, 0.873400, 1.232360},
// 																{0.843348, 2.043020, 1.233450, 0.872627, 2.042985, 0.843349, 0.872630, 1.233409},
// 																{0.844114, 2.045907, 1.234566, 0.871784, 2.045872, 0.844115, 0.871791, 1.234466},
// 																{0.844709, 2.048604, 1.235558, 0.871021, 2.048570, 0.844710, 0.871024, 1.235518},
// 																{0.845474, 2.051485, 1.236676, 0.870181, 2.051450, 0.845475, 0.870188, 1.236576},
// 																{0.846069, 2.054176, 1.237669, 0.869422, 2.054142, 0.846069, 0.869424, 1.237629},
// 																{0.846834, 2.057050, 1.238789, 0.868585, 2.057016, 0.846834, 0.868592, 1.238689},
// 																{0.847427, 2.059735, 1.239784, 0.867829, 2.059701, 0.847428, 0.867832, 1.239745},
// 																{0.848192, 2.062603, 1.240905, 0.866996, 2.062568, 0.848193, 0.867002, 1.240805},
// 																{0.848785, 2.065281, 1.241903, 0.866243, 2.065247, 0.848786, 0.866246, 1.241863},
// 																{0.849549, 2.068142, 1.243025, 0.865413, 2.068107, 0.849550, 0.865419, 1.242925},
// 																{0.850142, 2.070814, 1.244025, 0.864664, 2.070780, 0.850143, 0.864667, 1.243985},
// 																{0.850905, 2.073668, 1.245148, 0.863837, 2.073634, 0.850906, 0.863844, 1.245048},
// 																{0.851498, 2.076334, 1.246150, 0.863092, 2.076300, 0.851498, 0.863095, 1.246111},
// 																{0.852260, 2.079182, 1.247274, 0.862268, 2.079147, 0.852261, 0.862274, 1.247174},
// 																{0.852852, 2.081841, 1.248277, 0.861527, 2.081807, 0.852853, 0.861529, 1.248236},
// 																{0.853614, 2.084683, 1.249404, 0.860706, 2.084648, 0.853615, 0.860712, 1.249304},
// 																{0.853514, 2.084583, 1.249304, 0.860606, 2.084548, 0.853515, 0.860612, 1.249286},
// 																{0.865081, 2.146565, 1.125639, 0.814393, 2.146531, 0.865082, 0.814400, 1.125622},
// 																{0.858847, 2.170244, 0.998816, 0.761381, 2.170211, 0.858848, 0.761388, 0.998799},
// 																{0.838996, 2.164239, 0.867548, 0.700631, 2.164206, 0.838997, 0.700639, 0.867531},
// 																{0.807450, 2.131612, 0.733574, 0.632462, 2.131580, 0.807451, 0.632470, 0.733557},
// 																{0.765781, 2.073027, 0.599712, 0.559885, 2.073047, 0.765781, 0.559893, 0.599696},
// 																{0.715068, 1.989149, 0.472533, 0.489464, 1.989117, 0.715067, 0.489473, 0.472518},
// 																{0.657371, 1.880361, 0.359828, 0.431822, 1.880330, 0.657414, 0.431832, 0.359813},
// 																{0.594249, 1.748407, 0.269255, 0.397188, 1.748376, 0.594246, 0.397198, 0.269240},
// 																{0.527285, 1.593922, 0.205683, 0.394319, 1.593892, 0.527237, 0.394331, 0.205669},
// 																{0.460485, 1.422441, 0.171886, 0.428114, 1.422412, 0.460388, 0.428128, 0.171872},
// 																{0.399695, 1.243221, 0.170355, 0.502165, 1.243192, 0.399599, 0.502179, 0.170343},
// 																{0.349491, 1.063851, 0.200114, 0.611814, 1.063823, 0.349392, 0.611827, 0.200102},
// 																{0.311725, 0.888446, 0.257601, 0.749150, 0.888481, 0.311628, 0.749163, 0.257590},
// 																{0.288297, 0.721839, 0.334882, 0.899547, 0.721936, 0.288198, 0.899560, 0.334871},
// 																{0.279791, 0.569930, 0.421574, 1.048906, 0.570027, 0.279693, 1.048918, 0.421563},
// 																{0.286686, 0.437951, 0.511224, 1.189075, 0.438049, 0.286587, 1.189088, 0.511214},
// 																{0.308171, 0.331721, 0.598926, 1.316163, 0.331820, 0.308073, 1.316175, 0.598916},
// 																{0.344118, 0.255882, 0.682841, 1.430585, 0.255982, 0.344020, 1.430597, 0.682832},
// 																{0.393365, 0.215163, 0.762928, 1.533217, 0.215262, 0.393266, 1.533229, 0.762919},
// 																{0.456680, 0.215120, 0.837693, 1.625613, 0.215219, 0.456580, 1.625624, 0.837684}};

// float vel[TIMESTEPS][MOTORS] = {{15.208288, 5.196631, 14.856636, 17.943012, 5.196727, 15.208387, 17.942915, 14.856657},
// 																{15.219876, 5.214287, 14.852277, 17.908215, 5.214312, 15.219862, 17.908171, 14.852279},
// 																{15.229264, 5.229532, 14.847982, 17.875181, 5.229534, 15.229234, 17.875157, 14.847983},
// 																{15.236333, 5.241885, 14.843530, 17.843828, 5.241900, 15.236301, 17.843811, 14.843526},
// 																{15.243243, 5.254293, 14.839175, 17.812726, 5.254300, 15.243222, 17.812711, 14.839173},
// 																{15.250185, 5.266646, 14.834690, 17.781559, 5.266665, 15.250159, 17.781543, 14.834686},
// 																{15.256966, 5.279047, 14.830306, 17.750640, 5.279065, 15.256959, 17.750623, 14.830302},
// 																{15.263789, 5.291399, 14.825791, 17.719654, 5.291420, 15.263765, 17.719638, 14.825785},
// 																{15.270449, 5.303791, 14.821378, 17.688917, 5.303810, 15.270443, 17.688900, 14.821372},
// 																{15.277156, 5.316127, 14.816833, 17.658111, 5.316147, 15.277129, 17.658095, 14.816826},
// 																{15.283696, 5.328506, 14.812393, 17.627555, 5.328523, 15.283685, 17.627540, 14.812384},
// 																{15.290279, 5.340831, 14.807821, 17.596932, 5.340852, 15.290250, 17.596917, 14.807811},
// 																{15.296697, 5.353204, 14.803355, 17.566559, 5.353218, 15.296681, 17.566545, 14.803343},
// 																{15.303156, 5.365523, 14.798756, 17.536120, 5.365543, 15.303124, 17.536106, 14.798746},
// 																{15.309452, 5.377893, 14.794264, 17.505931, 5.377902, 15.309429, 17.505919, 14.794254},
// 																{15.315786, 5.390205, 14.789640, 17.475674, 5.390222, 15.315750, 17.475665, 14.789633},
// 																{15.321962, 5.402575, 14.785123, 17.445668, 5.402573, 15.321927, 17.445664, 14.785121},
// 																{15.328168, 5.414881, 14.780476, 17.415595, 5.414893, 15.328126, 17.415597, 14.780477},
// 																{15.334214, 5.427248, 14.775944, 17.385780, 5.427242, 15.334183, 17.385775, 14.775937},
// 																{15.340021, 5.439183, 14.771269, 17.356125, 5.439205, 15.339998, 17.356093, 14.771242},
// 																{15.347205, 5.453313, 14.766847, 17.325431, 5.453413, 15.347304, 17.325359, 14.766749},
// 																{-19.673651, -9.046189, 9.614278, 17.211650, -9.046089, -19.673551, 17.211623, 9.614376},
// 																{-14.545107, -1.519314, 7.767744, 9.739048, -1.519389, -14.545206, 9.738982, 7.767720},
// 																{-9.772452, 5.273335, 6.352611, 3.968632, 5.273312, -9.772371, 3.968550, 6.352547},
// 																{-6.014181, 10.514746, 5.396396, -0.179676, 10.514845, -6.014279, -0.179764, 5.396345},
// 																{-1.989448, 16.080142, 4.466648, -3.856989, 16.080241, -1.989460, -3.857063, 4.466596},
// 																{2.108394, 21.709637, 3.499284, -7.134030, 21.709664, 2.108296, -7.134095, 3.499203},
// 																{5.707638, 26.587177, 2.677460, -9.937867, 26.587276, 5.707737, -9.937953, 2.677394},
// 																{8.598003, 30.369536, 2.009803, -12.287837, 30.369635, 8.597904, -12.287931, 2.009754},
// 																{10.393881, 32.474358, 1.544800, -14.228296, 32.474458, 10.393782, -14.228381, 1.544707},
// 																{11.195537, 33.037770, 1.363396, -15.765808, 33.037868, 11.195438, -15.765896, 1.363307},
// 																{11.228281, 32.417733, 1.441862, -16.928201, 32.417820, 11.228193, -16.928297, 1.441764},
// 																{10.749230, 31.038398, 1.807177, -17.705665, 31.038451, 10.749133, -17.705762, 1.807084},
// 																{10.048712, 29.369953, 2.372152, -18.043249, 29.370031, 10.048621, -18.043331, 2.372056},
// 																{9.241858, 27.605630, 3.115350, -17.915821, 27.605729, 9.241759, -17.915805, 3.115259},
// 																{8.458544, 25.941672, 3.896688, -17.272711, 25.941771, 8.458444, -17.272656, 3.896601},
// 																{7.713256, 24.399932, 4.678399, -16.069114, 24.400015, 7.713158, -16.069212, 4.678305},
// 																{7.056583, 23.042253, 5.336806, -14.499892, 23.042310, 7.056496, -14.499793, 5.336904},
// 																{6.475851, 21.844653, 5.841245, -12.555375, 21.844664, 6.475752, -12.555475, 5.841145},
// 																{5.969950, 20.797958, 6.170448, -10.380347, 20.797966, 5.969881, -10.380247, 6.170548},
// 																{5.546991, 19.902005, 6.260377, -8.041681, 19.902052, 5.546991, -8.041781, 6.260277},
// 																{5.050813, 18.972803, 6.499525, -5.239572, 18.972753, 5.050738, -5.239472, 6.499625},
// 																{4.785155, 18.708782, 6.524463, -4.988881, 18.708777, 4.785076, -4.988783, 6.524547},
// 																{4.782772, 18.685883, 6.531585, -4.977229, 18.685926, 4.782778, -4.977229, 6.531581},
// 																{4.780763, 18.663694, 6.538027, -4.965855, 18.663749, 4.780786, -4.965880, 6.538011},
// 																{4.778924, 18.641993, 6.543955, -4.955024, 18.642049, 4.778953, -4.955050, 6.543923},
// 																{4.777209, 18.620494, 6.549730, -4.944062, 18.620547, 4.777240, -4.944088, 6.549695},
// 																{4.775402, 18.598905, 6.555572, -4.933205, 18.598957, 4.775429, -4.933226, 6.555537},
// 																{4.773716, 18.577519, 6.561262, -4.922215, 18.577565, 4.773739, -4.922229, 6.561232},
// 																{4.771929, 18.556039, 6.567021, -4.911319, 18.556090, 4.771953, -4.911336, 6.566988},
// 																{4.770268, 18.534765, 6.572628, -4.900294, 18.534810, 4.770290, -4.900307, 6.572601},
// 																{4.768508, 18.513396, 6.578306, -4.889365, 18.513447, 4.768534, -4.889384, 6.578272},
// 																{4.766874, 18.492232, 6.583832, -4.878308, 18.492279, 4.766900, -4.878324, 6.583805},
// 																{4.765143, 18.470975, 6.589432, -4.867351, 18.471027, 4.765170, -4.867371, 6.589395},
// 																{4.763534, 18.449921, 6.594878, -4.856264, 18.449971, 4.763564, -4.856283, 6.594849},
// 																{4.761829, 18.428774, 6.600398, -4.845279, 18.428828, 4.761858, -4.845301, 6.600359},
// 																{4.760245, 18.407831, 6.605764, -4.834164, 18.407881, 4.760275, -4.834184, 6.605732},
// 																{4.758564, 18.386794, 6.611203, -4.823150, 18.386846, 4.758591, -4.823171, 6.611161},
// 																{4.757006, 18.365961, 6.616488, -4.812005, 18.366006, 4.757029, -4.812025, 6.616454},
// 																{4.755349, 18.345034, 6.621847, -4.800963, 18.345079, 4.755368, -4.800984, 6.621802},
// 																{4.753814, 18.324307, 6.627049, -4.789790, 18.324348, 4.753830, -4.789808, 6.627014},
// 																{4.752206, 18.303545, 6.632320, -4.778728, 18.303603, 4.752236, -4.778747, 6.632274},
// 																{4.750497, 18.282574, 6.637467, -4.767488, 18.282660, 4.750552, -4.767504, 6.637437},
// 																{4.444696, 17.389367, -25.378543, -9.012775, 17.389466, 4.444795, -9.012676, -25.378643},
// 																{0.422581, 8.634837, -26.025995, -10.291638, 8.634935, 0.422541, -10.291541, -26.025896},
// 																{-2.872046, 1.549230, -26.774947, -11.756252, 1.549322, -2.872038, -11.756154, -26.774936},
// 																{-5.397138, -4.035490, -27.675041, -13.484422, -4.035402, -5.397184, -13.484324, -27.674969},
// 																{-7.650886, -9.434425, -27.983014, -14.757776, -9.434328, -7.650979, -14.757686, -27.982918},
// 																{-9.672593, -14.829387, -27.391745, -15.173740, -14.829294, -9.672677, -15.173656, -27.391647},
// 																{-11.327592, -20.020867, -25.287917, -13.778152, -20.020774, -11.327666, -13.778062, -25.287821},
// 																{-12.633791, -25.075078, -21.340449, -9.923380, -25.074980, -12.633878, -9.923282, -21.340351},
// 																{-13.537871, -29.734599, -16.170016, -4.130883, -29.734516, -13.537953, -4.130785, -16.169920},
// 																{-14.095548, -34.145246, -10.224690, 3.071006, -34.145158, -14.095598, 3.071070, -10.224591},
// 																{-13.552855, -36.882765, -3.709449, 11.193847, -36.882669, -13.552946, 11.193845, -3.709353},
// 																{-11.621591, -37.407862, 3.008677, 19.335505, -37.407764, -11.621620, 19.335455, 3.008769},
// 																{-9.235185, -37.027906, 9.214824, 26.075262, -37.027814, -9.235096, 26.075217, 9.214917},
// 																{-6.406997, -35.722082, 14.349770, 30.454783, -35.721987, -6.406930, 30.454756, 14.349864},
// 																{-3.357700, -33.288216, 17.360078, 31.588402, -33.288118, -3.357615, 31.588371, 17.360166},
// 																{-0.167567, -29.687963, 18.507781, 30.290433, -29.687867, -0.167535, 30.290398, 18.507875},
// 																{2.961213, -24.920178, 18.507503, 27.851708, -24.920125, 2.961295, 27.851662, 18.507595},
// 																{5.974606, -19.086310, 17.856988, 25.076050, -19.086211, 5.974629, 25.075998, 17.857079},
// 																{8.890534, -12.203544, 17.016357, 22.503369, -12.203447, 8.890632, 22.503316, 17.016448},
// 																{11.603815, -4.485356, 16.148690, 20.251577, -4.485455, 11.603716, 20.251516, 16.148766},
// 																{14.821626, 4.789595, 14.886701, 18.165096, 4.789694, 14.821724, 18.164999, 14.886672}};

// float u[TIMESTEPS][MOTORS] = {{0.039207, 0.061161, 0.003953, -0.078132, 0.060999, 0.039064, -0.077895, 0.003909},
// 															{0.039207, 0.061161, 0.003953, -0.078132, 0.060999, 0.039064, -0.077895, 0.003909},
// 															{0.026988, 0.045214, -0.000039, -0.062277, 0.045221, 0.026996, -0.062279, -0.000028},
// 															{0.026988, 0.045214, -0.000039, -0.062277, 0.045221, 0.026996, -0.062279, -0.000028},
// 															{0.026949, 0.045667, -0.000340, -0.062311, 0.045660, 0.026944, -0.062302, -0.000330},
// 															{0.026949, 0.045667, -0.000340, -0.062311, 0.045660, 0.026944, -0.062302, -0.000330},
// 															{0.026901, 0.046109, -0.000639, -0.062337, 0.046107, 0.026899, -0.062332, -0.000634},
// 															{0.026901, 0.046109, -0.000639, -0.062337, 0.046107, 0.026899, -0.062332, -0.000634},
// 															{0.026854, 0.046550, -0.000941, -0.062365, 0.046548, 0.026852, -0.062359, -0.000939},
// 															{0.026854, 0.046550, -0.000941, -0.062365, 0.046548, 0.026852, -0.062359, -0.000939},
// 															{0.026807, 0.046987, -0.001244, -0.062394, 0.046983, 0.026807, -0.062386, -0.001245},
// 															{0.026807, 0.046987, -0.001244, -0.062394, 0.046983, 0.026807, -0.062386, -0.001245},
// 															{0.026757, 0.047424, -0.001548, -0.062423, 0.047412, 0.026761, -0.062411, -0.001552},
// 															{0.026757, 0.047424, -0.001548, -0.062423, 0.047412, 0.026761, -0.062411, -0.001552},
// 															{0.026704, 0.047855, -0.001853, -0.062451, 0.047843, 0.026708, -0.062435, -0.001860},
// 															{0.026704, 0.047855, -0.001853, -0.062451, 0.047843, 0.026708, -0.062435, -0.001860},
// 															{0.026652, 0.048278, -0.002163, -0.062478, 0.048267, 0.026656, -0.062459, -0.002171},
// 															{0.026652, 0.048278, -0.002163, -0.062478, 0.048267, 0.026656, -0.062459, -0.002171},
// 															{0.026600, 0.048699, -0.002469, -0.062512, 0.048687, 0.026604, -0.062478, -0.002486},
// 															{0.026600, 0.048699, -0.002469, -0.062512, 0.048687, 0.026604, -0.062478, -0.002486},
// 															{0.038794, 0.067164, -0.000007, -0.078504, 0.067151, 0.038790, -0.078449, -0.000014},
// 															{0.720008, 1.246191, 0.062036, -1.420027, 1.246233, 0.719656, -1.420017, 0.062089},
// 															{0.720008, 1.246191, 0.062036, -1.420027, 1.246233, 0.719656, -1.420017, 0.062089},
// 															{0.672793, 0.688173, 0.023033, -0.889000, 0.687832, 0.673183, -0.889012, 0.023028},
// 															{0.672793, 0.688173, 0.023033, -0.889000, 0.687832, 0.673183, -0.889012, 0.023028},
// 															{0.808753, 0.657883, 0.032837, -0.677691, 0.658156, 0.808478, -0.677706, 0.032841},
// 															{0.808753, 0.657883, 0.032837, -0.677691, 0.658156, 0.808478, -0.677706, 0.032841},
// 															{0.768471, 0.612266, 0.083231, -0.466071, 0.612906, 0.767824, -0.466087, 0.083232},
// 															{0.768471, 0.612266, 0.083231, -0.466071, 0.612906, 0.767824, -0.466087, 0.083232},
// 															{0.733845, 0.400226, 0.116494, -0.258886, 0.400231, 0.733860, -0.258892, 0.116495},
// 															{0.733845, 0.400226, 0.116494, -0.258886, 0.400231, 0.733860, -0.258892, 0.116495},
// 															{0.654835, 0.223808, 0.101620, -0.069872, 0.223814, 0.654850, -0.069878, 0.101630},
// 															{0.654835, 0.223808, 0.101620, -0.069872, 0.223814, 0.654850, -0.069878, 0.101630},
// 															{0.566301, 0.131259, 0.040606, 0.100100, 0.131264, 0.566326, 0.100083, 0.040590},
// 															{0.566301, 0.131259, 0.040606, 0.100100, 0.131264, 0.566326, 0.100083, 0.040590},
// 															{0.494659, 0.082267, -0.038315, 0.264566, 0.082266, 0.494676, 0.264637, -0.038243},
// 															{0.494659, 0.082267, -0.038315, 0.264566, 0.082266, 0.494676, 0.264637, -0.038243},
// 															{0.517614, 0.075204, -0.073363, 0.300386, 0.075187, 0.517576, 0.300268, -0.073416},
// 															{0.517614, 0.075204, -0.073363, 0.300386, 0.075187, 0.517576, 0.300268, -0.073416},
// 															{0.514338, 0.061061, -0.118291, 0.364531, 0.061144, 0.514716, 0.364492, -0.118234},
// 															{0.514338, 0.061061, -0.118291, 0.364531, 0.061144, 0.514716, 0.364492, -0.118234},
// 															{-0.128372, -0.077703, -0.145700, 0.559950, -0.078177, -0.130646, 0.560515, -0.145008},
// 															{-0.018186, -0.038603, 0.004242, 0.020523, -0.038418, -0.018120, 0.020358, 0.004064},
// 															{-0.018186, -0.038603, 0.004242, 0.020523, -0.038418, -0.018120, 0.020358, 0.004064},
// 															{-0.014615, -0.033432, 0.001341, 0.016587, -0.033425, -0.014630, 0.016591, 0.001326},
// 															{-0.014615, -0.033432, 0.001341, 0.016587, -0.033425, -0.014630, 0.016591, 0.001326},
// 															{-0.014551, -0.033329, 0.001086, 0.016905, -0.033317, -0.014557, 0.016899, 0.001066},
// 															{-0.014551, -0.033329, 0.001086, 0.016905, -0.033317, -0.014557, 0.016899, 0.001066},
// 															{-0.014483, -0.033222, 0.000825, 0.017213, -0.033216, -0.014488, 0.017212, 0.000813},
// 															{-0.014483, -0.033222, 0.000825, 0.017213, -0.033216, -0.014488, 0.017212, 0.000813},
// 															{-0.014417, -0.033117, 0.000566, 0.017522, -0.033114, -0.014419, 0.017521, 0.000557},
// 															{-0.014417, -0.033117, 0.000566, 0.017522, -0.033114, -0.014419, 0.017521, 0.000557},
// 															{-0.014350, -0.033012, 0.000308, 0.017829, -0.033012, -0.014351, 0.017829, 0.000302},
// 															{-0.014350, -0.033012, 0.000308, 0.017829, -0.033012, -0.014351, 0.017829, 0.000302},
// 															{-0.014285, -0.032907, 0.000050, 0.018135, -0.032909, -0.014284, 0.018135, 0.000047},
// 															{-0.014285, -0.032907, 0.000050, 0.018135, -0.032909, -0.014284, 0.018135, 0.000047},
// 															{-0.014219, -0.032802, -0.000207, 0.018440, -0.032806, -0.014217, 0.018440, -0.000210},
// 															{-0.014219, -0.032802, -0.000207, 0.018440, -0.032806, -0.014217, 0.018440, -0.000210},
// 															{-0.014154, -0.032697, -0.000466, 0.018745, -0.032702, -0.014152, 0.018744, -0.000468},
// 															{-0.014154, -0.032697, -0.000466, 0.018745, -0.032702, -0.014152, 0.018744, -0.000468},
// 															{-0.014090, -0.032591, -0.000726, 0.019048, -0.032600, -0.014087, 0.019048, -0.000727},
// 															{-0.014090, -0.032591, -0.000726, 0.019048, -0.032600, -0.014087, 0.019048, -0.000727},
// 															{-0.017212, -0.037102, 0.001438, 0.024521, -0.037113, -0.017212, 0.024494, 0.001431},
// 															{-0.509879, -1.394311, -0.199851, 0.703856, -1.394333, -0.509879, 0.705141, -0.201098},
// 															{-0.509879, -1.394311, -0.199851, 0.703856, -1.394333, -0.509879, 0.705141, -0.201098},
// 															{-0.310862, -0.905084, -0.007363, 0.626698, -0.905090, -0.310859, 0.627072, -0.007733},
// 															{-0.310862, -0.905084, -0.007363, 0.626698, -0.905090, -0.310859, 0.627072, -0.007733},
// 															{-0.226209, -0.746817, 0.198092, 0.770727, -0.746819, -0.226212, 0.770827, 0.198057},
// 															{-0.226209, -0.746817, 0.198092, 0.770727, -0.746819, -0.226212, 0.770827, 0.198057},
// 															{-0.125439, -0.529108, 0.415374, 0.902617, -0.529112, -0.125454, 0.903282, 0.414847},
// 															{-0.125439, -0.529108, 0.415374, 0.902617, -0.529112, -0.125454, 0.903282, 0.414847},
// 															{-0.035860, -0.313469, 0.531773, 0.951710, -0.313485, -0.035874, 0.952999, 0.530645},
// 															{-0.035860, -0.313469, 0.531773, 0.951710, -0.313485, -0.035874, 0.952999, 0.530645},
// 															{0.128003, 0.158432, 0.778171, 0.981293, 0.158431, 0.127984, 0.982132, 0.777497},
// 															{0.128003, 0.158432, 0.778171, 0.981293, 0.158431, 0.127984, 0.982132, 0.777497},
// 															{0.161472, 0.275712, 0.842845, 0.952044, 0.275718, 0.161460, 0.953277, 0.841940},
// 															{0.161472, 0.275712, 0.842845, 0.952044, 0.275718, 0.161460, 0.953277, 0.841940},
// 															{0.188544, 0.431184, 0.811423, 0.603679, 0.431185, 0.188535, 0.603676, 0.811563},
// 															{0.188544, 0.431184, 0.811423, 0.603679, 0.431185, 0.188535, 0.603676, 0.811563},
// 															{0.198272, 0.597502, 0.680532, 0.316573, 0.597507, 0.198243, 0.316438, 0.680402},
// 															{0.198272, 0.597502, 0.680532, 0.316573, 0.597507, 0.198243, 0.316438, 0.680402},
// 															{0.213709, 0.789726, 0.534221, 0.169805, 0.789683, 0.213613, 0.169788, 0.534262},
// 															{0.213709, 0.789726, 0.534221, 0.169805, 0.789683, 0.213613, 0.169788, 0.534262},
// 															{0.411505, 1.141278, -0.220036, -0.168463, 1.141519, 0.411791, -0.167959, -0.223169}};
//
// float times[TIMESTEPS] = {0.000000, 0.000151, 0.000303, 0.000454, 0.000605, 0.000757, 0.000908, 0.001059, 0.001211, 0.001362, 0.001513, 0.001665, 0.001816, 0.001967, 0.002119, 0.002270, 0.002421, 0.002573, 0.002724, 0.002875, 0.003027, 0.003027, 0.007150, 0.011274, 0.015397, 0.019521, 0.023645, 0.027768, 0.031892, 0.036015, 0.040139, 0.044262, 0.048386, 0.052510, 0.056633, 0.060757, 0.064880, 0.069004, 0.073127, 0.077251, 0.081374, 0.085498, 0.085498, 0.085651, 0.085804, 0.085957, 0.086110, 0.086263, 0.086416, 0.086569, 0.086722, 0.086875, 0.087028, 0.087181, 0.087334, 0.087487, 0.087640, 0.087793, 0.087946, 0.088099, 0.088252, 0.088405, 0.088558, 0.088558, 0.093369, 0.098180, 0.102991, 0.107802, 0.112613, 0.117424, 0.122235, 0.127046, 0.131857, 0.136669, 0.141480, 0.146291, 0.151102, 0.155913, 0.160724, 0.165535, 0.170346, 0.175157, 0.179968, 0.184779};

// float pos[TIMESTEPS][MOTORS] = {{0.456580,0.215020,0.837780,1.625513,0.215119,0.456482,1.625524,0.837784},{0.458896,0.215851,0.839891,1.628079,0.215932,0.458864,1.628090,0.839896},{0.461286,0.216499,0.842176,1.630833,0.216598,0.461188,1.630845,0.842180},{0.463604,0.217333,0.844284,1.633389,0.217413,0.463572,1.633401,0.844289},{0.465998,0.217985,0.846568,1.636134,0.218084,0.465900,1.636146,0.846572},{0.468319,0.218823,0.848676,1.638681,0.218903,0.468287,1.638692,0.848680},{0.470714,0.219479,0.850959,1.641416,0.219578,0.470616,1.641428,0.850963},{0.473039,0.220321,0.853065,1.643954,0.220401,0.473006,1.643965,0.853069},{0.475434,0.220981,0.855346,1.646680,0.221080,0.475335,1.646691,0.855350},{0.477762,0.221826,0.857451,1.649208,0.221906,0.477729,1.649219,0.857455},{0.480158,0.222490,0.859731,1.651924,0.222589,0.480059,1.651936,0.859735},{0.482490,0.223339,0.861834,1.654443,0.223419,0.482457,1.654454,0.861839},{0.484886,0.224006,0.864113,1.657151,0.224106,0.484787,1.657162,0.864117},{0.487221,0.224860,0.866215,1.659660,0.224940,0.487188,1.659671,0.866220},{0.489618,0.225531,0.868492,1.662358,0.225630,0.489519,1.662370,0.868496},{0.491957,0.226387,0.870592,1.664859,0.226467,0.491924,1.664870,0.870597},{0.494354,0.227062,0.872869,1.667548,0.227161,0.494255,1.667559,0.872873},{0.496696,0.227923,0.874968,1.670039,0.228003,0.496663,1.670051,0.874973},{0.499093,0.228601,0.877242,1.672719,0.228700,0.498994,1.672731,0.877246},{0.501439,0.229465,0.879340,1.675201,0.229546,0.501405,1.675213,0.879345},{0.503836,0.230147,0.881613,1.677873,0.230247,0.503737,1.677884,0.881617},{0.503736,0.230047,0.881513,1.677773,0.230147,0.503836,1.677784,0.881517},{0.433257,0.208666,0.917353,1.732804,0.208696,0.433344,1.732815,0.917356},{0.383392,0.216608,0.946268,1.760331,0.216568,0.383465,1.760342,0.946271},{0.350902,0.249098,0.970632,1.768031,0.249059,0.350941,1.768042,0.970583},{0.334258,0.303670,0.990909,1.759397,0.303631,0.334264,1.759407,0.990912},{0.334625,0.381893,1.007433,1.736623,0.381854,0.334631,1.736633,1.007434},{0.351061,0.481579,1.020068,1.701112,0.481540,0.351067,1.701122,1.020070},{0.380882,0.599637,1.029728,1.655103,0.599599,0.380888,1.655007,1.029731},{0.420566,0.729634,1.036853,1.600236,0.729596,0.420571,1.600244,1.036858},{0.465293,0.865162,1.042909,1.538116,0.865125,0.465297,1.538124,1.042914},{0.511940,1.000374,1.048554,1.470629,1.000337,0.511944,1.470637,1.048559},{0.557279,1.131156,1.055333,1.398920,1.131119,0.557283,1.398928,1.055337},{0.600386,1.255854,1.063832,1.325112,1.255818,0.600389,1.325120,1.063836},{0.640101,1.373141,1.075086,1.250646,1.373105,0.640104,1.250653,1.075090},{0.676737,1.483559,1.089677,1.177967,1.483523,0.676739,1.177974,1.089680},{0.709999,1.587140,1.107351,1.108953,1.587104,0.710001,1.108985,1.107354},{0.740571,1.684942,1.128191,1.045846,1.684906,0.740573,1.045853,1.128193},{0.768396,1.777287,1.151433,0.990034,1.777252,0.768398,0.990041,1.151449},{0.794181,1.865205,1.176224,0.942517,1.865170,0.794182,0.942523,1.176226},{0.818101,1.948981,1.201952,0.904425,1.948946,0.818102,0.904432,1.201953},{0.839927,2.029193,1.228159,0.876733,2.029158,0.839928,0.876739,1.228160},{0.840027,2.029093,1.228259,0.876633,2.029058,0.840028,0.876639,1.228159},{0.840784,2.031811,1.229372,0.875867,2.031776,0.840785,0.875869,1.229293},{0.841390,2.034711,1.230358,0.875010,2.034676,0.841391,0.875016,1.230258},{0.841986,2.037422,1.231345,0.874240,2.037388,0.841987,0.874243,1.231305},{0.842753,2.040316,1.232460,0.873394,2.040281,0.842754,0.873400,1.232360},{0.843348,2.043020,1.233450,0.872627,2.042985,0.843349,0.872630,1.233409},{0.844114,2.045907,1.234566,0.871784,2.045872,0.844115,0.871791,1.234466},{0.844709,2.048604,1.235558,0.871021,2.048570,0.844710,0.871024,1.235518},{0.845474,2.051485,1.236676,0.870181,2.051450,0.845475,0.870188,1.236576},{0.846069,2.054176,1.237669,0.869422,2.054142,0.846069,0.869424,1.237629},{0.846834,2.057050,1.238789,0.868585,2.057016,0.846834,0.868592,1.238689},{0.847427,2.059735,1.239784,0.867829,2.059701,0.847428,0.867832,1.239745},{0.848192,2.062603,1.240905,0.866996,2.062568,0.848193,0.867002,1.240805},{0.848785,2.065281,1.241903,0.866243,2.065247,0.848786,0.866246,1.241863},{0.849549,2.068142,1.243025,0.865413,2.068107,0.849550,0.865419,1.242925},{0.850142,2.070814,1.244025,0.864664,2.070780,0.850143,0.864667,1.243985},{0.850905,2.073668,1.245148,0.863837,2.073634,0.850906,0.863844,1.245048},{0.851498,2.076334,1.246150,0.863092,2.076300,0.851498,0.863095,1.246111},{0.852260,2.079182,1.247274,0.862268,2.079147,0.852261,0.862274,1.247174},{0.852852,2.081841,1.248277,0.861527,2.081807,0.852853,0.861529,1.248236},{0.853614,2.084683,1.249404,0.860706,2.084648,0.853615,0.860712,1.249304},{0.853514,2.084583,1.249304,0.860606,2.084548,0.853515,0.860612,1.249286},{0.865081,2.146565,1.125639,0.814393,2.146531,0.865082,0.814400,1.125622},{0.858847,2.170244,0.998816,0.761381,2.170211,0.858848,0.761388,0.998799},{0.838996,2.164239,0.867548,0.700631,2.164206,0.838997,0.700639,0.867531},{0.807450,2.131612,0.733574,0.632462,2.131580,0.807451,0.632470,0.733557},{0.765781,2.073027,0.599712,0.559885,2.073047,0.765781,0.559893,0.599696},{0.715068,1.989149,0.472533,0.489464,1.989117,0.715067,0.489473,0.472518},{0.657371,1.880361,0.359828,0.431822,1.880330,0.657414,0.431832,0.359813},{0.594249,1.748407,0.269255,0.397188,1.748376,0.594246,0.397198,0.269240},{0.527285,1.593922,0.205683,0.394319,1.593892,0.527237,0.394331,0.205669},{0.460485,1.422441,0.171886,0.428114,1.422412,0.460388,0.428128,0.171872},{0.399695,1.243221,0.170355,0.502165,1.243192,0.399599,0.502179,0.170343},{0.349491,1.063851,0.200114,0.611814,1.063823,0.349392,0.611827,0.200102},{0.311725,0.888446,0.257601,0.749150,0.888481,0.311628,0.749163,0.257590},{0.288297,0.721839,0.334882,0.899547,0.721936,0.288198,0.899560,0.334871},{0.279791,0.569930,0.421574,1.048906,0.570027,0.279693,1.048918,0.421563},{0.286686,0.437951,0.511224,1.189075,0.438049,0.286587,1.189088,0.511214},{0.308171,0.331721,0.598926,1.316163,0.331820,0.308073,1.316175,0.598916},{0.344118,0.255882,0.682841,1.430585,0.255982,0.344020,1.430597,0.682832},{0.393365,0.215163,0.762928,1.533217,0.215262,0.393266,1.533229,0.762919},{0.456680,0.215120,0.837693,1.625613,0.215219,0.456580,1.625624,0.837684}};
// float vel[TIMESTEPS][MOTORS] = {{15.208288,5.196631,14.856636,17.943012,5.196727,15.208387,17.942915,14.856657},{15.219876,5.214287,14.852277,17.908215,5.214312,15.219862,17.908171,14.852279},{15.229264,5.229532,14.847982,17.875181,5.229534,15.229234,17.875157,14.847983},{15.236333,5.241885,14.843530,17.843828,5.241900,15.236301,17.843811,14.843526},{15.243243,5.254293,14.839175,17.812726,5.254300,15.243222,17.812711,14.839173},{15.250185,5.266646,14.834690,17.781559,5.266665,15.250159,17.781543,14.834686},{15.256966,5.279047,14.830306,17.750640,5.279065,15.256959,17.750623,14.830302},{15.263789,5.291399,14.825791,17.719654,5.291420,15.263765,17.719638,14.825785},{15.270449,5.303791,14.821378,17.688917,5.303810,15.270443,17.688900,14.821372},{15.277156,5.316127,14.816833,17.658111,5.316147,15.277129,17.658095,14.816826},{15.283696,5.328506,14.812393,17.627555,5.328523,15.283685,17.627540,14.812384},{15.290279,5.340831,14.807821,17.596932,5.340852,15.290250,17.596917,14.807811},{15.296697,5.353204,14.803355,17.566559,5.353218,15.296681,17.566545,14.803343},{15.303156,5.365523,14.798756,17.536120,5.365543,15.303124,17.536106,14.798746},{15.309452,5.377893,14.794264,17.505931,5.377902,15.309429,17.505919,14.794254},{15.315786,5.390205,14.789640,17.475674,5.390222,15.315750,17.475665,14.789633},{15.321962,5.402575,14.785123,17.445668,5.402573,15.321927,17.445664,14.785121},{15.328168,5.414881,14.780476,17.415595,5.414893,15.328126,17.415597,14.780477},{15.334214,5.427248,14.775944,17.385780,5.427242,15.334183,17.385775,14.775937},{15.340021,5.439183,14.771269,17.356125,5.439205,15.339998,17.356093,14.771242},{15.347205,5.453313,14.766847,17.325431,5.453413,15.347304,17.325359,14.766749},{-19.673651,-9.046189,9.614278,17.211650,-9.046089,-19.673551,17.211623,9.614376},{-14.545107,-1.519314,7.767744,9.739048,-1.519389,-14.545206,9.738982,7.767720},{-9.772452,5.273335,6.352611,3.968632,5.273312,-9.772371,3.968550,6.352547},{-6.014181,10.514746,5.396396,-0.179676,10.514845,-6.014279,-0.179764,5.396345},{-1.989448,16.080142,4.466648,-3.856989,16.080241,-1.989460,-3.857063,4.466596},{2.108394,21.709637,3.499284,-7.134030,21.709664,2.108296,-7.134095,3.499203},{5.707638,26.587177,2.677460,-9.937867,26.587276,5.707737,-9.937953,2.677394},{8.598003,30.369536,2.009803,-12.287837,30.369635,8.597904,-12.287931,2.009754},{10.393881,32.474358,1.544800,-14.228296,32.474458,10.393782,-14.228381,1.544707},{11.195537,33.037770,1.363396,-15.765808,33.037868,11.195438,-15.765896,1.363307},{11.228281,32.417733,1.441862,-16.928201,32.417820,11.228193,-16.928297,1.441764},{10.749230,31.038398,1.807177,-17.705665,31.038451,10.749133,-17.705762,1.807084},{10.048712,29.369953,2.372152,-18.043249,29.370031,10.048621,-18.043331,2.372056},{9.241858,27.605630,3.115350,-17.915821,27.605729,9.241759,-17.915805,3.115259},{8.458544,25.941672,3.896688,-17.272711,25.941771,8.458444,-17.272656,3.896601},{7.713256,24.399932,4.678399,-16.069114,24.400015,7.713158,-16.069212,4.678305},{7.056583,23.042253,5.336806,-14.499892,23.042310,7.056496,-14.499793,5.336904},{6.475851,21.844653,5.841245,-12.555375,21.844664,6.475752,-12.555475,5.841145},{5.969950,20.797958,6.170448,-10.380347,20.797966,5.969881,-10.380247,6.170548},{5.546991,19.902005,6.260377,-8.041681,19.902052,5.546991,-8.041781,6.260277},{5.050813,18.972803,6.499525,-5.239572,18.972753,5.050738,-5.239472,6.499625},{4.785155,18.708782,6.524463,-4.988881,18.708777,4.785076,-4.988783,6.524547},{4.782772,18.685883,6.531585,-4.977229,18.685926,4.782778,-4.977229,6.531581},{4.780763,18.663694,6.538027,-4.965855,18.663749,4.780786,-4.965880,6.538011},{4.778924,18.641993,6.543955,-4.955024,18.642049,4.778953,-4.955050,6.543923},{4.777209,18.620494,6.549730,-4.944062,18.620547,4.777240,-4.944088,6.549695},{4.775402,18.598905,6.555572,-4.933205,18.598957,4.775429,-4.933226,6.555537},{4.773716,18.577519,6.561262,-4.922215,18.577565,4.773739,-4.922229,6.561232},{4.771929,18.556039,6.567021,-4.911319,18.556090,4.771953,-4.911336,6.566988},{4.770268,18.534765,6.572628,-4.900294,18.534810,4.770290,-4.900307,6.572601},{4.768508,18.513396,6.578306,-4.889365,18.513447,4.768534,-4.889384,6.578272},{4.766874,18.492232,6.583832,-4.878308,18.492279,4.766900,-4.878324,6.583805},{4.765143,18.470975,6.589432,-4.867351,18.471027,4.765170,-4.867371,6.589395},{4.763534,18.449921,6.594878,-4.856264,18.449971,4.763564,-4.856283,6.594849},{4.761829,18.428774,6.600398,-4.845279,18.428828,4.761858,-4.845301,6.600359},{4.760245,18.407831,6.605764,-4.834164,18.407881,4.760275,-4.834184,6.605732},{4.758564,18.386794,6.611203,-4.823150,18.386846,4.758591,-4.823171,6.611161},{4.757006,18.365961,6.616488,-4.812005,18.366006,4.757029,-4.812025,6.616454},{4.755349,18.345034,6.621847,-4.800963,18.345079,4.755368,-4.800984,6.621802},{4.753814,18.324307,6.627049,-4.789790,18.324348,4.753830,-4.789808,6.627014},{4.752206,18.303545,6.632320,-4.778728,18.303603,4.752236,-4.778747,6.632274},{4.750497,18.282574,6.637467,-4.767488,18.282660,4.750552,-4.767504,6.637437},{4.444696,17.389367,-25.378543,-9.012775,17.389466,4.444795,-9.012676,-25.378643},{0.422581,8.634837,-26.025995,-10.291638,8.634935,0.422541,-10.291541,-26.025896},{-2.872046,1.549230,-26.774947,-11.756252,1.549322,-2.872038,-11.756154,-26.774936},{-5.397138,-4.035490,-27.675041,-13.484422,-4.035402,-5.397184,-13.484324,-27.674969},{-7.650886,-9.434425,-27.983014,-14.757776,-9.434328,-7.650979,-14.757686,-27.982918},{-9.672593,-14.829387,-27.391745,-15.173740,-14.829294,-9.672677,-15.173656,-27.391647},{-11.327592,-20.020867,-25.287917,-13.778152,-20.020774,-11.327666,-13.778062,-25.287821},{-12.633791,-25.075078,-21.340449,-9.923380,-25.074980,-12.633878,-9.923282,-21.340351},{-13.537871,-29.734599,-16.170016,-4.130883,-29.734516,-13.537953,-4.130785,-16.169920},{-14.095548,-34.145246,-10.224690,3.071006,-34.145158,-14.095598,3.071070,-10.224591},{-13.552855,-36.882765,-3.709449,11.193847,-36.882669,-13.552946,11.193845,-3.709353},{-11.621591,-37.407862,3.008677,19.335505,-37.407764,-11.621620,19.335455,3.008769},{-9.235185,-37.027906,9.214824,26.075262,-37.027814,-9.235096,26.075217,9.214917},{-6.406997,-35.722082,14.349770,30.454783,-35.721987,-6.406930,30.454756,14.349864},{-3.357700,-33.288216,17.360078,31.588402,-33.288118,-3.357615,31.588371,17.360166},{-0.167567,-29.687963,18.507781,30.290433,-29.687867,-0.167535,30.290398,18.507875},{2.961213,-24.920178,18.507503,27.851708,-24.920125,2.961295,27.851662,18.507595},{5.974606,-19.086310,17.856988,25.076050,-19.086211,5.974629,25.075998,17.857079},{8.890534,-12.203544,17.016357,22.503369,-12.203447,8.890632,22.503316,17.016448},{11.603815,-4.485356,16.148690,20.251577,-4.485455,11.603716,20.251516,16.148766},{14.821626,4.789595,14.886701,18.165096,4.789694,14.821724,18.164999,14.886672}};
// float u[TIMESTEPS][MOTORS] = {{0.027944,0.050509,0.003497,-0.078196,0.050370,0.027739,-0.077946,0.003404},{0.027944,0.050509,0.003497,-0.078196,0.050370,0.027739,-0.077946,0.003404},{0.018139,0.037314,-0.000478,-0.061631,0.037318,0.018150,-0.061601,-0.000490},{0.018139,0.037314,-0.000478,-0.061631,0.037318,0.018150,-0.061601,-0.000490},{0.017846,0.037398,-0.000645,-0.061446,0.037416,0.017866,-0.061453,-0.000650},{0.017846,0.037398,-0.000645,-0.061446,0.037416,0.017866,-0.061453,-0.000650},{0.017573,0.037493,-0.000809,-0.061284,0.037500,0.017571,-0.061282,-0.000817},{0.017573,0.037493,-0.000809,-0.061284,0.037500,0.017571,-0.061282,-0.000817},{0.017313,0.037551,-0.000971,-0.061130,0.037552,0.017302,-0.061125,-0.000980},{0.017313,0.037551,-0.000971,-0.061130,0.037552,0.017302,-0.061125,-0.000980},{0.017032,0.037633,-0.001132,-0.060961,0.037634,0.017021,-0.060959,-0.001141},{0.017032,0.037633,-0.001132,-0.060961,0.037634,0.017021,-0.060959,-0.001141},{0.016748,0.037729,-0.001293,-0.060794,0.037728,0.016734,-0.060790,-0.001297},{0.016748,0.037729,-0.001293,-0.060794,0.037728,0.016734,-0.060790,-0.001297},{0.016464,0.037830,-0.001458,-0.060630,0.037821,0.016444,-0.060614,-0.001445},{0.016464,0.037830,-0.001458,-0.060630,0.037821,0.016444,-0.060614,-0.001445},{0.016170,0.037944,-0.001615,-0.060463,0.037923,0.016149,-0.060438,-0.001593},{0.016170,0.037944,-0.001615,-0.060463,0.037923,0.016149,-0.060438,-0.001593},{0.015803,0.038008,-0.001668,-0.060210,0.038087,0.015922,-0.060345,-0.001842},{0.015803,0.038008,-0.001668,-0.060210,0.038087,0.015922,-0.060345,-0.001842},{0.022530,0.050145,0.002813,-0.074967,0.050609,0.022917,-0.075129,0.002386},{0.475327,1.004635,0.088394,-1.429723,1.004450,0.475345,-1.429720,0.088394},{0.475327,1.004635,0.088394,-1.429723,1.004450,0.475345,-1.429720,0.088394},{0.416919,0.588959,0.071719,-0.884466,0.588948,0.417099,-0.884479,0.071719},{0.416919,0.588959,0.071719,-0.884466,0.588948,0.417099,-0.884479,0.071719},{0.608574,0.617179,0.051746,-0.715272,0.616677,0.609503,-0.715243,0.051698},{0.608574,0.617179,0.051746,-0.715272,0.616677,0.609503,-0.715243,0.051698},{0.635705,0.650214,0.087966,-0.522686,0.648813,0.638125,-0.522684,0.087946},{0.635705,0.650214,0.087966,-0.522686,0.648813,0.638125,-0.522684,0.087946},{0.586071,0.558733,0.103929,-0.339051,0.559175,0.585751,-0.339039,0.103912},{0.586071,0.558733,0.103929,-0.339051,0.559175,0.585751,-0.339039,0.103912},{0.587817,0.332388,0.088181,-0.166216,0.332343,0.587782,-0.166194,0.088172},{0.587817,0.332388,0.088181,-0.166216,0.332343,0.587782,-0.166194,0.088172},{0.531683,0.173442,0.058883,0.008519,0.173477,0.531638,0.008534,0.058871},{0.531683,0.173442,0.058883,0.008519,0.173477,0.531638,0.008534,0.058871},{0.456774,0.097323,0.010557,0.186289,0.097402,0.456863,0.186260,0.010551},{0.456774,0.097323,0.010557,0.186289,0.097402,0.456863,0.186260,0.010551},{0.442195,0.077689,-0.041132,0.300445,0.077750,0.442294,0.300337,-0.041217},{0.442195,0.077689,-0.041132,0.300445,0.077750,0.442294,0.300337,-0.041217},{0.458745,0.072754,-0.083282,0.373905,0.072914,0.459191,0.373778,-0.083303},{0.458745,0.072754,-0.083282,0.373905,0.072914,0.459191,0.373778,-0.083303},{-0.122342,-0.102345,-0.057576,0.526528,-0.102873,-0.124185,0.526999,-0.056985},{-0.012823,-0.039704,0.006681,0.016192,-0.039546,-0.012480,0.015891,0.006482},{-0.012823,-0.039704,0.006681,0.016192,-0.039546,-0.012480,0.015891,0.006482},{-0.011213,-0.034422,0.003093,0.013682,-0.034426,-0.011181,0.013681,0.003043},{-0.011213,-0.034422,0.003093,0.013682,-0.034426,-0.011181,0.013681,0.003043},{-0.011089,-0.034336,0.002833,0.013844,-0.034353,-0.011113,0.013874,0.002839},{-0.011089,-0.034336,0.002833,0.013844,-0.034353,-0.011113,0.013874,0.002839},{-0.011020,-0.034255,0.002573,0.014063,-0.034257,-0.011026,0.014065,0.002583},{-0.011020,-0.034255,0.002573,0.014063,-0.034257,-0.011026,0.014065,0.002583},{-0.010918,-0.034177,0.002329,0.014260,-0.034170,-0.010910,0.014251,0.002332},{-0.010918,-0.034177,0.002329,0.014260,-0.034170,-0.010910,0.014251,0.002332},{-0.010820,-0.034096,0.002098,0.014435,-0.034086,-0.010808,0.014428,0.002096},{-0.010820,-0.034096,0.002098,0.014435,-0.034086,-0.010808,0.014428,0.002096},{-0.010729,-0.034014,0.001864,0.014609,-0.034006,-0.010725,0.014607,0.001859},{-0.010729,-0.034014,0.001864,0.014609,-0.034006,-0.010725,0.014607,0.001859},{-0.010637,-0.033929,0.001624,0.014786,-0.033936,-0.010655,0.014788,0.001619},{-0.010637,-0.033929,0.001624,0.014786,-0.033936,-0.010655,0.014788,0.001619},{-0.010546,-0.033847,0.001381,0.014965,-0.033872,-0.010589,0.014969,0.001379},{-0.010546,-0.033847,0.001381,0.014965,-0.033872,-0.010589,0.014969,0.001379},{-0.010532,-0.033841,0.001134,0.015144,-0.033736,-0.010448,0.015146,0.001140},{-0.010532,-0.033841,0.001134,0.015144,-0.033736,-0.010448,0.015146,0.001140},{-0.012053,-0.038235,0.000873,0.015743,-0.038020,-0.011932,0.015737,0.000886},{-0.416237,-1.458178,-0.120312,0.643618,-1.458149,-0.416231,0.642398,-0.119020},{-0.416237,-1.458178,-0.120312,0.643618,-1.458149,-0.416231,0.642398,-0.119020},{-0.257892,-0.952674,-0.053418,0.550479,-0.952661,-0.257892,0.550088,-0.053031},{-0.257892,-0.952674,-0.053418,0.550479,-0.952661,-0.257892,0.550088,-0.053031},{-0.181253,-0.795919,0.110632,0.709008,-0.795914,-0.181246,0.708790,0.110814},{-0.181253,-0.795919,0.110632,0.709008,-0.795914,-0.181246,0.708790,0.110814},{-0.080309,-0.568414,0.295004,0.877413,-0.568407,-0.080305,0.877412,0.294972},{-0.080309,-0.568414,0.295004,0.877413,-0.568407,-0.080305,0.877412,0.294972},{0.009736,-0.321245,0.369648,0.917528,-0.321250,0.009742,0.917562,0.369601},{0.009736,-0.321245,0.369648,0.917528,-0.321250,0.009742,0.917562,0.369601},{0.176844,0.153266,0.545920,0.957573,0.153266,0.176842,0.957422,0.546117},{0.176844,0.153266,0.545920,0.957573,0.153266,0.176842,0.957422,0.546117},{0.187169,0.299429,0.651003,0.978471,0.299435,0.187162,0.978519,0.651007},{0.187169,0.299429,0.651003,0.978471,0.299435,0.187162,0.978519,0.651007},{0.174218,0.447701,0.657047,0.686565,0.447698,0.174224,0.686577,0.657110},{0.174218,0.447701,0.657047,0.686565,0.447698,0.174224,0.686577,0.657110},{0.140453,0.600164,0.617593,0.322629,0.600167,0.140460,0.322632,0.617640},{0.140453,0.600164,0.617593,0.322629,0.600167,0.140460,0.322632,0.617640},{0.109012,0.764890,0.495281,0.156182,0.764868,0.108994,0.156158,0.495269},{0.109012,0.764890,0.495281,0.156182,0.764868,0.108994,0.156158,0.495269},{0.174828,1.033320,-0.177906,-0.211906,1.033442,0.174937,-0.211684,-0.178989}};
// float dfVec[TIMESTEPS][MOTORS] = {{0.122935,0.050002,0.115446,0.123339,0.049976,0.122895,0.123387,0.115428},{0.123024,0.050139,0.115412,0.123070,0.050112,0.122984,0.123119,0.115394},{0.121182,0.047681,0.114603,0.126049,0.047682,0.121184,0.126055,0.114600},{0.121237,0.047776,0.114568,0.125807,0.047777,0.121239,0.125813,0.114566},{0.121233,0.047888,0.114502,0.125603,0.047892,0.121237,0.125601,0.114501},{0.121287,0.047984,0.114468,0.125362,0.047987,0.121290,0.125361,0.114467},{0.121286,0.048098,0.114402,0.125155,0.048100,0.121286,0.125155,0.114400},{0.121339,0.048194,0.114367,0.124915,0.048195,0.121338,0.124916,0.114365},{0.121339,0.048301,0.114301,0.124708,0.048301,0.121337,0.124709,0.114299},{0.121391,0.048396,0.114266,0.124470,0.048396,0.121389,0.124471,0.114264},{0.121387,0.048508,0.114200,0.124267,0.048508,0.121385,0.124267,0.114198},{0.121438,0.048603,0.114165,0.124030,0.048603,0.121435,0.124031,0.114163},{0.121432,0.048717,0.114099,0.123828,0.048717,0.121429,0.123829,0.114098},{0.121482,0.048812,0.114063,0.123593,0.048812,0.121479,0.123594,0.114063},{0.121475,0.048928,0.113996,0.123392,0.048926,0.121471,0.123395,0.113999},{0.121524,0.049023,0.113961,0.123158,0.049021,0.121520,0.123161,0.113963},{0.121514,0.049141,0.113895,0.122959,0.049136,0.121510,0.122964,0.113900},{0.121562,0.049236,0.113859,0.122727,0.049232,0.121558,0.122732,0.113864},{0.121537,0.049344,0.113814,0.122546,0.049359,0.121560,0.122520,0.113780},{0.121582,0.049436,0.113778,0.122317,0.049451,0.121605,0.122290,0.113744},{0.122951,0.051914,0.114618,0.119199,0.052006,0.123027,0.119167,0.114534},{-0.059182,0.126240,0.091523,-0.146148,0.126205,-0.059178,-0.146148,0.091524},{-0.019566,0.184383,0.077259,-0.203872,0.184347,-0.019563,-0.203872,0.077259},{0.005899,0.155708,0.063073,-0.142004,0.155706,0.005935,-0.142008,0.063072},{0.034931,0.196197,0.055686,-0.174049,0.196195,0.034965,-0.174052,0.055686},{0.103435,0.244697,0.044605,-0.169426,0.244599,0.103616,-0.169421,0.044595},{0.135089,0.288183,0.037133,-0.194740,0.288085,0.135270,-0.194735,0.037122},{0.168189,0.332309,0.037855,-0.178803,0.332036,0.168662,-0.178803,0.037850},{0.190516,0.361527,0.032697,-0.196956,0.361254,0.190988,-0.196956,0.032693},{0.194699,0.359927,0.032222,-0.176097,0.360015,0.194636,-0.176095,0.032217},{0.200892,0.364280,0.030820,-0.187974,0.364367,0.200828,-0.187972,0.030816},{0.201485,0.315304,0.028352,-0.163213,0.315296,0.201478,-0.163209,0.028350},{0.197785,0.304649,0.031174,-0.169219,0.304641,0.197777,-0.169215,0.031172},{0.181416,0.260732,0.029819,-0.137716,0.260740,0.181406,-0.137713,0.029816},{0.175183,0.247104,0.035560,-0.136731,0.247111,0.175173,-0.136728,0.035557},{0.154509,0.219390,0.032162,-0.097060,0.219407,0.154525,-0.097065,0.032160},{0.148752,0.207481,0.038200,-0.087763,0.207497,0.148768,-0.087769,0.038198},{0.140833,0.193160,0.033196,-0.053356,0.193173,0.140852,-0.053376,0.033180},{0.136347,0.183909,0.037092,-0.038335,0.183921,0.136365,-0.038357,0.037075},{0.135670,0.174861,0.031407,-0.007193,0.174892,0.135756,-0.007217,0.031404},{0.132402,0.167940,0.032102,0.010872,0.167971,0.132490,0.010847,0.032097},{0.015133,0.126580,0.038967,0.062312,0.126476,0.014773,0.062405,0.039083},{0.034461,0.136769,0.051704,-0.035377,0.136800,0.034527,-0.035435,0.051666},{0.034442,0.136592,0.051759,-0.035287,0.136623,0.034509,-0.035345,0.051720},{0.034741,0.137452,0.051108,-0.035689,0.137451,0.034747,-0.035689,0.051098},{0.034727,0.137284,0.051154,-0.035605,0.137284,0.034733,-0.035605,0.051144},{0.034738,0.137135,0.051148,-0.035489,0.137132,0.034733,-0.035483,0.051149},{0.034724,0.136968,0.051193,-0.035405,0.136965,0.034719,-0.035399,0.051194},{0.034724,0.136819,0.051186,-0.035277,0.136819,0.034723,-0.035277,0.051188},{0.034710,0.136653,0.051231,-0.035193,0.136653,0.034709,-0.035193,0.051232},{0.034717,0.136504,0.051226,-0.035070,0.136505,0.034719,-0.035071,0.051227},{0.034704,0.136339,0.051270,-0.034985,0.136340,0.034706,-0.034987,0.051270},{0.034710,0.136191,0.051268,-0.034865,0.136193,0.034713,-0.034867,0.051267},{0.034697,0.136027,0.051311,-0.034781,0.136029,0.034700,-0.034782,0.051310},{0.034702,0.135880,0.051307,-0.034661,0.135882,0.034703,-0.034662,0.051306},{0.034689,0.135717,0.051350,-0.034576,0.135719,0.034690,-0.034577,0.051349},{0.034695,0.135571,0.051345,-0.034456,0.135570,0.034692,-0.034456,0.051343},{0.034682,0.135409,0.051387,-0.034371,0.135408,0.034679,-0.034371,0.051385},{0.034688,0.135264,0.051380,-0.034250,0.135259,0.034680,-0.034249,0.051379},{0.034675,0.135102,0.051421,-0.034165,0.135098,0.034667,-0.034164,0.051421},{0.034666,0.134944,0.051413,-0.034043,0.134964,0.034682,-0.034043,0.051414},{0.034653,0.134783,0.051454,-0.033958,0.134804,0.034670,-0.033958,0.051455},{0.034343,0.133763,0.051443,-0.033754,0.133806,0.034367,-0.033755,0.051445},{-0.046922,-0.150330,-0.219528,0.056023,-0.150324,-0.046920,0.055785,-0.219277},{-0.077991,-0.217956,-0.224530,0.046144,-0.217950,-0.077990,0.045906,-0.224277},{-0.072530,-0.174009,-0.217256,0.016648,-0.174005,-0.072530,0.016572,-0.217181},{-0.092036,-0.217149,-0.224209,0.003298,-0.217146,-0.092036,0.003223,-0.224133},{-0.094484,-0.228253,-0.194563,0.024409,-0.228251,-0.094483,0.024368,-0.194527},{-0.110101,-0.269928,-0.189996,0.021196,-0.269926,-0.110100,0.021154,-0.189960},{-0.103180,-0.265618,-0.137752,0.064852,-0.265616,-0.103179,0.064852,-0.137758},{-0.113270,-0.304660,-0.107259,0.094629,-0.304658,-0.113270,0.094629,-0.107265},{-0.102675,-0.292402,-0.052748,0.147205,-0.292403,-0.102675,0.147212,-0.052756},{-0.106983,-0.326473,-0.006822,0.202838,-0.326474,-0.106982,0.202845,-0.006830},{-0.070169,-0.254988,0.077917,0.273401,-0.254988,-0.070170,0.273372,0.077956},{-0.055251,-0.259045,0.129813,0.336293,-0.259044,-0.055251,0.336263,0.129852},{-0.034801,-0.227576,0.198267,0.392435,-0.227575,-0.034802,0.392444,0.198269},{-0.012954,-0.217489,0.237933,0.426266,-0.217487,-0.012955,0.426275,0.237935},{0.008073,-0.169743,0.262367,0.378038,-0.169743,0.008075,0.378040,0.262380},{0.032716,-0.141933,0.271232,0.368012,-0.141933,0.032717,0.368014,0.271245},{0.050293,-0.075340,0.263528,0.278128,-0.075339,0.050295,0.278128,0.263538},{0.073570,-0.030275,0.258503,0.256687,-0.030274,0.073572,0.256687,0.258513},{0.089957,0.055049,0.228132,0.204321,0.055046,0.089955,0.204316,0.228131},{0.110917,0.114670,0.221430,0.186926,0.114665,0.110912,0.186921,0.221428},{0.148622,0.238717,0.080265,0.098953,0.238742,0.148644,0.098995,0.080054}};
// float times[TIMESTEPS] = {0.000000,0.000151,0.000303,0.000454,0.000605,0.000757,0.000908,0.001059,0.001211,0.001362,0.001513,0.001665,0.001816,0.001967,0.002119,0.002270,0.002421,0.002573,0.002724,0.002875,0.003027,0.003027,0.007150,0.011274,0.015397,0.019521,0.023645,0.027768,0.031892,0.036015,0.040139,0.044262,0.048386,0.052510,0.056633,0.060757,0.064880,0.069004,0.073127,0.077251,0.081374,0.085498,0.085498,0.085651,0.085804,0.085957,0.086110,0.086263,0.086416,0.086569,0.086722,0.086875,0.087028,0.087181,0.087334,0.087487,0.087640,0.087793,0.087946,0.088099,0.088252,0.088405,0.088558,0.088558,0.093369,0.098180,0.102991,0.107802,0.112613,0.117424,0.122235,0.127046,0.131857,0.136669,0.141480,0.146291,0.151102,0.155913,0.160724,0.165535,0.170346,0.175157,0.179968,0.184779};

// float times[TIMESTEPS] = {0.000000,0.004694,0.009388,0.014082,0.018776,0.023469,0.028163,0.032857,0.037551,0.042245,0.046939,0.051633,0.056327,0.061021,0.065715,0.070408,0.075102,0.079796,0.084490,0.089184,0.093878,0.093878,0.098532,0.103187,0.107841,0.112495,0.117150,0.121804,0.126458,0.131113,0.135767,0.140421,0.145076,0.149730,0.154384,0.159039,0.163693,0.168347,0.173002,0.177656,0.182310,0.186965};
// float pos[TIMESTEPS][MOTORS] = {{0.839919,1.920361,0.732173,0.658240,1.920368,0.839922,0.658283,0.732175},{0.847062,1.967248,0.616975,0.599979,1.967256,0.847065,0.600022,0.616960},{0.835239,1.976747,0.507375,0.542520,1.976755,0.835242,0.542563,0.507378},{0.809738,1.956933,0.404917,0.489036,1.956942,0.809742,0.489079,0.404920},{0.773680,1.913042,0.313945,0.444744,1.913051,0.773685,0.444786,0.313947},{0.729766,1.847278,0.239318,0.417387,1.847288,0.729771,0.417407,0.239319},{0.681518,1.763254,0.186237,0.413763,1.763264,0.681524,0.413762,0.186238},{0.633017,1.664882,0.159028,0.440972,1.664892,0.633019,0.440971,0.159029},{0.587950,1.555364,0.159308,0.500548,1.555375,0.587949,0.500547,0.159310},{0.548535,1.435901,0.188002,0.591733,1.435911,0.548530,0.591733,0.188004},{0.516791,1.308731,0.240335,0.705739,1.308740,0.516783,0.705739,0.240338},{0.493331,1.175871,0.309551,0.831294,1.175880,0.493322,0.831295,0.309554},{0.479189,1.040592,0.387777,0.957785,1.040602,0.479180,0.957786,0.387779},{0.474368,0.907444,0.468653,1.077464,0.907455,0.474359,1.077465,0.468655},{0.479005,0.781043,0.548156,1.187665,0.781054,0.478995,1.187667,0.548159},{0.492073,0.667281,0.624415,1.287011,0.667293,0.492063,1.287013,0.624418},{0.512745,0.569533,0.696590,1.376771,0.569544,0.512734,1.376773,0.696594},{0.539281,0.490414,0.765217,1.458107,0.490426,0.539269,1.458109,0.765221},{0.569900,0.432277,0.830687,1.531929,0.432290,0.569888,1.531932,0.830691},{0.602681,0.397808,0.892900,1.599689,0.397820,0.602669,1.599692,0.892906},{0.638072,0.392489,0.951485,1.661477,0.392502,0.638059,1.661479,0.951490},{0.637972,0.392389,0.951585,1.661377,0.392402,0.637969,1.661379,0.951590},{0.547510,0.324699,0.974320,1.699454,0.324707,0.547508,1.699457,0.974326},{0.468089,0.276122,0.970324,1.704942,0.276124,0.468087,1.704945,0.970329},{0.401801,0.249355,0.948334,1.686660,0.249357,0.401799,1.686663,0.948339},{0.352248,0.247752,0.913567,1.649899,0.247753,0.352247,1.649903,0.913572},{0.323133,0.276867,0.870369,1.596699,0.276868,0.323132,1.596707,0.870374},{0.316890,0.338674,0.821750,1.529589,0.338675,0.316890,1.529602,0.821755},{0.334321,0.434822,0.771170,1.450406,0.434824,0.334321,1.450472,0.771174},{0.371592,0.558339,0.721192,1.361611,0.558341,0.371592,1.361648,0.721196},{0.421330,0.698620,0.675800,1.266459,0.698623,0.421329,1.266496,0.675796},{0.476288,0.844443,0.637489,1.167826,0.844446,0.476287,1.167864,0.637477},{0.530738,0.986704,0.608966,1.069398,0.986708,0.530737,1.069436,0.608954},{0.581539,1.121560,0.592178,0.974339,1.121564,0.581538,0.974377,0.592165},{0.627796,1.246866,0.588080,0.886864,1.246870,0.627795,0.886903,0.588066},{0.669090,1.363297,0.596115,0.809652,1.363302,0.669090,0.809692,0.596101},{0.706001,1.471330,0.613300,0.745701,1.471335,0.706002,0.745741,0.613286},{0.739179,1.572331,0.637056,0.696094,1.572337,0.739180,0.696135,0.637041},{0.768670,1.666849,0.663982,0.661808,1.666856,0.768672,0.661849,0.663966},{0.795221,1.756067,0.691208,0.643259,1.756074,0.795223,0.643300,0.691193},{0.818816,1.840375,0.715059,0.641552,1.840382,0.818818,0.641594,0.715042},{0.839819,1.920461,0.732273,0.658340,1.920468,0.839822,0.658383,0.732256}};
// float vel[TIMESTEPS][MOTORS] = {{3.847707,14.621457,-24.953170,-12.334988,14.621555,3.847744,-12.334888,-24.953142},{-0.656731,5.718647,-24.036773,-12.445254,5.718747,-0.656651,-12.445197,-24.036763},{-4.148032,-1.394402,-22.637954,-11.908124,-1.394302,-4.147932,-11.908121,-22.637973},{-6.642662,-6.879627,-20.805808,-10.685171,-6.879534,-6.642563,-10.685248,-20.805874},{-8.561277,-11.738670,-17.829404,-7.906498,-11.738570,-8.561177,-7.906598,-17.829480},{-9.946256,-16.081796,-13.780596,-3.562332,-16.081697,-9.946156,-3.562432,-13.780696},{-10.493010,-19.604374,-8.733947,2.291078,-19.604274,-10.492923,2.291026,-8.734012},{-10.033733,-22.190319,-2.901246,9.268046,-22.190219,-10.033681,9.268090,-2.901194},{-9.114582,-24.438714,3.063914,16.167491,-24.438616,-9.114582,16.167568,3.064014},{-7.624473,-26.347043,8.859398,22.265859,-26.346943,-7.624539,22.265959,8.859497},{-5.930858,-27.807710,13.221398,25.976032,-27.807610,-5.930958,25.976132,13.221445},{-4.030079,-28.719683,15.950824,27.179551,-28.719589,-4.030179,27.179651,15.950821},{-2.045474,-28.752754,17.145580,26.459828,-28.752668,-2.045574,26.459928,17.145589},{-0.008751,-27.818875,17.161779,24.547555,-27.818792,-0.008851,24.547639,17.161829},{1.899185,-25.792950,16.646376,22.336496,-25.792850,1.899085,22.336563,16.646461},{3.636748,-22.610090,15.791469,20.105856,-22.610030,3.636648,20.105899,15.791566},{5.053894,-18.884975,14.991727,18.167059,-18.884937,5.053794,18.167096,14.991827},{6.133068,-14.728754,14.272103,16.502941,-14.728654,6.132969,16.502976,14.272203},{6.879102,-9.859813,13.561128,15.050820,-9.859713,6.879002,15.050844,13.561228},{7.137956,-4.538046,12.912717,13.804929,-4.538009,7.137856,13.804950,12.912817},{8.076010,2.646131,11.929456,12.590935,2.646039,8.075910,12.590943,11.929537},{-20.349356,-16.387096,8.294175,12.383010,-16.387196,-20.349266,12.383001,8.294275},{-18.381038,-12.632503,1.738792,4.367243,-12.632603,-18.380949,4.367308,1.738765},{-15.690783,-8.088330,-3.106539,-1.707257,-8.088430,-15.690705,-1.707157,-3.106599},{-12.613795,-3.236062,-6.225223,-5.993256,-3.236162,-12.613695,-5.993156,-6.225323},{-8.585199,2.810728,-8.511107,-9.733880,2.810661,-8.585099,-9.733781,-8.511047},{-3.856787,9.728466,-9.962787,-12.987881,9.728505,-3.856687,-12.987781,-9.962886},{1.157668,16.944525,-10.754762,-15.796958,16.944625,1.157724,-15.796858,-10.754862},{6.109888,23.979134,-10.896547,-18.133508,23.979234,6.109848,-18.133408,-10.896595},{9.597173,28.790915,-10.410375,-19.876482,28.791015,9.597075,-19.876389,-10.410384},{11.473630,31.106646,-9.080967,-20.919696,31.106736,11.473530,-20.919596,-9.080991},{11.926504,31.258264,-7.281680,-21.286395,31.258364,11.926452,-21.286295,-7.281731},{11.351402,29.858650,-4.915877,-20.902722,29.858750,11.351443,-20.902628,-4.915963},{10.444120,27.989930,-2.325001,-19.752544,27.990020,10.444220,-19.752444,-2.325101},{9.381386,25.949640,0.498713,-17.769165,25.949729,9.381486,-17.769068,0.498613},{8.397546,24.090693,2.802996,-15.256692,24.090786,8.397646,-15.256592,2.802896},{7.501982,22.431208,4.495261,-12.216733,22.431307,7.502082,-12.216633,4.495161},{6.707050,20.983568,5.540347,-9.007134,20.983664,6.707150,-9.007037,5.540247},{5.998326,19.722601,5.929071,-5.706195,19.722687,5.998425,-5.706095,5.928973},{5.357712,18.619926,5.583597,-2.159158,18.620002,5.357810,-2.159060,5.583497},{4.791352,17.671584,4.500578,1.517548,17.671654,4.791448,1.517648,4.500478},{4.158292,16.719912,2.817930,5.874530,16.719969,4.158374,5.874430,2.817830}};
// float u[TIMESTEPS][MOTORS] = {{-0.496401,-1.367531,-0.111486,0.849046,-1.367520,-0.496400,0.849024,-0.111432},{-0.496401,-1.367531,-0.111486,0.849046,-1.367520,-0.496400,0.849024,-0.111432},{-0.249209,-0.840170,-0.003959,0.729056,-0.840168,-0.249214,0.729078,-0.003934},{-0.249209,-0.840170,-0.003959,0.729056,-0.840168,-0.249214,0.729078,-0.003934},{-0.077307,-0.575252,0.211762,0.780318,-0.575253,-0.077316,0.780385,0.211755},{-0.077307,-0.575252,0.211762,0.780318,-0.575253,-0.077316,0.780385,0.211755},{0.138070,-0.256015,0.409213,0.879071,-0.256014,0.138052,0.879175,0.409214},{0.138070,-0.256015,0.409213,0.879071,-0.256014,0.138052,0.879175,0.409214},{0.206614,-0.101566,0.630468,0.821326,-0.101565,0.206603,0.821385,0.630501},{0.206614,-0.101566,0.630468,0.821326,-0.101565,0.206603,0.821385,0.630501},{0.183450,0.048362,0.800482,0.457440,0.048361,0.183454,0.457449,0.800517},{0.183450,0.048362,0.800482,0.457440,0.048361,0.183454,0.457449,0.800517},{0.137516,0.214336,0.719571,0.164132,0.214335,0.137516,0.164137,0.719632},{0.137516,0.214336,0.719571,0.164132,0.214335,0.137516,0.164137,0.719632},{0.066320,0.396032,0.568977,0.051235,0.396035,0.066316,0.051251,0.569022},{0.066320,0.396032,0.568977,0.051235,0.396035,0.066316,0.051251,0.569022},{-0.005002,0.478744,0.558653,0.047675,0.478750,-0.005012,0.047701,0.558688},{-0.005002,0.478744,0.558653,0.047675,0.478750,-0.005012,0.047701,0.558688},{-0.084899,0.618840,0.477278,0.022342,0.618841,-0.084919,0.022362,0.477320},{-0.084899,0.618840,0.477278,0.022342,0.618841,-0.084919,0.022362,0.477320},{-0.005567,0.969283,-0.145011,-0.145952,0.969278,-0.005592,-0.145955,-0.145012},{0.078275,0.880749,-0.632230,-1.245806,0.880733,0.078272,-1.245794,-0.632247},{0.078275,0.880749,-0.632230,-1.245806,0.880733,0.078272,-1.245794,-0.632247},{0.216502,0.698774,-0.231624,-0.712537,0.698782,0.216492,-0.712541,-0.231605},{0.216502,0.698774,-0.231624,-0.712537,0.698782,0.216492,-0.712541,-0.231605},{0.396428,0.787694,0.009319,-0.511327,0.787714,0.396424,-0.511329,0.009302},{0.396428,0.787694,0.009319,-0.511327,0.787714,0.396424,-0.511329,0.009302},{0.666633,0.794841,0.193696,-0.327350,0.794824,0.666619,-0.327346,0.193699},{0.666633,0.794841,0.193696,-0.327350,0.794824,0.666619,-0.327346,0.193699},{0.891521,0.433130,0.303656,-0.133970,0.433113,0.891522,-0.133966,0.303652},{0.891521,0.433130,0.303656,-0.133970,0.433113,0.891522,-0.133966,0.303652},{0.819635,0.126008,0.293818,0.040340,0.126021,0.819775,0.040337,0.293811},{0.819635,0.126008,0.293818,0.040340,0.126021,0.819775,0.040337,0.293811},{0.671064,0.026409,0.243246,0.202680,0.026424,0.671146,0.202678,0.243248},{0.671064,0.026409,0.243246,0.202680,0.026424,0.671146,0.202678,0.243248},{0.595615,0.006532,0.089840,0.320159,0.006547,0.595696,0.320159,0.089842},{0.595615,0.006532,0.089840,0.320159,0.006547,0.595696,0.320159,0.089842},{0.541055,0.004554,-0.045037,0.370581,0.004555,0.541090,0.370583,-0.045037},{0.541055,0.004554,-0.045037,0.370581,0.004555,0.541090,0.370583,-0.045037},{0.459932,-0.004800,-0.201932,0.463965,-0.004793,0.459995,0.463972,-0.201938},{0.459932,-0.004800,-0.201932,0.463965,-0.004793,0.459995,0.463972,-0.201938},{-0.123202,-0.106858,-0.374436,0.681349,-0.106859,-0.123203,0.681319,-0.374444}};
// float dfVec[TIMESTEPS][MOTORS] = {{-0.067182,-0.154016,-0.214519,0.070462,-0.154013,-0.067182,0.070459,-0.214509},{-0.101978,-0.222787,-0.207441,0.069610,-0.222784,-0.101977,0.069607,-0.207430},{-0.080692,-0.174785,-0.175644,0.050336,-0.174784,-0.080692,0.050340,-0.175639},{-0.099962,-0.217157,-0.161491,0.059783,-0.217156,-0.099962,0.059786,-0.161487},{-0.081225,-0.202975,-0.096388,0.091254,-0.202975,-0.081226,0.091267,-0.096390},{-0.091923,-0.236525,-0.065112,0.124812,-0.236524,-0.091924,0.124824,-0.065114},{-0.054102,-0.201416,0.012417,0.189305,-0.201415,-0.054105,0.189325,0.012417},{-0.050554,-0.221391,0.057473,0.243200,-0.221390,-0.050557,0.243221,0.057474},{-0.030073,-0.208609,0.146744,0.285224,-0.208608,-0.030076,0.285236,0.146752},{-0.018563,-0.223350,0.191513,0.332332,-0.223349,-0.018565,0.332344,0.191520},{-0.010002,-0.205365,0.258397,0.289956,-0.205365,-0.010002,0.289958,0.258404},{0.004681,-0.212410,0.279481,0.299253,-0.212409,0.004681,0.299255,0.279488},{0.011044,-0.180265,0.272915,0.236435,-0.180264,0.011044,0.236437,0.272927},{0.026778,-0.173051,0.273040,0.221663,-0.173050,0.026777,0.221665,0.273053},{0.027617,-0.121932,0.239661,0.182545,-0.121930,0.027616,0.182548,0.239670},{0.041039,-0.097345,0.233057,0.165314,-0.097344,0.041038,0.165317,0.233066},{0.038063,-0.052423,0.224864,0.149642,-0.052421,0.038061,0.149647,0.224871},{0.046400,-0.020317,0.219305,0.136787,-0.020315,0.046397,0.136792,0.219313},{0.036565,0.044643,0.197927,0.120625,0.044644,0.036561,0.120629,0.197936},{0.038565,0.085752,0.192919,0.111000,0.085752,0.038560,0.111004,0.192927},{0.061298,0.209659,0.063843,0.068769,0.209657,0.061292,0.068769,0.063844},{-0.141912,0.045350,-0.059351,-0.147545,0.045346,-0.141912,-0.147542,-0.059353},{-0.126708,0.074353,-0.109989,-0.209464,0.074349,-0.126707,-0.209461,-0.109993},{-0.078942,0.073931,-0.069213,-0.152286,0.073932,-0.078943,-0.152286,-0.069210},{-0.055173,0.111413,-0.093304,-0.185394,0.111414,-0.055174,-0.185394,-0.093302},{0.011071,0.175482,-0.063927,-0.175010,0.175485,0.011071,-0.175009,-0.063929},{0.047596,0.228919,-0.075140,-0.200146,0.228923,0.047596,-0.200146,-0.075144},{0.139079,0.286056,-0.045265,-0.185930,0.286053,0.139077,-0.185929,-0.045265},{0.177334,0.340396,-0.046360,-0.203979,0.340394,0.177331,-0.203978,-0.046360},{0.248173,0.306954,-0.021139,-0.179693,0.306952,0.248173,-0.179691,-0.021140},{0.262668,0.324843,-0.010870,-0.187751,0.324840,0.262668,-0.187750,-0.010871},{0.252134,0.266059,0.001109,-0.156556,0.266063,0.252160,-0.156556,0.001107},{0.247691,0.255248,0.019384,-0.153592,0.255251,0.247719,-0.153592,0.019382},{0.211679,0.221369,0.029525,-0.113016,0.221373,0.211696,-0.113016,0.029525},{0.203470,0.205608,0.051338,-0.097695,0.205612,0.203487,-0.097695,0.051337},{0.181141,0.187368,0.039190,-0.055354,0.187372,0.181158,-0.055353,0.039190},{0.174223,0.174549,0.052263,-0.031871,0.174553,0.174240,-0.031870,0.052262},{0.157432,0.162981,0.034006,0.002766,0.162982,0.157440,0.002767,0.034005},{0.151957,0.153240,0.037008,0.028264,0.153241,0.151965,0.028265,0.037008},{0.131172,0.142896,0.003711,0.073894,0.142898,0.131185,0.073896,0.003710},{0.126797,0.135571,-0.004655,0.102295,0.135573,0.126810,0.102297,-0.004656},{0.008071,0.108296,-0.051328,0.178388,0.108296,0.008071,0.178382,-0.051330}};

// // Impact minimization - works okay
// float times[TIMESTEPS] = {0.000000,0.005649,0.011297,0.016946,0.022595,0.028243,0.033892,0.039540,0.045189,0.050838,0.056486,0.062135,0.067784,0.073432,0.079081,0.084730,0.090378,0.096027,0.101675,0.107324,0.112973,0.112973,0.118616,0.124259,0.129902,0.135545,0.141188,0.146832,0.152475,0.158118,0.163761,0.169404,0.175047,0.180690,0.186334,0.191977,0.197620,0.203263,0.208906,0.214549,0.220192,0.225835};
// float pos[TIMESTEPS][MOTORS] = {{0.977911,1.981320,1.675701,1.143658,1.981324,0.977916,1.143672,1.675704},{1.003451,2.081849,1.520459,1.095445,2.081853,1.003456,1.095458,1.520458},{1.006694,2.127692,1.358384,1.038161,2.127697,1.006698,1.038173,1.358378},{0.996485,2.134444,1.186242,0.969111,2.134450,0.996490,0.969123,1.186237},{0.980348,2.110723,1.003131,0.884997,2.110729,0.980352,0.885009,1.003125},{0.963833,2.060158,0.808406,0.783214,2.060164,0.963837,0.783225,0.808400},{0.953957,1.987116,0.609469,0.667922,1.987123,0.953961,0.667933,0.609463},{0.957732,1.895680,0.420815,0.554048,1.895688,0.957736,0.554058,0.420808},{0.981583,1.793331,0.264053,0.468685,1.793339,0.981587,0.468695,0.264046},{1.031463,1.688913,0.158426,0.441574,1.688921,1.031468,0.441582,0.158419},{1.106463,1.593092,0.112479,0.487521,1.593099,1.106468,0.487528,0.112472},{1.198778,1.516126,0.128778,0.608421,1.516134,1.198783,0.608428,0.128772},{1.299772,1.458703,0.195525,0.780784,1.458712,1.299778,0.780791,0.195519},{1.402242,1.416822,0.294765,0.972720,1.416830,1.402248,0.972728,0.294760},{1.498809,1.384990,0.407697,1.158518,1.384998,1.498815,1.158526,0.407692},{1.583143,1.358313,0.520563,1.323531,1.358320,1.583148,1.323539,0.520562},{1.649319,1.331323,0.628880,1.467529,1.331330,1.649323,1.467538,0.628882},{1.692695,1.299235,0.732042,1.593077,1.299241,1.692699,1.593086,0.732045},{1.706876,1.256442,0.830834,1.703355,1.256447,1.706880,1.703365,0.830838},{1.686718,1.198592,0.926127,1.801903,1.198597,1.686722,1.801913,0.926131},{1.617968,1.118411,1.017681,1.890265,1.118415,1.617971,1.890275,1.017686},{1.617868,1.118311,1.017581,1.890165,1.118315,1.617871,1.890175,1.017586},{1.514152,1.021752,1.091832,1.943883,1.021756,1.514155,1.943905,1.091834},{1.401660,0.918790,1.142341,1.948768,0.918795,1.401662,1.948778,1.142341},{1.277676,0.806797,1.177221,1.920367,0.806801,1.277677,1.920378,1.177222},{1.140754,0.683733,1.202754,1.866779,0.683736,1.140755,1.866790,1.202756},{0.989277,0.549391,1.222856,1.793055,0.549395,0.989277,1.793067,1.222858},{0.828161,0.410779,1.241889,1.703466,0.410782,0.828161,1.703478,1.241891},{0.668244,0.285041,1.265611,1.603555,0.285043,0.668244,1.603568,1.265614},{0.529127,0.197028,1.300327,1.498612,0.197029,0.529126,1.498625,1.300331},{0.430038,0.169962,1.355795,1.394904,0.169963,0.430037,1.394917,1.355798},{0.383332,0.216668,1.432530,1.300782,0.216669,0.383331,1.300795,1.432533},{0.395625,0.344853,1.523057,1.227854,0.344854,0.395624,1.227867,1.523059},{0.453632,0.535430,1.617428,1.180102,0.535432,0.453633,1.180115,1.617431},{0.534783,0.755707,1.706354,1.156064,0.755709,0.534784,1.156078,1.706355},{0.620744,0.977864,1.783213,1.151307,0.977866,0.620746,1.151320,1.783214},{0.700062,1.183546,1.841809,1.158360,1.183549,0.700063,1.158373,1.841772},{0.770137,1.370732,1.877187,1.170722,1.370736,0.770139,1.170735,1.877189},{0.831718,1.540971,1.884985,1.181521,1.540975,0.831721,1.181437,1.884993},{0.886237,1.697772,1.858934,1.184660,1.697775,0.886240,1.184674,1.858948},{0.934630,1.843761,1.794051,1.174592,1.843765,0.934634,1.174492,1.794109},{0.977811,1.981420,1.675601,1.143758,1.981424,0.977816,1.143772,1.675701}};
// float vel[TIMESTEPS][MOTORS] = {{7.055727,23.632475,-26.984959,-7.921107,23.632486,7.055827,-7.921071,-26.985042},{2.298375,12.489912,-28.030200,-9.274907,12.489979,2.298379,-9.275007,-28.030272},{-0.909688,4.199539,-29.475111,-11.062373,4.199634,-0.909727,-11.062362,-29.475174},{-2.514038,-1.624554,-31.455813,-13.502661,-1.624462,-2.514059,-13.502761,-31.455873},{-3.079683,-6.660552,-33.429812,-16.325504,-6.660464,-3.079700,-16.325542,-33.429866},{-2.547497,-11.061214,-35.176455,-19.494696,-11.061126,-2.547537,-19.494796,-35.176517},{-0.799582,-14.689585,-34.991952,-21.037571,-14.689492,-0.799605,-21.037671,-34.992009},{2.295107,-17.388046,-31.185340,-18.489753,-17.387953,2.295143,-18.489852,-31.185403},{6.237919,-18.624481,-23.771013,-10.871506,-18.624391,6.237992,-10.871606,-23.771086},{11.243032,-18.021289,-13.553363,1.438742,-18.021195,11.243125,1.438678,-13.553346},{15.060976,-15.651677,-2.569602,15.066985,-15.651584,15.061070,15.066930,-2.569502},{17.336917,-11.751947,7.814853,26.844867,-11.751875,17.337002,26.844841,7.814953},{18.205128,-8.661350,15.363028,33.359241,-8.661328,18.205172,33.359302,15.363128},{17.816072,-6.350576,19.246651,34.013067,-6.350634,17.816029,34.013167,19.246751},{16.186184,-5.032453,20.281999,31.256706,-5.032551,16.186099,31.256805,20.282099},{13.467148,-4.586213,19.624922,27.291738,-4.586309,13.467060,27.291826,19.625022},{9.827981,-5.072043,18.741831,23.745448,-5.072137,9.827896,23.745515,18.741931},{5.281476,-6.463250,17.861453,20.786376,-6.463346,5.281393,20.786422,17.861553},{-0.438199,-8.791592,17.123943,18.410035,-8.791684,-0.438266,18.410065,17.124043},{-7.308753,-11.958947,16.573116,16.509193,-11.959047,-7.308765,16.509212,16.573216},{-17.572441,-16.627907,15.871257,14.874383,-16.627944,-17.572541,14.874386,15.871336},{-17.672441,-16.727907,15.771257,14.774383,-16.727944,-17.672541,14.774386,15.771336},{-19.090232,-17.616990,10.817884,4.742472,-17.617027,-19.090331,4.742520,10.817970},{-20.853840,-18.926167,7.285783,-2.536509,-18.926212,-20.853940,-2.536436,7.285883},{-23.098003,-20.827350,5.219080,-7.401310,-20.827403,-23.098103,-7.401219,5.219180},{-25.509814,-22.778841,3.901855,-11.392147,-22.778912,-25.509914,-11.392047,3.901954},{-27.931819,-24.540026,3.314007,-14.607776,-24.540109,-27.931918,-14.607679,3.314106},{-28.996533,-24.221653,3.593504,-16.943968,-24.221753,-28.996632,-16.943868,3.593603},{-27.083349,-19.671372,4.964904,-18.312658,-19.671471,-27.083430,-18.312559,4.965004},{-21.695545,-10.780248,7.560766,-18.656641,-10.780348,-21.695612,-18.656552,7.560819},{-13.201439,1.459509,11.874621,-17.818119,1.459444,-13.201457,-17.818219,11.874583},{-3.059377,15.436374,15.169185,-15.188101,15.436403,-3.059304,-15.188001,15.169085},{6.826868,29.114309,16.653025,-10.644473,29.114378,6.826968,-10.644494,16.652931},{13.071736,37.619612,16.461126,-6.336757,37.619691,13.071831,-6.336657,16.461054},{15.216914,39.856277,14.876535,-2.335838,39.856367,15.217014,-2.335786,14.876436},{14.847411,38.214851,12.113601,0.425254,38.214925,14.847500,0.425214,12.113602},{13.219135,34.776481,8.459138,1.928382,34.776554,13.219235,1.928300,8.459238},{11.642942,31.588873,3.955158,2.236122,31.588933,11.643042,2.236221,3.955236},{10.238926,28.892317,-1.433891,1.426646,28.892362,10.239022,1.426746,-1.433791},{9.069152,26.755430,-7.970665,-0.480083,26.755476,9.069252,-0.480037,-7.970566},{8.102360,25.089592,-15.638661,-3.345179,25.089615,8.102439,-3.345279,-15.638761},{7.150933,23.732475,-26.884959,-7.830003,23.732486,7.151004,-7.830103,-26.885042}};
// float u[TIMESTEPS][MOTORS] = {{-0.359941,-1.556687,0.090442,0.815974,-1.556680,-0.359958,0.816015,0.090450},{-0.359941,-1.556687,0.090442,0.815974,-1.556680,-0.359958,0.816015,0.090450},{-0.033435,-0.886770,0.087006,0.771940,-0.886775,-0.033431,0.771944,0.087010},{-0.033435,-0.886770,0.087006,0.771940,-0.886775,-0.033431,0.771944,0.087010},{0.209193,-0.611798,0.163995,1.062277,-0.611799,0.209191,1.062279,0.164002},{0.209193,-0.611798,0.163995,1.062277,-0.611799,0.209191,1.062279,0.164002},{0.443475,-0.289496,0.411206,1.388066,-0.289497,0.443483,1.388077,0.411220},{0.443475,-0.289496,0.411206,1.388066,-0.289497,0.443483,1.388077,0.411220},{0.530724,0.053227,0.550021,1.410314,0.053227,0.530726,1.410369,0.549962},{0.530724,0.053227,0.550021,1.410314,0.053227,0.530726,1.410369,0.549962},{0.079551,0.523620,0.771422,1.233021,0.523621,0.079553,1.233018,0.771410},{0.079551,0.523620,0.771422,1.233021,0.523621,0.079553,1.233018,0.771410},{-0.202981,0.458937,1.142927,0.547360,0.458933,-0.202991,0.547358,1.142929},{-0.202981,0.458937,1.142927,0.547360,0.458933,-0.202991,0.547358,1.142929},{-0.521449,0.250441,0.901870,0.126518,0.250442,-0.521448,0.126539,0.901914},{-0.521449,0.250441,0.901870,0.126518,0.250442,-0.521448,0.126539,0.901914},{-0.819078,0.031261,0.732921,0.048237,0.031258,-0.819074,0.048261,0.732969},{-0.819078,0.031261,0.732921,0.048237,0.031258,-0.819074,0.048261,0.732969},{-1.154861,-0.189969,0.581141,0.010013,-0.189973,-1.154849,0.010032,0.581190},{-1.154861,-0.189969,0.581141,0.010013,-0.189973,-1.154849,0.010032,0.581190},{-1.868829,-0.506709,-0.147938,-0.161246,-0.506679,-1.868857,-0.161249,-0.147940},{0.139985,0.730527,-0.307973,-1.544098,0.730634,0.140001,-1.544103,-0.307978},{0.139985,0.730527,-0.307973,-1.544098,0.730634,0.140001,-1.544103,-0.307978},{0.153521,0.702745,-0.020157,-0.861982,0.702864,0.153540,-0.861989,-0.020156},{0.153521,0.702745,-0.020157,-0.861982,0.702864,0.153540,-0.861989,-0.020156},{0.261276,0.964514,0.201273,-0.584399,0.964582,0.261270,-0.584409,0.201272},{0.261276,0.964514,0.201273,-0.584399,0.964582,0.261270,-0.584409,0.201272},{0.511550,1.221143,0.438886,-0.294239,1.221151,0.511509,-0.294243,0.438888},{0.511550,1.221143,0.438886,-0.294239,1.221151,0.511509,-0.294243,0.438888},{0.795936,1.108219,0.584383,-0.033167,1.108237,0.795846,-0.033160,0.584372},{0.795936,1.108219,0.584383,-0.033167,1.108237,0.795846,-0.033160,0.584372},{1.075143,1.057148,0.116548,0.505726,1.057105,1.075135,0.505741,0.116540},{1.075143,1.057148,0.116548,0.505726,1.057105,1.075135,0.505741,0.116540},{1.291203,0.439314,-0.208456,0.503064,0.439333,1.291178,0.503068,-0.208462},{1.291203,0.439314,-0.208456,0.503064,0.439333,1.291178,0.503068,-0.208462},{0.999734,0.026792,-0.551860,0.273328,0.026824,0.999792,0.273295,-0.551811},{0.999734,0.026792,-0.551860,0.273328,0.026824,0.999792,0.273295,-0.551811},{0.808415,-0.029467,-0.854293,0.024985,-0.029455,0.808433,0.024958,-0.854200},{0.808415,-0.029467,-0.854293,0.024985,-0.029455,0.808433,0.024958,-0.854200},{0.653411,-0.036291,-1.174437,-0.233804,-0.036297,0.653367,-0.233890,-1.174312},{0.653411,-0.036291,-1.174437,-0.233804,-0.036297,0.653367,-0.233890,-1.174312},{-0.142220,-0.148821,-1.933915,-0.531526,-0.148822,-0.142221,-0.531757,-1.933535}};
// float dfVec[TIMESTEPS][MOTORS] = {{-0.015762,-0.121334,-0.190795,0.098102,-0.121333,-0.015765,0.098110,-0.190794},{-0.052511,-0.207407,-0.198869,0.087644,-0.207406,-0.052515,0.087652,-0.198868},{-0.013554,-0.140670,-0.210701,0.065241,-0.140671,-0.013554,0.065241,-0.210701},{-0.025947,-0.185660,-0.226002,0.046390,-0.185660,-0.025947,0.046390,-0.226001},{0.017048,-0.170883,-0.226221,0.081262,-0.170882,0.017047,0.081263,-0.226220},{0.021159,-0.204876,-0.239713,0.056781,-0.204876,0.021158,0.056781,-0.239712},{0.080396,-0.169986,-0.190029,0.108462,-0.169986,0.080398,0.108463,-0.190027},{0.104302,-0.190831,-0.160624,0.128143,-0.190831,0.104304,0.128145,-0.160622},{0.151791,-0.133478,-0.076252,0.191335,-0.133477,0.151792,0.191345,-0.076264},{0.190454,-0.128818,0.002677,0.286428,-0.128817,0.190455,0.286438,0.002665},{0.131871,-0.018686,0.130743,0.357092,-0.018685,0.131872,0.357091,0.130742},{0.149452,0.011438,0.210960,0.448072,0.011439,0.149453,0.448072,0.210959},{0.101004,0.022685,0.341791,0.364543,0.022684,0.101003,0.364543,0.341792},{0.097999,0.040535,0.371791,0.369593,0.040534,0.097997,0.369594,0.371792},{0.023239,0.010016,0.332731,0.266147,0.010015,0.023238,0.266152,0.332740},{0.002235,0.013463,0.327655,0.235519,0.013462,0.002235,0.235523,0.327664},{-0.083978,-0.033077,0.287852,0.192843,-0.033079,-0.083978,0.192848,0.287862},{-0.119098,-0.043824,0.281051,0.169985,-0.043825,-0.119098,0.169990,0.281061},{-0.228831,-0.104997,0.245725,0.144167,-0.104999,-0.228829,0.144170,0.245735},{-0.281904,-0.129464,0.241470,0.129483,-0.129465,-0.281901,0.129487,0.241480},{-0.500565,-0.227363,0.093721,0.083422,-0.227357,-0.500571,0.083422,0.093721},{-0.109187,0.013392,0.061707,-0.187303,0.013412,-0.109185,-0.187304,0.061707},{-0.120139,0.006524,0.023444,-0.264796,0.006544,-0.120137,-0.264797,0.023444},{-0.131120,-0.009013,0.052346,-0.187865,-0.008990,-0.131117,-0.187866,0.052346},{-0.148456,-0.023699,0.036381,-0.225444,-0.023676,-0.148453,-0.225445,0.036382},{-0.146051,0.012328,0.069432,-0.202084,0.012340,-0.146053,-0.202085,0.069433},{-0.164760,-0.001277,0.064891,-0.226924,-0.001264,-0.164762,-0.226925,0.064892},{-0.124127,0.051280,0.113436,-0.188327,0.051281,-0.124136,-0.188327,0.113437},{-0.109349,0.086430,0.124029,-0.198900,0.086431,-0.109357,-0.198899,0.124030},{-0.012213,0.133066,0.172485,-0.150592,0.133069,-0.012231,-0.150590,0.172483},{0.053401,0.227615,0.205808,-0.144114,0.227618,0.053384,-0.144114,0.205806},{0.186251,0.325612,0.139929,-0.018598,0.325604,0.186250,-0.018595,0.139927},{0.262619,0.431270,0.151392,0.016500,0.431262,0.262618,0.016503,0.151389},{0.353037,0.376361,0.086463,0.049256,0.376365,0.353033,0.049257,0.086462},{0.369608,0.393638,0.074223,0.080162,0.393643,0.369604,0.080163,0.074221},{0.309855,0.300428,-0.014157,0.056643,0.300435,0.309867,0.056636,-0.014148},{0.297277,0.273868,-0.042387,0.068254,0.273875,0.297289,0.068247,-0.042377},{0.247753,0.238262,-0.136218,0.022151,0.238265,0.247757,0.022146,-0.136199},{0.236907,0.217432,-0.177847,0.015898,0.217435,0.236911,0.015893,-0.177828},{0.197612,0.199593,-0.290838,-0.049350,0.199592,0.197604,-0.049367,-0.290813},{0.190144,0.186725,-0.350071,-0.071482,0.186724,0.190136,-0.071500,-0.350048},{0.027475,0.154274,-0.585207,-0.164246,0.154274,0.027476,-0.164292,-0.585133}};

// Ground speed matching and impact minimization - energyOptimalBoundInstantaneousSwitchGSMClearance.mat
float times[TIMESTEPS] = {0.000000,0.005924,0.011848,0.017772,0.023696,0.029620,0.035544,0.041468,0.047392,0.053316,0.059240,0.065164,0.071088,0.077013,0.082937,0.088861,0.094785,0.100709,0.106633,0.112557,0.118481,0.118481,0.124437,0.130393,0.136349,0.142305,0.148261,0.154217,0.160173,0.166130,0.172086,0.178042,0.183998,0.189954,0.195910,0.201866,0.207822,0.213778,0.219734,0.225690,0.231647,0.237603};
float pos[TIMESTEPS][MOTORS] = {{1.037759,2.075678,1.788795,1.203343,2.075685,1.037764,1.203353,1.788791},{1.046928,2.180676,1.643019,1.160079,2.180684,1.046934,1.160086,1.643012},{1.018879,2.248864,1.490343,1.108641,2.248871,1.018886,1.108651,1.490335},{0.984310,2.281971,1.328840,1.047604,2.281977,0.984316,1.047614,1.328831},{0.956413,2.281264,1.157529,0.974072,2.281271,0.956420,0.974082,1.157520},{0.937787,2.248917,0.974818,0.885187,2.248924,0.937794,0.885197,0.974809},{0.931256,2.187275,0.783393,0.779969,2.187283,0.931263,0.779979,0.783384},{0.940839,2.100371,0.588774,0.661798,2.100379,0.940844,0.661808,0.588765},{0.969457,1.992705,0.406925,0.546888,1.992713,0.969463,0.546897,0.406916},{1.020752,1.870460,0.259641,0.463622,1.870467,1.020757,0.463631,0.259629},{1.094496,1.744005,0.163220,0.436780,1.744014,1.094501,0.436788,0.163212},{1.187222,1.625704,0.122092,0.477908,1.625714,1.187227,0.477916,0.122084},{1.291605,1.523221,0.136670,0.585390,1.523231,1.291610,0.585398,0.136662},{1.396893,1.439321,0.209208,0.753176,1.439339,1.396899,0.753184,0.209203},{1.493133,1.372418,0.321573,0.949162,1.372428,1.493138,0.949170,0.321570},{1.572319,1.318969,0.448547,1.137955,1.318981,1.572321,1.137963,0.448553},{1.626959,1.277236,0.575744,1.306399,1.277247,1.626957,1.306407,0.575759},{1.649124,1.249970,0.696280,1.451179,1.249981,1.649122,1.451186,0.696295},{1.636259,1.226891,0.809802,1.576499,1.226902,1.636256,1.576506,0.809818},{1.593570,1.192215,0.919137,1.686161,1.192217,1.593567,1.686167,0.919153},{1.511455,1.114551,1.025331,1.782987,1.114561,1.511453,1.782993,1.025347},{1.511355,1.114451,1.025231,1.782887,1.114461,1.511353,1.782893,1.025247},{1.397678,0.999464,1.093670,1.849865,0.999475,1.397675,1.849871,1.093686},{1.273344,0.878866,1.114001,1.875886,0.878877,1.273341,1.875892,1.114018},{1.134891,0.746374,1.126892,1.868915,0.746386,1.134885,1.868908,1.126909},{0.982174,0.600579,1.149136,1.832899,0.600590,0.982165,1.832905,1.149152},{0.818015,0.447875,1.180549,1.770716,0.447887,0.818006,1.770664,1.180566},{0.656023,0.307287,1.223445,1.686755,0.307298,0.656014,1.686762,1.223462},{0.517709,0.209121,1.281780,1.586626,0.209131,0.517700,1.586599,1.281797},{0.423239,0.176761,1.359583,1.478936,0.176770,0.423230,1.478943,1.359601},{0.381372,0.218628,1.458089,1.374014,0.218637,0.381363,1.374023,1.458107},{0.390650,0.331336,1.571874,1.281245,0.331345,0.390641,1.281253,1.571891},{0.447162,0.509809,1.689287,1.208042,0.509818,0.447153,1.208051,1.689282},{0.530975,0.725379,1.800210,1.157190,0.725388,0.530966,1.157199,1.800180},{0.619145,0.943000,1.897077,1.127461,0.943009,0.619136,1.127470,1.897065},{0.701380,1.147458,1.974407,1.116543,1.147467,0.701371,1.116553,1.974375},{0.774839,1.334032,2.027306,1.120624,1.334041,0.774830,1.120635,2.027317},{0.840205,1.504843,2.050852,1.136735,1.504852,0.840196,1.136746,2.050815},{0.898180,1.662182,2.039093,1.163604,1.662191,0.898178,1.163616,2.039124},{0.950124,1.808785,1.990802,1.193307,1.808793,0.950128,1.193317,1.990704},{0.996517,1.946134,1.909170,1.214693,1.946142,0.996521,1.214703,1.909089},{1.037660,2.075778,1.788895,1.203443,2.075785,1.037665,1.203453,1.788890}};
float vel[TIMESTEPS][MOTORS] = {{6.288230,21.042894,-24.066521,-6.740501,21.042838,6.288233,-6.740457,-24.066616},{-2.363571,14.540905,-25.148078,-7.958263,14.540825,-2.363473,-7.958267,-25.148146},{-6.344130,8.547759,-26.461240,-9.435389,8.547664,-6.344032,-9.435327,-26.461290},{-5.328456,2.677765,-28.072677,-11.293785,2.677798,-5.328475,-11.293765,-28.072727},{-4.025935,-2.800526,-29.839413,-13.587234,-2.800462,-4.025915,-13.587198,-29.839458},{-2.222245,-8.030628,-31.707222,-16.431257,-8.030590,-2.222250,-16.431282,-31.707241},{0.124527,-12.623337,-32.848643,-19.034477,-12.623275,0.124511,-19.034480,-32.848638},{3.138413,-16.573164,-32.311278,-20.296111,-16.573107,3.138395,-20.296178,-32.311261},{6.616767,-19.566106,-28.604622,-17.866411,-19.566052,6.616773,-17.866453,-28.604582},{10.630923,-21.318783,-20.841729,-9.798634,-21.318730,10.630906,-9.798699,-20.841699},{14.130002,-21.052807,-11.493932,1.250368,-21.052751,14.129997,1.250331,-11.493916},{16.909602,-18.731098,-2.345563,12.584652,-18.731043,16.909575,12.584630,-2.345515},{17.999384,-15.779324,7.380052,23.719483,-15.779272,17.999382,23.719469,7.380108},{17.248942,-12.608136,16.328927,31.810462,-12.608086,17.248912,31.810448,16.328971},{15.010516,-10.106168,20.892803,33.307527,-10.106119,15.010527,33.307523,20.892842},{11.479767,-7.989895,21.709494,30.320451,-7.989827,11.479719,30.320429,21.709524},{6.790689,-6.084690,21.035285,26.370224,-6.084630,6.790722,26.370187,21.035322},{0.734456,-3.688982,19.702472,22.682049,-3.689022,0.734456,22.682006,19.702528},{-4.968792,-4.603926,18.734791,19.733744,-4.604003,-4.968694,19.733690,18.734839},{-9.992657,-8.296211,18.180088,17.387566,-8.296301,-9.992561,17.387493,18.180118},{-18.211936,-19.051005,17.741553,15.334276,-19.050917,-18.212031,15.334189,17.741564},{-18.268495,-19.144390,17.641556,15.234283,-19.144339,-18.268581,15.234194,17.641566},{-19.912614,-19.651176,6.425235,7.561044,-19.651127,-19.912689,7.560968,6.425331},{-21.913788,-20.961882,1.420041,1.414415,-20.961819,-21.913859,1.414318,1.420138},{-24.483545,-23.473871,2.958292,-3.685896,-23.473819,-24.483613,-3.685861,2.958256},{-26.770648,-25.362474,4.494086,-8.272360,-25.362430,-26.770703,-8.272279,4.494065},{-27.861733,-25.296927,6.175410,-12.422553,-25.296915,-27.861763,-12.422495,6.175420},{-26.110205,-21.227336,8.283299,-15.597736,-21.227356,-26.110195,-15.597665,8.283304},{-19.933908,-11.375891,11.395834,-17.712859,-11.375928,-19.933878,-17.712798,11.395850},{-11.454602,0.936752,14.754421,-18.176335,0.936726,-11.454580,-18.176262,14.754434},{-2.699178,13.044798,18.101199,-16.796511,13.044794,-2.699168,-16.796443,18.101210},{5.786244,24.791627,19.818396,-14.161442,24.791633,5.786243,-14.161370,19.818442},{12.455950,34.104269,19.392591,-10.387578,34.104266,12.455950,-10.387506,19.392577},{15.019437,37.315445,17.572372,-6.722627,37.315436,15.019453,-6.722564,17.572401},{14.416808,35.625357,14.765109,-3.307151,35.625338,14.416828,-3.307084,14.765105},{13.093494,32.828643,11.058243,-0.471768,32.828617,13.093514,-0.471722,11.058242},{11.617833,29.940773,6.540600,1.797966,29.940743,11.617862,1.798045,6.540550},{10.309603,27.468704,1.233878,3.500995,27.468667,10.309638,3.501045,1.233883},{9.198907,25.468963,-5.107772,5.164560,25.468929,9.198948,5.164514,-5.107723},{8.217720,23.796788,-11.099594,4.385451,23.796753,8.217755,4.385373,-11.099496},{7.358858,22.397822,-16.634701,1.852671,22.397774,7.358869,1.852578,-16.634603},{6.388228,21.142876,-24.008636,-6.640502,21.142830,6.388231,-6.640460,-24.008712}};
float u[TIMESTEPS][MOTORS] = {{-1.191678,-0.649074,0.083360,0.827547,-0.649112,-1.191635,0.827715,0.083391},{-1.191678,-0.649074,0.083360,0.827547,-0.649112,-1.191635,0.827715,0.083391},{0.469750,-1.062449,0.074061,0.737619,-1.062406,0.469700,0.737656,0.074073},{0.469750,-1.062449,0.074061,0.737619,-1.062406,0.469700,0.737656,0.074073},{0.515145,-0.896377,0.114160,0.941009,-0.896388,0.515155,0.941021,0.114168},{0.515145,-0.896377,0.114160,0.941009,-0.896388,0.515155,0.941021,0.114168},{0.491493,-0.584923,0.216112,1.240901,-0.584919,0.491491,1.240868,0.216113},{0.491493,-0.584923,0.216112,1.240901,-0.584919,0.491491,1.240868,0.216113},{0.413885,-0.242898,0.475020,1.291741,-0.242893,0.413882,1.291618,0.475156},{0.413885,-0.242898,0.475020,1.291741,-0.242893,0.413882,1.291618,0.475156},{0.082145,0.254801,0.449435,1.163339,0.254806,0.082143,1.163037,0.449821},{0.082145,0.254801,0.449435,1.163339,0.254806,0.082143,1.163037,0.449821},{-0.390369,0.589800,0.967582,1.121532,0.589799,-0.390356,1.121530,0.967590},{-0.390369,0.589800,0.967582,1.121532,0.589799,-0.390356,1.121530,0.967590},{-0.741372,0.609149,1.071143,0.423747,0.609148,-0.741361,0.423770,1.071119},{-0.741372,0.609149,1.071143,0.423747,0.609148,-0.741361,0.423770,1.071119},{-1.091051,0.613940,0.831161,0.178384,0.613922,-1.091036,0.178446,0.831209},{-1.091051,0.613940,0.831161,0.178384,0.613922,-1.091036,0.178446,0.831209},{-0.700241,-0.479291,0.662033,0.095679,-0.479278,-0.700242,0.095693,0.662003},{-0.700241,-0.479291,0.662033,0.095679,-0.479278,-0.700242,0.095693,0.662003},{-0.973287,-2.222405,-0.153891,-0.182580,-2.222310,-0.973358,-0.182583,-0.153892},{0.251466,0.845733,-1.158298,-0.860744,0.845804,0.251489,-0.860780,-1.158255},{0.251466,0.845733,-1.158298,-0.860744,0.845804,0.251489,-0.860780,-1.158255},{0.296581,0.837847,0.558241,-0.982285,0.837888,0.296595,-0.982250,0.558190},{0.296581,0.837847,0.558241,-0.982285,0.837888,0.296595,-0.982250,0.558190},{0.514827,1.130663,0.632035,-0.816039,1.130651,0.514842,-0.816047,0.632037},{0.514827,1.130663,0.632035,-0.816039,1.130651,0.514842,-0.816047,0.632037},{0.805213,1.129602,0.633415,-0.505730,1.129563,0.805224,-0.505723,0.633402},{0.805213,1.129602,0.633415,-0.505730,1.129563,0.805224,-0.505723,0.633402},{0.831368,0.866855,0.367910,-0.034900,0.866838,0.831373,-0.034886,0.367900},{0.831368,0.866855,0.367910,-0.034900,0.866838,0.831373,-0.034886,0.367900},{1.109737,0.796779,-0.103000,0.359023,0.796744,1.109748,0.359030,-0.102992},{1.109737,0.796779,-0.103000,0.359023,0.796744,1.109748,0.359030,-0.102992},{1.110814,0.135977,-0.460863,0.464744,0.135956,1.110833,0.464754,-0.460855},{1.110814,0.135977,-0.460863,0.464744,0.135956,1.110833,0.464754,-0.460855},{0.932745,0.016774,-0.789723,0.499512,0.016769,0.932799,0.499510,-0.789704},{0.932745,0.016774,-0.789723,0.499512,0.016769,0.932799,0.499510,-0.789704},{0.769873,-0.014822,-1.105218,0.502707,-0.014813,0.769975,0.502660,-1.105164},{0.769873,-0.014822,-1.105218,0.502707,-0.014813,0.769975,0.502660,-1.105164},{0.668806,-0.020638,-0.746131,-0.442985,-0.020640,0.668766,-0.442976,-0.746123},{0.668806,-0.020638,-0.746131,-0.442985,-0.020640,0.668766,-0.442976,-0.746123},{-0.133746,-0.118849,-0.697581,-2.305110,-0.118849,-0.133746,-2.304955,-0.697670}};
float dfVec[TIMESTEPS][MOTORS] = {{-0.184058,0.035841,-0.169633,0.109481,0.035833,-0.184050,0.109514,-0.169628},{-0.250891,-0.014385,-0.177988,0.100074,-0.014393,-0.250882,0.100107,-0.177983},{0.042696,-0.141377,-0.189947,0.071109,-0.141369,0.042687,0.071116,-0.189945},{0.050541,-0.186721,-0.202395,0.056753,-0.186712,0.050531,0.056760,-0.202393},{0.069465,-0.196619,-0.208215,0.078741,-0.196621,0.069467,0.078744,-0.208213},{0.083398,-0.237020,-0.222643,0.056772,-0.237022,0.083400,0.056774,-0.222642},{0.096909,-0.211697,-0.211558,0.095207,-0.211696,0.096908,0.095200,-0.211557},{0.120190,-0.242208,-0.207407,0.085461,-0.242207,0.120189,0.085454,-0.207406},{0.131909,-0.198560,-0.128231,0.114154,-0.198558,0.131908,0.114130,-0.128204},{0.162917,-0.212098,-0.068265,0.176475,-0.212097,0.162916,0.176451,-0.068238},{0.125186,-0.112886,-0.001051,0.236760,-0.112884,0.125185,0.236700,-0.000975},{0.146657,-0.094951,0.069618,0.324314,-0.094950,0.146657,0.324254,0.069693},{0.062834,-0.006753,0.245895,0.402165,-0.006753,0.062836,0.402165,0.245897},{0.057037,0.017744,0.315022,0.464666,0.017744,0.057039,0.464665,0.315024},{-0.028775,0.040848,0.370493,0.340012,0.040848,-0.028773,0.340017,0.370489},{-0.056049,0.057195,0.376802,0.316938,0.057196,-0.056047,0.316942,0.376798},{-0.160533,0.072848,0.324746,0.238525,0.072845,-0.160530,0.238537,0.324756},{-0.207316,0.091354,0.314451,0.210035,0.091350,-0.207313,0.210047,0.314460},{-0.175080,-0.129128,0.273959,0.171115,-0.129127,-0.175079,0.171117,0.273954},{-0.213888,-0.157650,0.269674,0.152992,-0.157648,-0.213887,0.152994,0.269669},{-0.330682,-0.581009,0.107006,0.082810,-0.580990,-0.330696,0.082809,0.107006},{-0.092029,0.017215,-0.089841,-0.050350,0.017229,-0.092025,-0.050357,-0.089833},{-0.104729,0.013300,-0.176484,-0.109623,0.013314,-0.104725,-0.109631,-0.176475},{-0.111380,0.001636,0.119946,-0.180831,0.001644,-0.111378,-0.180825,0.119937},{-0.131231,-0.017768,0.131829,-0.220229,-0.017760,-0.131229,-0.220222,0.131818},{-0.106293,0.024805,0.158098,-0.223204,0.024803,-0.106291,-0.223205,0.158098},{-0.114722,0.025311,0.171086,-0.255263,0.025309,-0.114719,-0.255264,0.171086},{-0.044504,0.056540,0.187638,-0.219214,0.056532,-0.044502,-0.219212,0.187635},{0.003206,0.132640,0.211681,-0.235552,0.132632,0.003208,-0.235551,0.211679},{0.073812,0.176459,0.185795,-0.147220,0.176455,0.073813,-0.147216,0.185793},{0.141445,0.269990,0.211648,-0.136561,0.269987,0.141446,-0.136558,0.211646},{0.261334,0.347051,0.132984,-0.039306,0.347044,0.261336,-0.039304,0.132986},{0.312855,0.418988,0.129695,-0.010154,0.418981,0.312858,-0.010152,0.129696},{0.332868,0.314795,0.045774,0.038795,0.314791,0.332872,0.038797,0.045776},{0.328213,0.301740,0.024089,0.065178,0.301736,0.328217,0.065181,0.024090},{0.283229,0.256866,-0.068744,0.093868,0.256865,0.283240,0.093868,-0.068740},{0.271830,0.234558,-0.103641,0.111401,0.234557,0.271841,0.111401,-0.103638},{0.229929,0.209294,-0.206223,0.125180,0.209295,0.229949,0.125171,-0.206213},{0.221349,0.193847,-0.255211,0.138030,0.193848,0.221370,0.138021,-0.255200},{0.194040,0.179794,-0.231397,-0.052601,0.179793,0.194033,-0.052600,-0.231394},{0.187406,0.168988,-0.274154,-0.072166,0.168987,0.187398,-0.072165,-0.274151},{0.023238,0.140121,-0.321638,-0.501287,0.140121,0.023238,-0.501257,-0.321655}};


class TrajBound : public ReorientableBehavior
{
public:
	Interpolator interp;

	TBMode mode = TB_SIT; //Current state within state-machine
	int logging = 0;

	uint32_t tLast; //int used to store system time at various events

	float extDes; //The desired leg extension
	float angDes; // The desired leg angle
	float t;
	uint32_t tOld;
	uint32_t tNew;
	uint32_t timeStep;
	uint32_t iter = 0;

	bool boolSlow = false;

	float posDes[MOTORS];
	float velDes[MOTORS];
	float uDes[MOTORS];
	float df[MOTORS];
	float dfDes[MOTORS];
	float posAct;
	float velAct;
	float kp = 0.8;
	float kd = 0.020; // 0.02
	float kpy = 0.1;	//0.1;
	float kdy = 0;		//0.05;
	float kiy = 0.02;
	float V = 15;
	float R = 0.23;
	float kt = 0.0954;
	float yawErrorInt = 0;

	float yawInit;
	float yawDes;
	float turnLeft;

	float finalTime = times[TIMESTEPS - 1];

	// Parser state (for serial comms with raspi)
	// Goes from 0 to 1 to 2
	int numAlignmentSeen = 0;
	uint16_t rxPtr = 0;

	// Receive buffer and alignment
	const static uint16_t RX_BUF_SIZE = 100;
	SerialCommandPacket packet;

	//sig is mapped from remote; here, 3 corresponds to pushing the left stick to the right
	// which in turn forces the state machine into FH_LEAP
	void signal(uint32_t sig)
	{
		// tLast = S->millis;
		if (logging == 0) power_int = 0;
		logging = 1;
	}

	void begin()
	{
		mode = TB_STAND;			// Start behavior in STAND mode
		tLast = S->millis;		// Record the system time @ this transition
		yawInit = S->imu.euler.z;
		yawErrorInt = 0;
		power_int = 0;
		// ioctl(LOGGER_FILENO, 0);//stop
	}

	void update()
	{
		tOld = tNew;
		tNew = clockTimeUS;
		timeStep = tNew - tOld;
		// if (tNew!=clockTimeUS)
		// {
		// 	tOld = tNew;
		// 	tNew = clockTimeUS;
		// 	timeStep = tNew - tOld;
		// }


		// Serial comms code
		oldvoltage = voltage;
		oldcurrent = current;

		// Character to store the latest received character
		uint8_t latestRX;

		// Loop through while there are new bytes available
		while (read(SERIAL_AUX_FILENO, &latestRX, 1) > 0)
		{
			if (numAlignmentSeen == 0 && latestRX == ALIGNMENT_WORD[0])
			{
				numAlignmentSeen = 1;
			}
			else if (numAlignmentSeen == 1 && latestRX == ALIGNMENT_WORD[1])
			{
				numAlignmentSeen = 2;
				rxPtr = 0;
			}
			else if (numAlignmentSeen == 2)
			{
				// Add the next byte to our memory space in serial_packet
				uint8_t *pSerialPacket = (uint8_t *)&packet;
				pSerialPacket[rxPtr++] = latestRX; // post-increment rxPtr

				// Check if we have read a whole packet
				if (rxPtr == sizeof(SerialCommandPacket))
				{
					// Copy voltage and current readings
					voltage = packet.voltage;
					current = packet.current;

					// Reset
					numAlignmentSeen = rxPtr = 0;
				}
			}
		}

		if (isReorienting())
			return;

		for (int j = 0; j < MOTORS; j++)
		{
			posDes[j] = 0;
			velDes[j] = 0;
			uDes[j] = 0;
			df[j] = 0;
		}

		if (mode == TB_SIT)
		{


			C->mode = RobotCommand_Mode_JOINT;
			for (int i = 0; i < P->joints_count; i++)
			{
				// int ii;
				// if (i==0)
				// {
				// 	ii = 1;
				// } else if (i == 1) {
				// 	ii = 0;
				// } else {
				// 	ii = i;
				// }

				posDes[i] = 0.5;
				// Splay angle for the front/rear legs (outward splay due to fore-displacement of front legs
				// and aft-displacement of rear legs)
				// The pitch angle (S->imu.euler.y) is subtracted since we want to the set the *absolute* leg angle
				// and limb[i].setPosition(ANGLE, *) will set the angle of the leg *relative* to the robot body
				if(i==1 || i==3 || i==4 || i==6)
				{
					posDes[i] = posDes[i] - S->imu.euler.y;
				} else if(i==0 || i==2 || i==5 || i==7)
				{
					posDes[i] = posDes[i] + S->imu.euler.y;
				}

				joint[i].setGain(0.4, .003);
				joint[i].setPosition(posDes[i]);
			}
		}
		else if (mode == TB_STAND)
		{
			if (voltage<10)
			{
				voltage = oldvoltage;
				current = oldcurrent;
			}
			power_int = power_int + 0.000001*timeStep*(voltage + oldvoltage)*0.5*(current + oldcurrent)*0.5;

			C->mode = RobotCommand_Mode_JOINT;

			t = 0.00001 * (100 * (S->millis - tLast) % (int)(100000 * finalTime));

			int index = 0;
			for (int j = 0; j < TIMESTEPS; j++)
			{
				if (times[j] <= t && t < times[j + 1])
				{
					index = j;
				}
			}

			interp.getMultipleCubicSplineInterp(pos, vel, times, t, posDes);
			interp.getMultipleLinearInterp(vel, times, t, velDes);
			// interp.getMultipleZOH(u, times, t, uDes);
			interp.getMultipleZOH(dfVec, times, t, dfDes);

			for (int i = 0; i < MOTORS; ++i)
			{

				// int ii;
				// if (i==0)
				// {
				// 	ii = 1;
				// } else if (i == 1) {
				// 	ii = 0;
				// } else {
				// 	ii = i;
				// }
				// joint[i].setGain(0.8);

				// yawDes = yawInit + 0;
				// yawErrorInt = yawErrorInt + 0.001 * (yawDes - S->imu.euler.z);
				// turnLeft = kpy*(yawDes - S->imu.euler.z) + kdy*(-S->imu.angular_velocity.z) + 0.1;
				turnLeft = -map(C->behavior.twist.angular.z, -1.0, 1.0, -0.1, 0.1) - 0.03;

				if (i == 0 || i == 2 || i == 4 || i == 6)
				{
					posDes[i] = posDes[i] - turnLeft;
				}
				else if (i == 1 || i == 3 || i == 5 || i == 7)
				{
					posDes[i] = posDes[i] + turnLeft;
				}

				// if(i==1 || i==3 || i==4 || i==6)
				// {
				// 	posDes[i] = posDes[i] - S->imu.euler.y;
				// } else if(i==0 || i==2 || i==5 || i==7)
				// {
				// 	posDes[i] = posDes[i] + S->imu.euler.y;
				// }

				posAct = joint[i].getPosition();
				velAct = joint[i].getVelocity();

				// df[i] = 1 / (0.95 * V) * (uDes[i] * R / kt + kt * joint[i].getVelocity());
				joint[i].setOpenLoop(dfDes[i] + kp * (posDes[i] - posAct) + kd * (velDes[i] - velAct));
			}
		}
	}

	bool running()
	{
		return false;
	}
	void end()
	{
		mode = TB_SIT;
		logging = 0;
	}
};

TrajBound trajBound;

void debug()
{
	// printf("loop: ");
	// printf("%d, ", trajBound.mode);
	// printf("pos command: %4.3f, %4.3f, %4.3f, %4.3f, %4.3f, %4.3f, %4.3f, %4.3f. ",
	// 	trajBound.uDes[0],trajBound.uDes[1],trajBound.uDes[2],trajBound.uDes[3],trajBound.uDes[4],trajBound.uDes[5],trajBound.uDes[6],trajBound.uDes[7]);
	// printf("Time: %4.3fs. ", trajBound.t);
	// printf("%4.3f, %4.3f, %4.3f ", trajBound.yawInit, trajBound.turnLeft, trajBound.kiy * trajBound.yawErrorInt);
	// printf("test1, test2: %4.3f, %4.3f.", trajBound.test1,trajBound.test2);
	// printf("Voltage: %6.3f, Current: %6.3f", voltage,  current);

	// for (int i = 0; i < P->joints_count; i++)
	// {
	// 	printf("Motor %d, Pos: %4.3f, ", i, joint[i].getRawPosition());
	// }

	printf("Power Int: %6.2f, Voltage: %5.2f, Current: %5.2f", power_int, voltage, current);
	printf("\n");

	myData_buf[0] = trajBound.logging;
	myData_buf[1] = voltage;
	myData_buf[2] = current;
	myData_buf[3] = power_int;
	write(LOGGER_FILENO, myData, 32);
}

int main(int argc, char *argv[])
{
#if defined(ROBOT_MINITAUR)
	init(RobotParams_Type_MINITAUR, argc, argv);
	for (int i = 0; i < P->joints_count; ++i)
		P->joints[i].zero = motZeros[i]; //Add motor zeros from array at beginning of file
#elif defined(ROBOT_MINITAUR_E)
	init(RobotParams_Type_MINITAUR_E, argc, argv);
	JoyType joyType = JoyType_FRSKY_XSR;
	ioctl(JOYSTICK_FILENO, IOCTL_CMD_JOYSTICK_SET_TYPE, &joyType);
#else
#error "Define robot type in preprocessor"
#endif


	// Uncomment to clear Bound and Walk behaviors
	// behaviors.clear();
	
	behaviors.push_back(&trajBound);

	setDebugRate(100);
	safetyShutoffEnable(false);

	SerialPortConfig cfg;
	cfg.baud = 115200;
	cfg.mode = SERIAL_8N1;
	ioctl(STDOUT_FILENO, IOCTL_CMD_SERIAL_PORT_CFG, &cfg);


	// Run
	return begin();
}